"use strict";exports.id=546,exports.ids=[546],exports.modules={4546:(a,b,c)=>{let d,e,f,g,h;c.d(b,{$EB:()=>v,$Ed:()=>gw,$Kf:()=>fX,$NF:()=>iJ,$O9:()=>aA,$Yl:()=>T,$_I:()=>aG,$ei:()=>G,$p8:()=>i1,A$4:()=>eK,AKb:()=>il,ALV:()=>de,AQS:()=>cP,Am1:()=>jf,B69:()=>ea,B6O:()=>g6,BER:()=>an,BH$:()=>gL,BKk:()=>fd,BND:()=>ks,BRH:()=>iL,BXX:()=>a8,B_h:()=>bh,CMB:()=>aY,CR7:()=>b9,CSG:()=>ib,CV9:()=>hf,CVz:()=>bd,CWW:()=>bA,Cfg:()=>aB,CmU:()=>i7,CwR:()=>jy,D$Q:()=>h4,DAe:()=>bL,DXC:()=>gJ,Df:()=>h8,Dmk:()=>aT,E0M:()=>kv,EAD:()=>f_,EQC:()=>bG,EZo:()=>y,EdD:()=>A,F1T:()=>fj,F1l:()=>kb,FCc:()=>gK,FFZ:()=>cl,FNr:()=>id,FV:()=>aj,FXf:()=>D,FZo:()=>i4,Fn:()=>bu,Fpm:()=>j6,FvD:()=>gV,Fvi:()=>ao,Fvt:()=>ie,G3T:()=>bB,GBG:()=>iv,GJx:()=>av,GOR:()=>gY,GWd:()=>aW,GYF:()=>fY,GZZ:()=>hc,G_z:()=>ia,Gu$:()=>hX,Gwm:()=>_,GxU:()=>eB,H23:()=>bv,H2z:()=>ky,HIg:()=>aV,HLH:()=>b1,HO_:()=>bz,HPb:()=>b6,HXV:()=>bb,HgN:()=>c2,HiM:()=>iZ,Hit:()=>iu,Ho_:()=>hn,Hrb:()=>eJ,Hrq:()=>cs,I46:()=>fW,I9Y:()=>cM,IE4:()=>a5,IUQ:()=>c8,IWo:()=>kr,Iit:()=>fa,Ipv:()=>g$,Iw4:()=>jN,IzY:()=>kw,Jnc:()=>n,K52:()=>aa,KDk:()=>bf,KLL:()=>bZ,KPJ:()=>iB,KRh:()=>ad,Ke9:()=>bK,Kef:()=>bx,Ktl:()=>co,Kwu:()=>z,Kzg:()=>jd,Kzv:()=>aX,LAk:()=>al,Ld9:()=>kx,LiQ:()=>K,LlO:()=>fc,LoY:()=>eW,LuO:()=>jT,MBL:()=>iw,MOq:()=>ct,MSw:()=>hW,MW4:()=>eM,Mjd:()=>ah,Mmk:()=>cY,N1A:()=>gF,N2s:()=>jz,N5j:()=>bQ,NRn:()=>dj,NTi:()=>x,NZq:()=>aH,Nex:()=>kz,Nt7:()=>O,Nv2:()=>gS,Nwf:()=>jJ,Nz6:()=>a6,O0B:()=>c9,O3Y:()=>hZ,O49:()=>bN,O9p:()=>dV,ONl:()=>gQ,OUM:()=>aI,Oax:()=>eN,Om:()=>au,OuU:()=>M,P5j:()=>jK,PFK:()=>kl,PJ3:()=>bF,PPD:()=>gf,PTz:()=>df,Pdi:()=>io,Pem:()=>gU,Pf$:()=>jr,Pq0:()=>dg,Q1f:()=>et,QCA:()=>hQ,QP0:()=>q,Qev:()=>cA,Qrf:()=>bk,R1W:()=>kf,R3r:()=>fo,RJ4:()=>bM,ROr:()=>b2,RQf:()=>aO,RcT:()=>ca,RiT:()=>iy,Riy:()=>be,Rkk:()=>bP,RlV:()=>dK,RoJ:()=>fv,RrE:()=>S,Ru$:()=>b3,RyA:()=>s,S$4:()=>bt,S20:()=>g_,SUR:()=>i8,SYV:()=>gT,ScU:()=>iK,T6I:()=>it,TDQ:()=>hv,THS:()=>eF,TMh:()=>cc,Tap:()=>iM,TdN:()=>cx,TiK:()=>ch,TkQ:()=>a2,U3G:()=>$,UJ6:()=>ir,UPV:()=>h$,UTZ:()=>ap,Ufg:()=>hT,UpK:()=>fM,UtB:()=>j1,UtX:()=>je,V3x:()=>aS,V9B:()=>ex,VCu:()=>gZ,VGF:()=>a3,VT0:()=>a_,VVr:()=>b_,Vb5:()=>m,VnP:()=>hd,Vnu:()=>cn,Vwu:()=>kA,VxR:()=>bY,W9U:()=>bw,WBB:()=>hS,WNZ:()=>l,WTh:()=>ko,Wdf:()=>cw,Wew:()=>aQ,Wk7:()=>r,Wyr:()=>cv,XG_:()=>by,XIg:()=>w,XJ7:()=>h0,XMJ:()=>jO,XTe:()=>i9,XrR:()=>ae,Y9S:()=>iG,YHV:()=>jZ,YJl:()=>fm,YOZ:()=>is,YRT:()=>iI,Yhb:()=>iq,Yuy:()=>aM,Z0B:()=>ha,Z58:()=>fr,ZLX:()=>f8,ZM4:()=>kt,ZQM:()=>a0,Zcv:()=>gc,Zpd:()=>hY,Zr2:()=>bX,ZyN:()=>i0,_4j:()=>h5,_QJ:()=>bn,_Ut:()=>fb,_xc:()=>ka,a$r:()=>aC,a55:()=>cE,a5J:()=>bm,aEY:()=>Q,aHM:()=>iD,aJ8:()=>am,aMy:()=>bC,aVO:()=>ic,agE:()=>cm,amv:()=>ce,b4q:()=>fk,bC7:()=>bq,bCz:()=>B,bI3:()=>bT,bTm:()=>p,baL:()=>eH,bdM:()=>hU,bkx:()=>aN,brA:()=>Y,bw0:()=>ab,c5h:()=>gX,c90:()=>a4,cHt:()=>aL,cRK:()=>fp,cZY:()=>j4,caT:()=>ac,cj9:()=>cL,czI:()=>bi,dAo:()=>he,dYF:()=>dd,dcC:()=>a$,dhZ:()=>bJ,dth:()=>iO,dwI:()=>cN,dzP:()=>jS,e0p:()=>U,eB$:()=>fs,eHc:()=>W,eHs:()=>fu,eaF:()=>e6,eoi:()=>ci,er$:()=>bW,ezk:()=>ip,f4X:()=>J,fBL:()=>aK,fJr:()=>b4,fP5:()=>js,fTw:()=>kg,fc6:()=>eI,g7M:()=>ak,gJ2:()=>aR,gO9:()=>C,gPd:()=>c7,gWB:()=>ck,ghU:()=>aw,h2z:()=>bI,hB5:()=>t,hIf:()=>cq,hZF:()=>ix,h_9:()=>iC,hdd:()=>N,hgQ:()=>R,hjs:()=>j$,hsX:()=>u,hxR:()=>ay,hy7:()=>aq,hzE:()=>kh,i7d:()=>fe,i7u:()=>cy,iNn:()=>e8,iOZ:()=>gW,iUH:()=>aF,ibB:()=>g0,ie2:()=>L,imn:()=>ew,ix0:()=>aP,iyt:()=>dC,j6:()=>h_,jGm:()=>hi,jR7:()=>a7,jUj:()=>fq,jej:()=>cW,jf0:()=>bV,jsO:()=>b8,jut:()=>i5,jzd:()=>cj,k6Q:()=>a9,k6q:()=>aD,k8v:()=>bS,kBv:()=>j,kEx:()=>iH,kG0:()=>b0,kLi:()=>c4,kO0:()=>cg,kRr:()=>aE,kTW:()=>ax,kTp:()=>ba,kYr:()=>b7,k_V:()=>j_,keZ:()=>jj,klZ:()=>cb,kn4:()=>dL,kqe:()=>b$,kxk:()=>fI,kyO:()=>ag,l2R:()=>iA,lGu:()=>X,lGw:()=>im,lMl:()=>eo,lPF:()=>cT,lc7:()=>bD,ljd:()=>bE,lxW:()=>e9,lyL:()=>bp,mcG:()=>cV,mrM:()=>gx,nCl:()=>iU,nEu:()=>hq,nNL:()=>ai,nST:()=>E,nWS:()=>da,nZQ:()=>jk,nc$:()=>jQ,nzx:()=>hk,o6l:()=>fl,oVO:()=>b5,oh6:()=>jU,ojh:()=>H,ojs:()=>bs,ov9:()=>V,pBf:()=>bc,pFK:()=>hp,pHI:()=>az,pPE:()=>jL,paN:()=>a1,ppV:()=>c_,psI:()=>bl,q2:()=>h3,qBx:()=>h9,qFE:()=>ho,qU7:()=>hl,qUd:()=>i$,qa3:()=>bg,qad:()=>I,qq$:()=>cS,qtW:()=>eO,r6x:()=>i6,rFo:()=>db,rKP:()=>hV,rOG:()=>cu,rQf:()=>bH,rSH:()=>bj,rYR:()=>bO,rrX:()=>jP,s0K:()=>hb,sKt:()=>cd,sPf:()=>i,tBo:()=>jW,tJf:()=>aJ,tXL:()=>h7,tcD:()=>hm,tz3:()=>iz,uB5:()=>bo,uSd:()=>h6,uV5:()=>at,uWO:()=>f0,uXQ:()=>cp,ubm:()=>fi,uov:()=>cr,ure:()=>i2,v9J:()=>cz,veJ:()=>iN,vim:()=>cf,vmz:()=>eL,vyJ:()=>bU,wAk:()=>hj,wTz:()=>bR,wfO:()=>as,wn6:()=>P,wrO:()=>aU,wtR:()=>k,wvS:()=>eG,xFO:()=>ar,xJ6:()=>hN,xOk:()=>i3,xSv:()=>Z,xZx:()=>jx,xfg:()=>hg,xiE:()=>cX,y3Z:()=>br,y9J:()=>dc,y_p:()=>af,ypk:()=>hw,ywQ:()=>o,zD7:()=>jl,zdS:()=>aZ,zgK:()=>dW,znC:()=>F});let i="173",j={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},k={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},l=0,m=1,n=2,o=3,p=0,q=1,r=2,s=3,t=0,u=1,v=2,w=0,x=1,y=2,z=3,A=4,B=5,C=100,D=101,E=102,F=103,G=104,H=200,I=201,J=202,K=203,L=204,M=205,N=206,O=207,P=208,Q=209,R=210,S=211,T=212,U=213,V=214,W=0,X=1,Y=2,Z=3,$=4,_=5,aa=6,ab=7,ac=0,ad=1,ae=2,af=0,ag=1,ah=2,ai=3,aj=4,ak=5,al=6,am=7,an="attached",ao="detached",ap=300,aq=301,ar=302,as=303,at=304,au=306,av=1e3,aw=1001,ax=1002,ay=1003,az=1004,aA=1004,aB=1005,aC=1005,aD=1006,aE=1007,aF=1007,aG=1008,aH=1008,aI=1009,aJ=1010,aK=1011,aL=1012,aM=1013,aN=1014,aO=1015,aP=1016,aQ=1017,aR=1018,aS=1020,aT=35902,aU=1021,aV=1022,aW=1023,aX=1024,aY=1025,aZ=1026,a$=1027,a_=1028,a0=1029,a1=1030,a2=1031,a3=1032,a4=1033,a5=33776,a6=33777,a7=33778,a8=33779,a9=35840,ba=35841,bb=35842,bc=35843,bd=36196,be=37492,bf=37496,bg=37808,bh=37809,bi=37810,bj=37811,bk=37812,bl=37813,bm=37814,bn=37815,bo=37816,bp=37817,bq=37818,br=37819,bs=37820,bt=37821,bu=36492,bv=36494,bw=36495,bx=36283,by=36284,bz=36285,bA=36286,bB=2200,bC=2201,bD=2202,bE=2300,bF=2301,bG=2302,bH=2400,bI=2401,bJ=2402,bK=2500,bL=2501,bM=0,bN=1,bO=2,bP=3200,bQ=3201,bR=3202,bS=3203,bT=0,bU=1,bV="",bW="srgb",bX="srgb-linear",bY="linear",bZ="srgb",b$=0,b_=7680,b0=7681,b1=7682,b2=7683,b3=34055,b4=34056,b5=5386,b6=512,b7=513,b8=514,b9=515,ca=516,cb=517,cc=518,cd=519,ce=512,cf=513,cg=514,ch=515,ci=516,cj=517,ck=518,cl=519,cm=35044,cn=35048,co=35040,cp=35045,cq=35049,cr=35041,cs=35046,ct=35050,cu=35042,cv="100",cw="300 es",cx=2e3,cy=2001,cz={COMPUTE:"compute",RENDER:"render"};class cA{addEventListener(a,b){void 0===this._listeners&&(this._listeners={});let c=this._listeners;void 0===c[a]&&(c[a]=[]),-1===c[a].indexOf(b)&&c[a].push(b)}hasEventListener(a,b){let c=this._listeners;return void 0!==c&&void 0!==c[a]&&-1!==c[a].indexOf(b)}removeEventListener(a,b){let c=this._listeners;if(void 0===c)return;let d=c[a];if(void 0!==d){let a=d.indexOf(b);-1!==a&&d.splice(a,1)}}dispatchEvent(a){let b=this._listeners;if(void 0===b)return;let c=b[a.type];if(void 0!==c){a.target=this;let b=c.slice(0);for(let c=0,d=b.length;c<d;c++)b[c].call(this,a);a.target=null}}}let cB=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],cC=1234567,cD=Math.PI/180,cE=180/Math.PI;function cF(){let a=0xffffffff*Math.random()|0,b=0xffffffff*Math.random()|0,c=0xffffffff*Math.random()|0,d=0xffffffff*Math.random()|0;return(cB[255&a]+cB[a>>8&255]+cB[a>>16&255]+cB[a>>24&255]+"-"+cB[255&b]+cB[b>>8&255]+"-"+cB[b>>16&15|64]+cB[b>>24&255]+"-"+cB[63&c|128]+cB[c>>8&255]+"-"+cB[c>>16&255]+cB[c>>24&255]+cB[255&d]+cB[d>>8&255]+cB[d>>16&255]+cB[d>>24&255]).toLowerCase()}function cG(a,b,c){return Math.max(b,Math.min(c,a))}function cH(a,b){return(a%b+b)%b}function cI(a,b,c){return(1-c)*a+c*b}function cJ(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return a/0xffffffff;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/0x7fffffff,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw Error("Invalid component type.")}}function cK(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return Math.round(0xffffffff*a);case Uint16Array:return Math.round(65535*a);case Uint8Array:return Math.round(255*a);case Int32Array:return Math.round(0x7fffffff*a);case Int16Array:return Math.round(32767*a);case Int8Array:return Math.round(127*a);default:throw Error("Invalid component type.")}}let cL={DEG2RAD:cD,RAD2DEG:cE,generateUUID:cF,clamp:cG,euclideanModulo:cH,mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},inverseLerp:function(a,b,c){return a!==b?(c-a)/(b-a):0},lerp:cI,damp:function(a,b,c,d){return cI(a,b,1-Math.exp(-c*d))},pingpong:function(a,b=1){return b-Math.abs(cH(a,2*b)-b)},smoothstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b))*a*(3-2*a)},smootherstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b))*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},seededRandom:function(a){void 0!==a&&(cC=a);let b=cC+=0x6d2b79f5;return b=Math.imul(b^b>>>15,1|b),(((b^=b+Math.imul(b^b>>>7,61|b))^b>>>14)>>>0)/0x100000000},degToRad:function(a){return a*cD},radToDeg:function(a){return a*cE},isPowerOfTwo:function(a){return(a&a-1)==0&&0!==a},ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},setQuaternionFromProperEuler:function(a,b,c,d,e){let f=Math.cos,g=Math.sin,h=f(c/2),i=g(c/2),j=f((b+d)/2),k=g((b+d)/2),l=f((b-d)/2),m=g((b-d)/2),n=f((d-b)/2),o=g((d-b)/2);switch(e){case"XYX":a.set(h*k,i*l,i*m,h*j);break;case"YZY":a.set(i*m,h*k,i*l,h*j);break;case"ZXZ":a.set(i*l,i*m,h*k,h*j);break;case"XZX":a.set(h*k,i*o,i*n,h*j);break;case"YXY":a.set(i*n,h*k,i*o,h*j);break;case"ZYZ":a.set(i*o,i*n,h*k,h*j);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+e)}},normalize:cK,denormalize:cJ};class cM{constructor(a=0,b=0){cM.prototype.isVector2=!0,this.x=a,this.y=b}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,b){return this.x=a,this.y=b,this}setScalar(a){return this.x=a,this.y=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y)}copy(a){return this.x=a.x,this.y=a.y,this}add(a){return this.x+=a.x,this.y+=a.y,this}addScalar(a){return this.x+=a,this.y+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this}subScalar(a){return this.x-=a,this.y-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this}multiply(a){return this.x*=a.x,this.y*=a.y,this}multiplyScalar(a){return this.x*=a,this.y*=a,this}divide(a){return this.x/=a.x,this.y/=a.y,this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){let b=this.x,c=this.y,d=a.elements;return this.x=d[0]*b+d[3]*c+d[6],this.y=d[1]*b+d[4]*c+d[7],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this}clamp(a,b){return this.x=cG(this.x,a.x,b.x),this.y=cG(this.y,a.y,b.y),this}clampScalar(a,b){return this.x=cG(this.x,a,b),this.y=cG(this.y,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(cG(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){let b=Math.sqrt(this.lengthSq()*a.lengthSq());return 0===b?Math.PI/2:Math.acos(cG(this.dot(a)/b,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){let b=this.x-a.x,c=this.y-a.y;return b*b+c*c}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this}rotateAround(a,b){let c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,f=this.y-a.y;return this.x=e*c-f*d+a.x,this.y=e*d+f*c+a.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class cN{constructor(a,b,c,d,e,f,g,h,i){cN.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==a&&this.set(a,b,c,d,e,f,g,h,i)}set(a,b,c,d,e,f,g,h,i){let j=this.elements;return j[0]=a,j[1]=d,j[2]=g,j[3]=b,j[4]=e,j[5]=h,j[6]=c,j[7]=f,j[8]=i,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){let b=this.elements,c=a.elements;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],this}extractBasis(a,b,c){return a.setFromMatrix3Column(this,0),b.setFromMatrix3Column(this,1),c.setFromMatrix3Column(this,2),this}setFromMatrix4(a){let b=a.elements;return this.set(b[0],b[4],b[8],b[1],b[5],b[9],b[2],b[6],b[10]),this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){let c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[3],h=c[6],i=c[1],j=c[4],k=c[7],l=c[2],m=c[5],n=c[8],o=d[0],p=d[3],q=d[6],r=d[1],s=d[4],t=d[7],u=d[2],v=d[5],w=d[8];return e[0]=f*o+g*r+h*u,e[3]=f*p+g*s+h*v,e[6]=f*q+g*t+h*w,e[1]=i*o+j*r+k*u,e[4]=i*p+j*s+k*v,e[7]=i*q+j*t+k*w,e[2]=l*o+m*r+n*u,e[5]=l*p+m*s+n*v,e[8]=l*q+m*t+n*w,this}multiplyScalar(a){let b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this}determinant(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h}invert(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=j*f-g*i,l=g*h-j*e,m=i*e-f*h,n=b*k+c*l+d*m;if(0===n)return this.set(0,0,0,0,0,0,0,0,0);let o=1/n;return a[0]=k*o,a[1]=(d*i-j*c)*o,a[2]=(g*c-d*f)*o,a[3]=l*o,a[4]=(j*b-d*h)*o,a[5]=(d*e-g*b)*o,a[6]=m*o,a[7]=(c*h-i*b)*o,a[8]=(f*b-c*e)*o,this}transpose(){let a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){let b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this}setUvTransform(a,b,c,d,e,f,g){let h=Math.cos(e),i=Math.sin(e);return this.set(c*h,c*i,-c*(h*f+i*g)+f+a,-d*i,d*h,-d*(-i*f+h*g)+g+b,0,0,1),this}scale(a,b){return this.premultiply(cO.makeScale(a,b)),this}rotate(a){return this.premultiply(cO.makeRotation(-a)),this}translate(a,b){return this.premultiply(cO.makeTranslation(a,b)),this}makeTranslation(a,b){return a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,b,0,0,1),this}makeRotation(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,c,b,0,0,0,1),this}makeScale(a,b){return this.set(a,0,0,0,b,0,0,0,1),this}equals(a){let b=this.elements,c=a.elements;for(let a=0;a<9;a++)if(b[a]!==c[a])return!1;return!0}fromArray(a,b=0){for(let c=0;c<9;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){let c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a}clone(){return new this.constructor().fromArray(this.elements)}}let cO=new cN;function cP(a){for(let b=a.length-1;b>=0;--b)if(a[b]>=65535)return!0;return!1}let cQ={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function cR(a,b){return new cQ[a](b)}function cS(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}function cT(){let a=cS("canvas");return a.style.display="block",a}let cU={};function cV(a){a in cU||(cU[a]=!0,console.warn(a))}function cW(a,b,c){return new Promise(function(d,e){setTimeout(function f(){switch(a.clientWaitSync(b,a.SYNC_FLUSH_COMMANDS_BIT,0)){case a.WAIT_FAILED:e();break;case a.TIMEOUT_EXPIRED:setTimeout(f,c);break;default:d()}},c)})}function cX(a){let b=a.elements;b[2]=.5*b[2]+.5*b[3],b[6]=.5*b[6]+.5*b[7],b[10]=.5*b[10]+.5*b[11],b[14]=.5*b[14]+.5*b[15]}function cY(a){let b=a.elements;-1===b[11]?(b[10]=-b[10]-1,b[14]=-b[14]):(b[10]=-b[10],b[14]=-b[14]+1)}let cZ=new cN().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),c$=new cN().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715),c_=function(){let a={enabled:!0,workingColorSpace:bX,spaces:{},convert:function(a,b,c){return!1!==this.enabled&&b!==c&&b&&c&&(this.spaces[b].transfer===bZ&&(a.r=c0(a.r),a.g=c0(a.g),a.b=c0(a.b)),this.spaces[b].primaries!==this.spaces[c].primaries&&(a.applyMatrix3(this.spaces[b].toXYZ),a.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===bZ&&(a.r=c1(a.r),a.g=c1(a.g),a.b=c1(a.b))),a},fromWorkingColorSpace:function(a,b){return this.convert(a,this.workingColorSpace,b)},toWorkingColorSpace:function(a,b){return this.convert(a,b,this.workingColorSpace)},getPrimaries:function(a){return this.spaces[a].primaries},getTransfer:function(a){return a===bV?bY:this.spaces[a].transfer},getLuminanceCoefficients:function(a,b=this.workingColorSpace){return a.fromArray(this.spaces[b].luminanceCoefficients)},define:function(a){Object.assign(this.spaces,a)},_getMatrix:function(a,b,c){return a.copy(this.spaces[b].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(a){return this.spaces[a].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(a=this.workingColorSpace){return this.spaces[a].workingColorSpaceConfig.unpackColorSpace}},b=[.64,.33,.3,.6,.15,.06],c=[.2126,.7152,.0722],d=[.3127,.329];return a.define({[bX]:{primaries:b,whitePoint:d,transfer:bY,toXYZ:cZ,fromXYZ:c$,luminanceCoefficients:c,workingColorSpaceConfig:{unpackColorSpace:bW},outputColorSpaceConfig:{drawingBufferColorSpace:bW}},[bW]:{primaries:b,whitePoint:d,transfer:bZ,toXYZ:cZ,fromXYZ:c$,luminanceCoefficients:c,outputColorSpaceConfig:{drawingBufferColorSpace:bW}}}),a}();function c0(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function c1(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}class c2{static getDataURL(a){let b;if(/^data:/i.test(a.src)||"undefined"==typeof HTMLCanvasElement)return a.src;if(a instanceof HTMLCanvasElement)b=a;else{void 0===d&&(d=cS("canvas")),d.width=a.width,d.height=a.height;let c=d.getContext("2d");a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height),b=d}return b.toDataURL("image/png")}static sRGBToLinear(a){if("undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap){let b=cS("canvas");b.width=a.width,b.height=a.height;let c=b.getContext("2d");c.drawImage(a,0,0,a.width,a.height);let d=c.getImageData(0,0,a.width,a.height),e=d.data;for(let a=0;a<e.length;a++)e[a]=255*c0(e[a]/255);return c.putImageData(d,0,0),b}if(!a.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),a;{let b=a.data.slice(0);for(let a=0;a<b.length;a++)b instanceof Uint8Array||b instanceof Uint8ClampedArray?b[a]=Math.floor(255*c0(b[a]/255)):b[a]=c0(b[a]);return{data:b,width:a.width,height:a.height}}}}let c3=0;class c4{constructor(a=null){this.isSource=!0,Object.defineProperty(this,"id",{value:c3++}),this.uuid=cF(),this.data=a,this.dataReady=!0,this.version=0}set needsUpdate(a){!0===a&&this.version++}toJSON(a){let b=void 0===a||"string"==typeof a;if(!b&&void 0!==a.images[this.uuid])return a.images[this.uuid];let c={uuid:this.uuid,url:""},d=this.data;if(null!==d){let a;if(Array.isArray(d)){a=[];for(let b=0,c=d.length;b<c;b++)d[b].isDataTexture?a.push(c5(d[b].image)):a.push(c5(d[b]))}else a=c5(d);c.url=a}return b||(a.images[this.uuid]=c),c}}function c5(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?c2.getDataURL(a):a.data?{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let c6=0;class c7 extends cA{constructor(a=c7.DEFAULT_IMAGE,b=c7.DEFAULT_MAPPING,c=aw,d=aw,e=aD,f=aG,g=aW,h=aI,i=c7.DEFAULT_ANISOTROPY,j=bV){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:c6++}),this.uuid=cF(),this.name="",this.source=new c4(a),this.mipmaps=[],this.mapping=b,this.channel=0,this.wrapS=c,this.wrapT=d,this.magFilter=e,this.minFilter=f,this.anisotropy=i,this.format=g,this.internalFormat=null,this.type=h,this.offset=new cM(0,0),this.repeat=new cM(1,1),this.center=new cM(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cN,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=j,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(a){return this.name=a.name,this.source=a.source,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.channel=a.channel,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.internalFormat=a.internalFormat,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.colorSpace=a.colorSpace,this.renderTarget=a.renderTarget,this.isRenderTargetTexture=a.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(a.userData)),this.needsUpdate=!0,this}toJSON(a){let b=void 0===a||"string"==typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];let c={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(c.userData=this.userData),b||(a.textures[this.uuid]=c),c}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(this.mapping!==ap)return a;if(a.applyMatrix3(this.matrix),a.x<0||a.x>1)switch(this.wrapS){case av:a.x=a.x-Math.floor(a.x);break;case aw:a.x=a.x<0?0:1;break;case ax:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x=a.x-Math.floor(a.x)}if(a.y<0||a.y>1)switch(this.wrapT){case av:a.y=a.y-Math.floor(a.y);break;case aw:a.y=a.y<0?0:1;break;case ax:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y=a.y-Math.floor(a.y)}return this.flipY&&(a.y=1-a.y),a}set needsUpdate(a){!0===a&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(a){!0===a&&this.pmremVersion++}}c7.DEFAULT_IMAGE=null,c7.DEFAULT_MAPPING=ap,c7.DEFAULT_ANISOTROPY=1;class c8{constructor(a=0,b=0,c=0,d=1){c8.prototype.isVector4=!0,this.x=a,this.y=b,this.z=c,this.w=d}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this.w=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setW(a){return this.w=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this}applyMatrix4(a){let b=this.x,c=this.y,d=this.z,e=this.w,f=a.elements;return this.x=f[0]*b+f[4]*c+f[8]*d+f[12]*e,this.y=f[1]*b+f[5]*c+f[9]*d+f[13]*e,this.z=f[2]*b+f[6]*c+f[10]*d+f[14]*e,this.w=f[3]*b+f[7]*c+f[11]*d+f[15]*e,this}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this.w/=a.w,this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);let b=Math.sqrt(1-a.w*a.w);return b<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this}setAxisAngleFromRotationMatrix(a){let b,c,d,e,f=a.elements,g=f[0],h=f[4],i=f[8],j=f[1],k=f[5],l=f[9],m=f[2],n=f[6],o=f[10];if(.01>Math.abs(h-j)&&.01>Math.abs(i-m)&&.01>Math.abs(l-n)){if(.1>Math.abs(h+j)&&.1>Math.abs(i+m)&&.1>Math.abs(l+n)&&.1>Math.abs(g+k+o-3))return this.set(1,0,0,0),this;b=Math.PI;let a=(g+1)/2,f=(k+1)/2,p=(o+1)/2,q=(h+j)/4,r=(i+m)/4,s=(l+n)/4;return a>f&&a>p?a<.01?(c=0,d=.707106781,e=.707106781):(d=q/(c=Math.sqrt(a)),e=r/c):f>p?f<.01?(c=.707106781,d=0,e=.707106781):(c=q/(d=Math.sqrt(f)),e=s/d):p<.01?(c=.707106781,d=.707106781,e=0):(c=r/(e=Math.sqrt(p)),d=s/e),this.set(c,d,e,b),this}let p=Math.sqrt((n-l)*(n-l)+(i-m)*(i-m)+(j-h)*(j-h));return .001>Math.abs(p)&&(p=1),this.x=(n-l)/p,this.y=(i-m)/p,this.z=(j-h)/p,this.w=Math.acos((g+k+o-1)/2),this}setFromMatrixPosition(a){let b=a.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this.w=b[15],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this}clamp(a,b){return this.x=cG(this.x,a.x,b.x),this.y=cG(this.y,a.y,b.y),this.z=cG(this.z,a.z,b.z),this.w=cG(this.w,a.w,b.w),this}clampScalar(a,b){return this.x=cG(this.x,a,b),this.y=cG(this.y,a,b),this.z=cG(this.z,a,b),this.w=cG(this.w,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(cG(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this.w=a.w+(b.w-a.w)*c,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this.z=a[b+2],this.w=a[b+3],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this.w=a.getW(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class c9 extends cA{constructor(a=1,b=1,c={}){super(),this.isRenderTarget=!0,this.width=a,this.height=b,this.depth=1,this.scissor=new c8(0,0,a,b),this.scissorTest=!1,this.viewport=new c8(0,0,a,b);let d=new c7({width:a,height:b,depth:1},(c=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:aD,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},c)).mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.colorSpace);d.flipY=!1,d.generateMipmaps=c.generateMipmaps,d.internalFormat=c.internalFormat,this.textures=[];let e=c.count;for(let a=0;a<e;a++)this.textures[a]=d.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this.depthBuffer=c.depthBuffer,this.stencilBuffer=c.stencilBuffer,this.resolveDepthBuffer=c.resolveDepthBuffer,this.resolveStencilBuffer=c.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=c.depthTexture,this.samples=c.samples}get texture(){return this.textures[0]}set texture(a){this.textures[0]=a}set depthTexture(a){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==a&&(a.renderTarget=this),this._depthTexture=a}get depthTexture(){return this._depthTexture}setSize(a,b,c=1){if(this.width!==a||this.height!==b||this.depth!==c){this.width=a,this.height=b,this.depth=c;for(let d=0,e=this.textures.length;d<e;d++)this.textures[d].image.width=a,this.textures[d].image.height=b,this.textures[d].image.depth=c;this.dispose()}this.viewport.set(0,0,a,b),this.scissor.set(0,0,a,b)}clone(){return new this.constructor().copy(this)}copy(a){this.width=a.width,this.height=a.height,this.depth=a.depth,this.scissor.copy(a.scissor),this.scissorTest=a.scissorTest,this.viewport.copy(a.viewport),this.textures.length=0;for(let b=0,c=a.textures.length;b<c;b++)this.textures[b]=a.textures[b].clone(),this.textures[b].isRenderTargetTexture=!0,this.textures[b].renderTarget=this;let b=Object.assign({},a.texture.image);return this.texture.source=new c4(b),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.resolveDepthBuffer=a.resolveDepthBuffer,this.resolveStencilBuffer=a.resolveStencilBuffer,null!==a.depthTexture&&(this.depthTexture=a.depthTexture.clone()),this.samples=a.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class da extends c9{constructor(a=1,b=1,c={}){super(a,b,c),this.isWebGLRenderTarget=!0}}class db extends c7{constructor(a=null,b=1,c=1,d=1){super(null),this.isDataArrayTexture=!0,this.image={data:a,width:b,height:c,depth:d},this.magFilter=ay,this.minFilter=ay,this.wrapR=aw,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(a){this.layerUpdates.add(a)}clearLayerUpdates(){this.layerUpdates.clear()}}class dc extends da{constructor(a=1,b=1,c=1,d={}){super(a,b,d),this.isWebGLArrayRenderTarget=!0,this.depth=c,this.texture=new db(null,a,b,c),this.texture.isRenderTargetTexture=!0}}class dd extends c7{constructor(a=null,b=1,c=1,d=1){super(null),this.isData3DTexture=!0,this.image={data:a,width:b,height:c,depth:d},this.magFilter=ay,this.minFilter=ay,this.wrapR=aw,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class de extends da{constructor(a=1,b=1,c=1,d={}){super(a,b,d),this.isWebGL3DRenderTarget=!0,this.depth=c,this.texture=new dd(null,a,b,c),this.texture.isRenderTargetTexture=!0}}class df{constructor(a=0,b=0,c=0,d=1){this.isQuaternion=!0,this._x=a,this._y=b,this._z=c,this._w=d}static slerpFlat(a,b,c,d,e,f,g){let h=c[d+0],i=c[d+1],j=c[d+2],k=c[d+3],l=e[f+0],m=e[f+1],n=e[f+2],o=e[f+3];if(0===g){a[b+0]=h,a[b+1]=i,a[b+2]=j,a[b+3]=k;return}if(1===g){a[b+0]=l,a[b+1]=m,a[b+2]=n,a[b+3]=o;return}if(k!==o||h!==l||i!==m||j!==n){let a=1-g,b=h*l+i*m+j*n+k*o,c=b>=0?1:-1,d=1-b*b;if(d>Number.EPSILON){let e=Math.sqrt(d),f=Math.atan2(e,b*c);a=Math.sin(a*f)/e,g=Math.sin(g*f)/e}let e=g*c;if(h=h*a+l*e,i=i*a+m*e,j=j*a+n*e,k=k*a+o*e,a===1-g){let a=1/Math.sqrt(h*h+i*i+j*j+k*k);h*=a,i*=a,j*=a,k*=a}}a[b]=h,a[b+1]=i,a[b+2]=j,a[b+3]=k}static multiplyQuaternionsFlat(a,b,c,d,e,f){let g=c[d],h=c[d+1],i=c[d+2],j=c[d+3],k=e[f],l=e[f+1],m=e[f+2],n=e[f+3];return a[b]=g*n+j*k+h*m-i*l,a[b+1]=h*n+j*l+i*k-g*m,a[b+2]=i*n+j*m+g*l-h*k,a[b+3]=j*n-g*k-h*l-i*m,a}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a,this._onChangeCallback()}set(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this}setFromEuler(a,b=!0){let c=a._x,d=a._y,e=a._z,f=a._order,g=Math.cos,h=Math.sin,i=g(c/2),j=g(d/2),k=g(e/2),l=h(c/2),m=h(d/2),n=h(e/2);switch(f){case"XYZ":this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n;break;case"YXZ":this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n;break;case"ZXY":this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n;break;case"ZYX":this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n;break;case"YZX":this._x=l*j*k+i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k-l*m*n;break;case"XZY":this._x=l*j*k-i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k+l*m*n;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+f)}return!0===b&&this._onChangeCallback(),this}setFromAxisAngle(a,b){let c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this._onChangeCallback(),this}setFromRotationMatrix(a){let b=a.elements,c=b[0],d=b[4],e=b[8],f=b[1],g=b[5],h=b[9],i=b[2],j=b[6],k=b[10],l=c+g+k;if(l>0){let a=.5/Math.sqrt(l+1);this._w=.25/a,this._x=(j-h)*a,this._y=(e-i)*a,this._z=(f-d)*a}else if(c>g&&c>k){let a=2*Math.sqrt(1+c-g-k);this._w=(j-h)/a,this._x=.25*a,this._y=(d+f)/a,this._z=(e+i)/a}else if(g>k){let a=2*Math.sqrt(1+g-c-k);this._w=(e-i)/a,this._x=(d+f)/a,this._y=.25*a,this._z=(h+j)/a}else{let a=2*Math.sqrt(1+k-c-g);this._w=(f-d)/a,this._x=(e+i)/a,this._y=(h+j)/a,this._z=.25*a}return this._onChangeCallback(),this}setFromUnitVectors(a,b){let c=a.dot(b)+1;return c<Number.EPSILON?(c=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0):(this._x=0,this._y=-a.z,this._z=a.y)):(this._x=a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x),this._w=c,this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(cG(this.dot(a),-1,1)))}rotateTowards(a,b){let c=this.angleTo(a);if(0===c)return this;let d=Math.min(1,b/c);return this.slerp(a,d),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,b){let c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this._onChangeCallback(),this}slerp(a,b){if(0===b)return this;if(1===b)return this.copy(a);let c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(g<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),g>=1)return this._w=f,this._x=c,this._y=d,this._z=e,this;let h=1-g*g;if(h<=Number.EPSILON){let a=1-b;return this._w=a*f+b*this._w,this._x=a*c+b*this._x,this._y=a*d+b*this._y,this._z=a*e+b*this._z,this.normalize(),this}let i=Math.sqrt(h),j=Math.atan2(i,g),k=Math.sin((1-b)*j)/i,l=Math.sin(b*j)/i;return this._w=f*k+this._w*l,this._x=c*k+this._x*l,this._y=d*k+this._y*l,this._z=e*k+this._z*l,this._onChangeCallback(),this}slerpQuaternions(a,b,c){return this.copy(a).slerp(b,c)}random(){let a=2*Math.PI*Math.random(),b=2*Math.PI*Math.random(),c=Math.random(),d=Math.sqrt(1-c),e=Math.sqrt(c);return this.set(d*Math.sin(a),d*Math.cos(a),e*Math.sin(b),e*Math.cos(b))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,b=0){return this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this._onChangeCallback(),this}toArray(a=[],b=0){return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a}fromBufferAttribute(a,b){return this._x=a.getX(b),this._y=a.getY(b),this._z=a.getZ(b),this._w=a.getW(b),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class dg{constructor(a=0,b=0,c=0){dg.prototype.isVector3=!0,this.x=a,this.y=b,this.z=c}set(a,b,c){return void 0===c&&(c=this.z),this.x=a,this.y=b,this.z=c,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}multiplyVectors(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this}applyEuler(a){return this.applyQuaternion(di.setFromEuler(a))}applyAxisAngle(a,b){return this.applyQuaternion(di.setFromAxisAngle(a,b))}applyMatrix3(a){let b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){let b=this.x,c=this.y,d=this.z,e=a.elements,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this}applyQuaternion(a){let b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=2*(f*d-g*c),j=2*(g*b-e*d),k=2*(e*c-f*b);return this.x=b+h*i+f*k-g*j,this.y=c+h*j+g*i-e*k,this.z=d+h*k+e*j-f*i,this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){let b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d,this.y=e[1]*b+e[5]*c+e[9]*d,this.z=e[2]*b+e[6]*c+e[10]*d,this.normalize()}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}clamp(a,b){return this.x=cG(this.x,a.x,b.x),this.y=cG(this.y,a.y,b.y),this.z=cG(this.z,a.z,b.z),this}clampScalar(a,b){return this.x=cG(this.x,a,b),this.y=cG(this.y,a,b),this.z=cG(this.z,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(cG(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this}cross(a){return this.crossVectors(this,a)}crossVectors(a,b){let c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this}projectOnVector(a){let b=a.lengthSq();if(0===b)return this.set(0,0,0);let c=a.dot(this)/b;return this.copy(a).multiplyScalar(c)}projectOnPlane(a){return dh.copy(this).projectOnVector(a),this.sub(dh)}reflect(a){return this.sub(dh.copy(a).multiplyScalar(2*this.dot(a)))}angleTo(a){let b=Math.sqrt(this.lengthSq()*a.lengthSq());return 0===b?Math.PI/2:Math.acos(cG(this.dot(a)/b,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){let b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,b,c){let d=Math.sin(b)*a;return this.x=d*Math.sin(c),this.y=Math.cos(b)*a,this.z=d*Math.cos(c),this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,b,c){return this.x=a*Math.sin(b),this.y=c,this.z=a*Math.cos(b),this}setFromMatrixPosition(a){let b=a.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this}setFromMatrixScale(a){let b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length(),d=this.setFromMatrixColumn(a,2).length();return this.x=b,this.y=c,this.z=d,this}setFromMatrixColumn(a,b){return this.fromArray(a.elements,4*b)}setFromMatrix3Column(a,b){return this.fromArray(a.elements,3*b)}setFromEuler(a){return this.x=a._x,this.y=a._y,this.z=a._z,this}setFromColor(a){return this.x=a.r,this.y=a.g,this.z=a.b,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this.z=a[b+2],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let a=Math.random()*Math.PI*2,b=2*Math.random()-1,c=Math.sqrt(1-b*b);return this.x=c*Math.cos(a),this.y=b,this.z=c*Math.sin(a),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}let dh=new dg,di=new df;class dj{constructor(a=new dg(Infinity,Infinity,Infinity),b=new dg(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=a,this.max=b}set(a,b){return this.min.copy(a),this.max.copy(b),this}setFromArray(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b+=3)this.expandByPoint(dl.fromArray(a,b));return this}setFromBufferAttribute(a){this.makeEmpty();for(let b=0,c=a.count;b<c;b++)this.expandByPoint(dl.fromBufferAttribute(a,b));return this}setFromPoints(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){let c=dl.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(c),this.max.copy(a).add(c),this}setFromObject(a,b=!1){return this.makeEmpty(),this.expandByObject(a,b)}clone(){return new this.constructor().copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}expandByObject(a,b=!1){a.updateWorldMatrix(!1,!1);let c=a.geometry;if(void 0!==c){let d=c.getAttribute("position");if(!0===b&&void 0!==d&&!0!==a.isInstancedMesh)for(let b=0,c=d.count;b<c;b++)!0===a.isMesh?a.getVertexPosition(b,dl):dl.fromBufferAttribute(d,b),dl.applyMatrix4(a.matrixWorld),this.expandByPoint(dl);else void 0!==a.boundingBox?(null===a.boundingBox&&a.computeBoundingBox(),dm.copy(a.boundingBox)):(null===c.boundingBox&&c.computeBoundingBox(),dm.copy(c.boundingBox)),dm.applyMatrix4(a.matrixWorld),this.union(dm)}let d=a.children;for(let a=0,c=d.length;a<c;a++)this.expandByObject(d[a],b);return this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y&&a.z>=this.min.z&&a.z<=this.max.z}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&a.max.y>=this.min.y&&a.min.y<=this.max.y&&a.max.z>=this.min.z&&a.min.z<=this.max.z}intersectsSphere(a){return this.clampPoint(a.center,dl),dl.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let b,c;return a.normal.x>0?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x),a.normal.y>0?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),a.normal.z>0?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=-a.constant&&c>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(du),dv.subVectors(this.max,du),dn.subVectors(a.a,du),dp.subVectors(a.b,du),dq.subVectors(a.c,du),dr.subVectors(dp,dn),ds.subVectors(dq,dp),dt.subVectors(dn,dq);let b=[0,-dr.z,dr.y,0,-ds.z,ds.y,0,-dt.z,dt.y,dr.z,0,-dr.x,ds.z,0,-ds.x,dt.z,0,-dt.x,-dr.y,dr.x,0,-ds.y,ds.x,0,-dt.y,dt.x,0];return!!dy(b,dn,dp,dq,dv)&&!!dy(b=[1,0,0,0,1,0,0,0,1],dn,dp,dq,dv)&&(dw.crossVectors(dr,ds),dy(b=[dw.x,dw.y,dw.z],dn,dp,dq,dv))}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,dl).distanceTo(a)}getBoundingSphere(a){return this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=.5*this.getSize(dl).length()),a}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}applyMatrix4(a){return this.isEmpty()||(dk[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),dk[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),dk[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),dk[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),dk[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),dk[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),dk[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),dk[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(dk)),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}let dk=[new dg,new dg,new dg,new dg,new dg,new dg,new dg,new dg],dl=new dg,dm=new dj,dn=new dg,dp=new dg,dq=new dg,dr=new dg,ds=new dg,dt=new dg,du=new dg,dv=new dg,dw=new dg,dx=new dg;function dy(a,b,c,d,e){for(let f=0,g=a.length-3;f<=g;f+=3){dx.fromArray(a,f);let g=e.x*Math.abs(dx.x)+e.y*Math.abs(dx.y)+e.z*Math.abs(dx.z),h=b.dot(dx),i=c.dot(dx),j=d.dot(dx);if(Math.max(-Math.max(h,i,j),Math.min(h,i,j))>g)return!1}return!0}let dz=new dj,dA=new dg,dB=new dg;class dC{constructor(a=new dg,b=-1){this.isSphere=!0,this.center=a,this.radius=b}set(a,b){return this.center.copy(a),this.radius=b,this}setFromPoints(a,b){let c=this.center;void 0!==b?c.copy(b):dz.setFromPoints(a).getCenter(c);let d=0;for(let b=0,e=a.length;b<e;b++)d=Math.max(d,c.distanceToSquared(a[b]));return this.radius=Math.sqrt(d),this}copy(a){return this.center.copy(a.center),this.radius=a.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){let b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,b){let c=this.center.distanceToSquared(a);return b.copy(a),c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b}getBoundingBox(a){return this.isEmpty()?a.makeEmpty():(a.set(this.center,this.center),a.expandByScalar(this.radius)),a}applyMatrix4(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this}translate(a){return this.center.add(a),this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;dA.subVectors(a,this.center);let b=dA.lengthSq();if(b>this.radius*this.radius){let a=Math.sqrt(b),c=(a-this.radius)*.5;this.center.addScaledVector(dA,c/a),this.radius+=c}return this}union(a){return a.isEmpty()||(this.isEmpty()?this.copy(a):!0===this.center.equals(a.center)?this.radius=Math.max(this.radius,a.radius):(dB.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint(dA.copy(a.center).add(dB)),this.expandByPoint(dA.copy(a.center).sub(dB)))),this}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return new this.constructor().copy(this)}}let dD=new dg,dE=new dg,dF=new dg,dG=new dg,dH=new dg,dI=new dg,dJ=new dg;class dK{constructor(a=new dg,b=new dg(0,0,-1)){this.origin=a,this.direction=b}set(a,b){return this.origin.copy(a),this.direction.copy(b),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,b){return b.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){return this.direction.copy(a).sub(this.origin).normalize(),this}recast(a){return this.origin.copy(this.at(a,dD)),this}closestPointToPoint(a,b){b.subVectors(a,this.origin);let c=b.dot(this.direction);return c<0?b.copy(this.origin):b.copy(this.origin).addScaledVector(this.direction,c)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){let b=dD.subVectors(a,this.origin).dot(this.direction);return b<0?this.origin.distanceToSquared(a):(dD.copy(this.origin).addScaledVector(this.direction,b),dD.distanceToSquared(a))}distanceSqToSegment(a,b,c,d){let e,f,g,h;dE.copy(a).add(b).multiplyScalar(.5),dF.copy(b).sub(a).normalize(),dG.copy(this.origin).sub(dE);let i=.5*a.distanceTo(b),j=-this.direction.dot(dF),k=dG.dot(this.direction),l=-dG.dot(dF),m=dG.lengthSq(),n=Math.abs(1-j*j);if(n>0)if(e=j*l-k,f=j*k-l,h=i*n,e>=0)if(f>=-h)if(f<=h){let a=1/n;e*=a,f*=a,g=e*(e+j*f+2*k)+f*(j*e+f+2*l)+m}else g=-(e=Math.max(0,-(j*(f=i)+k)))*e+f*(f+2*l)+m;else g=-(e=Math.max(0,-(j*(f=-i)+k)))*e+f*(f+2*l)+m;else f<=-h?(f=(e=Math.max(0,-(-j*i+k)))>0?-i:Math.min(Math.max(-i,-l),i),g=-e*e+f*(f+2*l)+m):f<=h?(e=0,g=(f=Math.min(Math.max(-i,-l),i))*(f+2*l)+m):(f=(e=Math.max(0,-(j*i+k)))>0?i:Math.min(Math.max(-i,-l),i),g=-e*e+f*(f+2*l)+m);else f=j>0?-i:i,g=-(e=Math.max(0,-(j*f+k)))*e+f*(f+2*l)+m;return c&&c.copy(this.origin).addScaledVector(this.direction,e),d&&d.copy(dE).addScaledVector(dF,f),g}intersectSphere(a,b){dD.subVectors(a.center,this.origin);let c=dD.dot(this.direction),d=dD.dot(dD)-c*c,e=a.radius*a.radius;if(d>e)return null;let f=Math.sqrt(e-d),g=c-f,h=c+f;return h<0?null:g<0?this.at(h,b):this.at(g,b)}intersectsSphere(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius}distanceToPlane(a){let b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;let c=-(this.origin.dot(a.normal)+a.constant)/b;return c>=0?c:null}intersectPlane(a,b){let c=this.distanceToPlane(a);return null===c?null:this.at(c,b)}intersectsPlane(a){let b=a.distanceToPoint(this.origin);return!!(0===b||a.normal.dot(this.direction)*b<0)}intersectBox(a,b){let c,d,e,f,g,h,i=1/this.direction.x,j=1/this.direction.y,k=1/this.direction.z,l=this.origin;return(i>=0?(c=(a.min.x-l.x)*i,d=(a.max.x-l.x)*i):(c=(a.max.x-l.x)*i,d=(a.min.x-l.x)*i),j>=0?(e=(a.min.y-l.y)*j,f=(a.max.y-l.y)*j):(e=(a.max.y-l.y)*j,f=(a.min.y-l.y)*j),c>f||e>d||((e>c||isNaN(c))&&(c=e),(f<d||isNaN(d))&&(d=f),k>=0?(g=(a.min.z-l.z)*k,h=(a.max.z-l.z)*k):(g=(a.max.z-l.z)*k,h=(a.min.z-l.z)*k),c>h||g>d||((g>c||c!=c)&&(c=g),(h<d||d!=d)&&(d=h),d<0)))?null:this.at(c>=0?c:d,b)}intersectsBox(a){return null!==this.intersectBox(a,dD)}intersectTriangle(a,b,c,d,e){let f;dH.subVectors(b,a),dI.subVectors(c,a),dJ.crossVectors(dH,dI);let g=this.direction.dot(dJ);if(g>0){if(d)return null;f=1}else{if(!(g<0))return null;f=-1,g=-g}dG.subVectors(this.origin,a);let h=f*this.direction.dot(dI.crossVectors(dG,dI));if(h<0)return null;let i=f*this.direction.dot(dH.cross(dG));if(i<0||h+i>g)return null;let j=-f*dG.dot(dJ);return j<0?null:this.at(j/g,e)}applyMatrix4(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class dL{constructor(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){dL.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==a&&this.set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){let q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new dL().fromArray(this.elements)}copy(a){let b=this.elements,c=a.elements;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],b[9]=c[9],b[10]=c[10],b[11]=c[11],b[12]=c[12],b[13]=c[13],b[14]=c[14],b[15]=c[15],this}copyPosition(a){let b=this.elements,c=a.elements;return b[12]=c[12],b[13]=c[13],b[14]=c[14],this}setFromMatrix3(a){let b=a.elements;return this.set(b[0],b[3],b[6],0,b[1],b[4],b[7],0,b[2],b[5],b[8],0,0,0,0,1),this}extractBasis(a,b,c){return a.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),c.setFromMatrixColumn(this,2),this}makeBasis(a,b,c){return this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this}extractRotation(a){let b=this.elements,c=a.elements,d=1/dM.setFromMatrixColumn(a,0).length(),e=1/dM.setFromMatrixColumn(a,1).length(),f=1/dM.setFromMatrixColumn(a,2).length();return b[0]=c[0]*d,b[1]=c[1]*d,b[2]=c[2]*d,b[3]=0,b[4]=c[4]*e,b[5]=c[5]*e,b[6]=c[6]*e,b[7]=0,b[8]=c[8]*f,b[9]=c[9]*f,b[10]=c[10]*f,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromEuler(a){let b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c),g=Math.sin(c),h=Math.cos(d),i=Math.sin(d),j=Math.cos(e),k=Math.sin(e);if("XYZ"===a.order){let a=f*j,c=f*k,d=g*j,e=g*k;b[0]=h*j,b[4]=-h*k,b[8]=i,b[1]=c+d*i,b[5]=a-e*i,b[9]=-g*h,b[2]=e-a*i,b[6]=d+c*i,b[10]=f*h}else if("YXZ"===a.order){let a=h*j,c=h*k,d=i*j,e=i*k;b[0]=a+e*g,b[4]=d*g-c,b[8]=f*i,b[1]=f*k,b[5]=f*j,b[9]=-g,b[2]=c*g-d,b[6]=e+a*g,b[10]=f*h}else if("ZXY"===a.order){let a=h*j,c=h*k,d=i*j,e=i*k;b[0]=a-e*g,b[4]=-f*k,b[8]=d+c*g,b[1]=c+d*g,b[5]=f*j,b[9]=e-a*g,b[2]=-f*i,b[6]=g,b[10]=f*h}else if("ZYX"===a.order){let a=f*j,c=f*k,d=g*j,e=g*k;b[0]=h*j,b[4]=d*i-c,b[8]=a*i+e,b[1]=h*k,b[5]=e*i+a,b[9]=c*i-d,b[2]=-i,b[6]=g*h,b[10]=f*h}else if("YZX"===a.order){let a=f*h,c=f*i,d=g*h,e=g*i;b[0]=h*j,b[4]=e-a*k,b[8]=d*k+c,b[1]=k,b[5]=f*j,b[9]=-g*j,b[2]=-i*j,b[6]=c*k+d,b[10]=a-e*k}else if("XZY"===a.order){let a=f*h,c=f*i,d=g*h,e=g*i;b[0]=h*j,b[4]=-k,b[8]=i*j,b[1]=a*k+e,b[5]=f*j,b[9]=c*k-d,b[2]=d*k-c,b[6]=g*j,b[10]=e*k+a}return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromQuaternion(a){return this.compose(dO,a,dP)}lookAt(a,b,c){let d=this.elements;return dS.subVectors(a,b),0===dS.lengthSq()&&(dS.z=1),dS.normalize(),dQ.crossVectors(c,dS),0===dQ.lengthSq()&&(1===Math.abs(c.z)?dS.x+=1e-4:dS.z+=1e-4,dS.normalize(),dQ.crossVectors(c,dS)),dQ.normalize(),dR.crossVectors(dS,dQ),d[0]=dQ.x,d[4]=dR.x,d[8]=dS.x,d[1]=dQ.y,d[5]=dR.y,d[9]=dS.y,d[2]=dQ.z,d[6]=dR.z,d[10]=dS.z,this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){let c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this}multiplyScalar(a){let b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this}determinant(){let a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7];return n*(e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+o*(b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+a[11]*(b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+a[15]*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)}transpose(){let a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this}setPosition(a,b,c){let d=this.elements;return a.isVector3?(d[12]=a.x,d[13]=a.y,d[14]=a.z):(d[12]=a,d[13]=b,d[14]=c),this}invert(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=k*p*i-o*l*i+o*h*m-g*p*m-k*h*q+g*l*q,s=n*l*i-j*p*i-n*h*m+f*p*m+j*h*q-f*l*q,t=j*o*i-n*k*i+n*g*m-f*o*m-j*g*q+f*k*q,u=n*k*h-j*o*h-n*g*l+f*o*l+j*g*p-f*k*p,v=b*r+c*s+d*t+e*u;if(0===v)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let w=1/v;return a[0]=r*w,a[1]=(o*l*e-k*p*e-o*d*m+c*p*m+k*d*q-c*l*q)*w,a[2]=(g*p*e-o*h*e+o*d*i-c*p*i-g*d*q+c*h*q)*w,a[3]=(k*h*e-g*l*e-k*d*i+c*l*i+g*d*m-c*h*m)*w,a[4]=s*w,a[5]=(j*p*e-n*l*e+n*d*m-b*p*m-j*d*q+b*l*q)*w,a[6]=(n*h*e-f*p*e-n*d*i+b*p*i+f*d*q-b*h*q)*w,a[7]=(f*l*e-j*h*e+j*d*i-b*l*i-f*d*m+b*h*m)*w,a[8]=t*w,a[9]=(n*k*e-j*o*e-n*c*m+b*o*m+j*c*q-b*k*q)*w,a[10]=(f*o*e-n*g*e+n*c*i-b*o*i-f*c*q+b*g*q)*w,a[11]=(j*g*e-f*k*e-j*c*i+b*k*i+f*c*m-b*g*m)*w,a[12]=u*w,a[13]=(j*o*d-n*k*d+n*c*l-b*o*l-j*c*p+b*k*p)*w,a[14]=(n*g*d-f*o*d-n*c*h+b*o*h+f*c*p-b*g*p)*w,a[15]=(f*k*d-j*g*d+j*c*h-b*k*h-f*c*l+b*g*l)*w,this}scale(a){let b=this.elements,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this}getMaxScaleOnAxis(){let a=this.elements,b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];return Math.sqrt(Math.max(b,a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,b,c){return a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this}makeRotationX(a){let b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this}makeRotationY(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this}makeRotationZ(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(a,b){let c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this}makeScale(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this}makeShear(a,b,c,d,e,f){return this.set(1,c,e,0,a,1,f,0,b,d,1,0,0,0,0,1),this}compose(a,b,c){let d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,i=e+e,j=f+f,k=g+g,l=e*i,m=e*j,n=e*k,o=f*j,p=f*k,q=g*k,r=h*i,s=h*j,t=h*k,u=c.x,v=c.y,w=c.z;return d[0]=(1-(o+q))*u,d[1]=(m+t)*u,d[2]=(n-s)*u,d[3]=0,d[4]=(m-t)*v,d[5]=(1-(l+q))*v,d[6]=(p+r)*v,d[7]=0,d[8]=(n+s)*w,d[9]=(p-r)*w,d[10]=(1-(l+o))*w,d[11]=0,d[12]=a.x,d[13]=a.y,d[14]=a.z,d[15]=1,this}decompose(a,b,c){let d=this.elements,e=dM.set(d[0],d[1],d[2]).length(),f=dM.set(d[4],d[5],d[6]).length(),g=dM.set(d[8],d[9],d[10]).length();0>this.determinant()&&(e=-e),a.x=d[12],a.y=d[13],a.z=d[14],dN.copy(this);let h=1/e,i=1/f,j=1/g;return dN.elements[0]*=h,dN.elements[1]*=h,dN.elements[2]*=h,dN.elements[4]*=i,dN.elements[5]*=i,dN.elements[6]*=i,dN.elements[8]*=j,dN.elements[9]*=j,dN.elements[10]*=j,b.setFromRotationMatrix(dN),c.x=e,c.y=f,c.z=g,this}makePerspective(a,b,c,d,e,f,g=cx){let h,i,j=this.elements;if(g===cx)h=-(f+e)/(f-e),i=-2*f*e/(f-e);else if(g===cy)h=-f/(f-e),i=-f*e/(f-e);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+g);return j[0]=2*e/(b-a),j[4]=0,j[8]=(b+a)/(b-a),j[12]=0,j[1]=0,j[5]=2*e/(c-d),j[9]=(c+d)/(c-d),j[13]=0,j[2]=0,j[6]=0,j[10]=h,j[14]=i,j[3]=0,j[7]=0,j[11]=-1,j[15]=0,this}makeOrthographic(a,b,c,d,e,f,g=cx){let h,i,j=this.elements,k=1/(b-a),l=1/(c-d),m=1/(f-e);if(g===cx)h=(f+e)*m,i=-2*m;else if(g===cy)h=e*m,i=-1*m;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+g);return j[0]=2*k,j[4]=0,j[8]=0,j[12]=-((b+a)*k),j[1]=0,j[5]=2*l,j[9]=0,j[13]=-((c+d)*l),j[2]=0,j[6]=0,j[10]=i,j[14]=-h,j[3]=0,j[7]=0,j[11]=0,j[15]=1,this}equals(a){let b=this.elements,c=a.elements;for(let a=0;a<16;a++)if(b[a]!==c[a])return!1;return!0}fromArray(a,b=0){for(let c=0;c<16;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){let c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a}}let dM=new dg,dN=new dL,dO=new dg(0,0,0),dP=new dg(1,1,1),dQ=new dg,dR=new dg,dS=new dg,dT=new dL,dU=new df;class dV{constructor(a=0,b=0,c=0,d=dV.DEFAULT_ORDER){this.isEuler=!0,this._x=a,this._y=b,this._z=c,this._order=d}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get order(){return this._order}set order(a){this._order=a,this._onChangeCallback()}set(a,b,c,d=this._order){return this._x=a,this._y=b,this._z=c,this._order=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._onChangeCallback(),this}setFromRotationMatrix(a,b=this._order,c=!0){let d=a.elements,e=d[0],f=d[4],g=d[8],h=d[1],i=d[5],j=d[9],k=d[2],l=d[6],m=d[10];switch(b){case"XYZ":this._y=Math.asin(cG(g,-1,1)),.9999999>Math.abs(g)?(this._x=Math.atan2(-j,m),this._z=Math.atan2(-f,e)):(this._x=Math.atan2(l,i),this._z=0);break;case"YXZ":this._x=Math.asin(-cG(j,-1,1)),.9999999>Math.abs(j)?(this._y=Math.atan2(g,m),this._z=Math.atan2(h,i)):(this._y=Math.atan2(-k,e),this._z=0);break;case"ZXY":this._x=Math.asin(cG(l,-1,1)),.9999999>Math.abs(l)?(this._y=Math.atan2(-k,m),this._z=Math.atan2(-f,i)):(this._y=0,this._z=Math.atan2(h,e));break;case"ZYX":this._y=Math.asin(-cG(k,-1,1)),.9999999>Math.abs(k)?(this._x=Math.atan2(l,m),this._z=Math.atan2(h,e)):(this._x=0,this._z=Math.atan2(-f,i));break;case"YZX":this._z=Math.asin(cG(h,-1,1)),.9999999>Math.abs(h)?(this._x=Math.atan2(-j,i),this._y=Math.atan2(-k,e)):(this._x=0,this._y=Math.atan2(g,m));break;case"XZY":this._z=Math.asin(-cG(f,-1,1)),.9999999>Math.abs(f)?(this._x=Math.atan2(l,i),this._y=Math.atan2(g,e)):(this._x=Math.atan2(-j,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}return this._order=b,!0===c&&this._onChangeCallback(),this}setFromQuaternion(a,b,c){return dT.makeRotationFromQuaternion(a),this.setFromRotationMatrix(dT,b,c)}setFromVector3(a,b=this._order){return this.set(a.x,a.y,a.z,b)}reorder(a){return dU.setFromEuler(this),this.setFromQuaternion(dU,a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){return this._x=a[0],this._y=a[1],this._z=a[2],void 0!==a[3]&&(this._order=a[3]),this._onChangeCallback(),this}toArray(a=[],b=0){return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}dV.DEFAULT_ORDER="XYZ";class dW{constructor(){this.mask=1}set(a){this.mask=1<<a>>>0}enable(a){this.mask|=1<<a}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a}disable(a){this.mask&=~(1<<a)}disableAll(){this.mask=0}test(a){return(this.mask&a.mask)!=0}isEnabled(a){return(this.mask&1<<a)!=0}}let dX=0,dY=new dg,dZ=new df,d$=new dL,d_=new dg,d0=new dg,d1=new dg,d2=new df,d3=new dg(1,0,0),d4=new dg(0,1,0),d5=new dg(0,0,1),d6={type:"added"},d7={type:"removed"},d8={type:"childadded",child:null},d9={type:"childremoved",child:null};class ea extends cA{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dX++}),this.uuid=cF(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ea.DEFAULT_UP.clone();let a=new dg,b=new dV,c=new df,d=new dg(1,1,1);b._onChange(function(){c.setFromEuler(b,!1)}),c._onChange(function(){b.setFromQuaternion(c,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new dL},normalMatrix:{value:new cN}}),this.matrix=new dL,this.matrixWorld=new dL,this.matrixAutoUpdate=ea.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ea.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new dW,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(a),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){return this.quaternion.premultiply(a),this}setRotationFromAxisAngle(a,b){this.quaternion.setFromAxisAngle(a,b)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,b){return dZ.setFromAxisAngle(a,b),this.quaternion.multiply(dZ),this}rotateOnWorldAxis(a,b){return dZ.setFromAxisAngle(a,b),this.quaternion.premultiply(dZ),this}rotateX(a){return this.rotateOnAxis(d3,a)}rotateY(a){return this.rotateOnAxis(d4,a)}rotateZ(a){return this.rotateOnAxis(d5,a)}translateOnAxis(a,b){return dY.copy(a).applyQuaternion(this.quaternion),this.position.add(dY.multiplyScalar(b)),this}translateX(a){return this.translateOnAxis(d3,a)}translateY(a){return this.translateOnAxis(d4,a)}translateZ(a){return this.translateOnAxis(d5,a)}localToWorld(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(this.matrixWorld)}worldToLocal(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(d$.copy(this.matrixWorld).invert())}lookAt(a,b,c){a.isVector3?d_.copy(a):d_.set(a,b,c);let d=this.parent;this.updateWorldMatrix(!0,!1),d0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?d$.lookAt(d0,d_,this.up):d$.lookAt(d_,d0,this.up),this.quaternion.setFromRotationMatrix(d$),d&&(d$.extractRotation(d.matrixWorld),dZ.setFromRotationMatrix(d$),this.quaternion.premultiply(dZ.invert()))}add(a){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.add(arguments[a]);return this}return a===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",a):a&&a.isObject3D?(a.removeFromParent(),a.parent=this,this.children.push(a),a.dispatchEvent(d6),d8.child=a,this.dispatchEvent(d8),d8.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this}remove(a){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}let b=this.children.indexOf(a);return -1!==b&&(a.parent=null,this.children.splice(b,1),a.dispatchEvent(d7),d9.child=a,this.dispatchEvent(d9),d9.child=null),this}removeFromParent(){let a=this.parent;return null!==a&&a.remove(this),this}clear(){return this.remove(...this.children)}attach(a){return this.updateWorldMatrix(!0,!1),d$.copy(this.matrixWorld).invert(),null!==a.parent&&(a.parent.updateWorldMatrix(!0,!1),d$.multiply(a.parent.matrixWorld)),a.applyMatrix4(d$),a.removeFromParent(),a.parent=this,this.children.push(a),a.updateWorldMatrix(!1,!0),a.dispatchEvent(d6),d8.child=a,this.dispatchEvent(d8),d8.child=null,this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",a)}getObjectByProperty(a,b){if(this[a]===b)return this;for(let c=0,d=this.children.length;c<d;c++){let d=this.children[c].getObjectByProperty(a,b);if(void 0!==d)return d}}getObjectsByProperty(a,b,c=[]){this[a]===b&&c.push(this);let d=this.children;for(let e=0,f=d.length;e<f;e++)d[e].getObjectsByProperty(a,b,c);return c}getWorldPosition(a){return this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(d0,a,d1),a}getWorldScale(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(d0,d2,a),a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);let b=this.matrixWorld.elements;return a.set(b[8],b[9],b[10]).normalize()}raycast(){}traverse(a){a(this);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverse(a)}traverseVisible(a){if(!1===this.visible)return;a(this);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}traverseAncestors(a){let b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,a=!0);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)}updateWorldMatrix(a,b){let c=this.parent;if(!0===a&&null!==c&&c.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===b){let a=this.children;for(let b=0,c=a.length;b<c;b++)a[b].updateWorldMatrix(!1,!0)}}toJSON(a){let b=void 0===a||"string"==typeof a,c={};b&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},c.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let d={};function e(b,c){return void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a)),c.uuid}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),!0===this.castShadow&&(d.castShadow=!0),!0===this.receiveShadow&&(d.receiveShadow=!0),!1===this.visible&&(d.visible=!1),!1===this.frustumCulled&&(d.frustumCulled=!1),0!==this.renderOrder&&(d.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(d.userData=this.userData),d.layers=this.layers.mask,d.matrix=this.matrix.toArray(),d.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(d.matrixAutoUpdate=!1),this.isInstancedMesh&&(d.type="InstancedMesh",d.count=this.count,d.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(d.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(d.type="BatchedMesh",d.perObjectFrustumCulled=this.perObjectFrustumCulled,d.sortObjects=this.sortObjects,d.drawRanges=this._drawRanges,d.reservedRanges=this._reservedRanges,d.visibility=this._visibility,d.active=this._active,d.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),d.maxInstanceCount=this._maxInstanceCount,d.maxVertexCount=this._maxVertexCount,d.maxIndexCount=this._maxIndexCount,d.geometryInitialized=this._geometryInitialized,d.geometryCount=this._geometryCount,d.matricesTexture=this._matricesTexture.toJSON(a),null!==this._colorsTexture&&(d.colorsTexture=this._colorsTexture.toJSON(a)),null!==this.boundingSphere&&(d.boundingSphere={center:d.boundingSphere.center.toArray(),radius:d.boundingSphere.radius}),null!==this.boundingBox&&(d.boundingBox={min:d.boundingBox.min.toArray(),max:d.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?d.background=this.background.toJSON():this.background.isTexture&&(d.background=this.background.toJSON(a).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(d.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){d.geometry=e(a.geometries,this.geometry);let b=this.geometry.parameters;if(void 0!==b&&void 0!==b.shapes){let c=b.shapes;if(Array.isArray(c))for(let b=0,d=c.length;b<d;b++){let d=c[b];e(a.shapes,d)}else e(a.shapes,c)}}if(this.isSkinnedMesh&&(d.bindMode=this.bindMode,d.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(e(a.skeletons,this.skeleton),d.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let b=[];for(let c=0,d=this.material.length;c<d;c++)b.push(e(a.materials,this.material[c]));d.material=b}else d.material=e(a.materials,this.material);if(this.children.length>0){d.children=[];for(let b=0;b<this.children.length;b++)d.children.push(this.children[b].toJSON(a).object)}if(this.animations.length>0){d.animations=[];for(let b=0;b<this.animations.length;b++){let c=this.animations[b];d.animations.push(e(a.animations,c))}}if(b){let b=f(a.geometries),d=f(a.materials),e=f(a.textures),g=f(a.images),h=f(a.shapes),i=f(a.skeletons),j=f(a.animations),k=f(a.nodes);b.length>0&&(c.geometries=b),d.length>0&&(c.materials=d),e.length>0&&(c.textures=e),g.length>0&&(c.images=g),h.length>0&&(c.shapes=h),i.length>0&&(c.skeletons=i),j.length>0&&(c.animations=j),k.length>0&&(c.nodes=k)}return c.object=d,c;function f(a){let b=[];for(let c in a){let d=a[c];delete d.metadata,b.push(d)}return b}}clone(a){return new this.constructor().copy(this,a)}copy(a,b=!0){if(this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.animations=a.animations.slice(),this.userData=JSON.parse(JSON.stringify(a.userData)),!0===b)for(let b=0;b<a.children.length;b++){let c=a.children[b];this.add(c.clone())}return this}}ea.DEFAULT_UP=new dg(0,1,0),ea.DEFAULT_MATRIX_AUTO_UPDATE=!0,ea.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let eb=new dg,ec=new dg,ed=new dg,ee=new dg,ef=new dg,eg=new dg,eh=new dg,ei=new dg,ej=new dg,ek=new dg,el=new c8,em=new c8,en=new c8;class eo{constructor(a=new dg,b=new dg,c=new dg){this.a=a,this.b=b,this.c=c}static getNormal(a,b,c,d){d.subVectors(c,b),eb.subVectors(a,b),d.cross(eb);let e=d.lengthSq();return e>0?d.multiplyScalar(1/Math.sqrt(e)):d.set(0,0,0)}static getBarycoord(a,b,c,d,e){eb.subVectors(d,b),ec.subVectors(c,b),ed.subVectors(a,b);let f=eb.dot(eb),g=eb.dot(ec),h=eb.dot(ed),i=ec.dot(ec),j=ec.dot(ed),k=f*i-g*g;if(0===k)return e.set(0,0,0),null;let l=1/k,m=(i*h-g*j)*l,n=(f*j-g*h)*l;return e.set(1-m-n,n,m)}static containsPoint(a,b,c,d){return null!==this.getBarycoord(a,b,c,d,ee)&&ee.x>=0&&ee.y>=0&&ee.x+ee.y<=1}static getInterpolation(a,b,c,d,e,f,g,h){return null===this.getBarycoord(a,b,c,d,ee)?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(e,ee.x),h.addScaledVector(f,ee.y),h.addScaledVector(g,ee.z),h)}static getInterpolatedAttribute(a,b,c,d,e,f){return el.setScalar(0),em.setScalar(0),en.setScalar(0),el.fromBufferAttribute(a,b),em.fromBufferAttribute(a,c),en.fromBufferAttribute(a,d),f.setScalar(0),f.addScaledVector(el,e.x),f.addScaledVector(em,e.y),f.addScaledVector(en,e.z),f}static isFrontFacing(a,b,c,d){return eb.subVectors(c,b),ec.subVectors(a,b),0>eb.cross(ec).dot(d)}set(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this}setFromPointsAndIndices(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this}setFromAttributeAndIndices(a,b,c,d){return this.a.fromBufferAttribute(a,b),this.b.fromBufferAttribute(a,c),this.c.fromBufferAttribute(a,d),this}clone(){return new this.constructor().copy(this)}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}getArea(){return eb.subVectors(this.c,this.b),ec.subVectors(this.a,this.b),.5*eb.cross(ec).length()}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return eo.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,b){return eo.getBarycoord(a,this.a,this.b,this.c,b)}getInterpolation(a,b,c,d,e){return eo.getInterpolation(a,this.a,this.b,this.c,b,c,d,e)}containsPoint(a){return eo.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return eo.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,b){let c,d,e=this.a,f=this.b,g=this.c;ef.subVectors(f,e),eg.subVectors(g,e),ei.subVectors(a,e);let h=ef.dot(ei),i=eg.dot(ei);if(h<=0&&i<=0)return b.copy(e);ej.subVectors(a,f);let j=ef.dot(ej),k=eg.dot(ej);if(j>=0&&k<=j)return b.copy(f);let l=h*k-j*i;if(l<=0&&h>=0&&j<=0)return c=h/(h-j),b.copy(e).addScaledVector(ef,c);ek.subVectors(a,g);let m=ef.dot(ek),n=eg.dot(ek);if(n>=0&&m<=n)return b.copy(g);let o=m*i-h*n;if(o<=0&&i>=0&&n<=0)return d=i/(i-n),b.copy(e).addScaledVector(eg,d);let p=j*n-m*k;if(p<=0&&k-j>=0&&m-n>=0)return eh.subVectors(g,f),d=(k-j)/(k-j+(m-n)),b.copy(f).addScaledVector(eh,d);let q=1/(p+o+l);return c=o*q,d=l*q,b.copy(e).addScaledVector(ef,c).addScaledVector(eg,d)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}let ep={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32},eq={h:0,s:0,l:0},er={h:0,s:0,l:0};function es(a,b,c){return(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*6*(2/3-c):a}class et{constructor(a,b,c){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(a,b,c)}set(a,b,c){return void 0===b&&void 0===c?a&&a.isColor?this.copy(a):"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a):this.setRGB(a,b,c),this}setScalar(a){return this.r=a,this.g=a,this.b=a,this}setHex(a,b=bW){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,c_.toWorkingColorSpace(this,b),this}setRGB(a,b,c,d=c_.workingColorSpace){return this.r=a,this.g=b,this.b=c,c_.toWorkingColorSpace(this,d),this}setHSL(a,b,c,d=c_.workingColorSpace){if(a=cH(a,1),b=cG(b,0,1),c=cG(c,0,1),0===b)this.r=this.g=this.b=c;else{let d=c<=.5?c*(1+b):c+b-c*b,e=2*c-d;this.r=es(e,d,a+1/3),this.g=es(e,d,a),this.b=es(e,d,a-1/3)}return c_.toWorkingColorSpace(this,d),this}setStyle(a,b=bW){let c;function d(b){void 0!==b&&1>parseFloat(b)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}if(c=/^(\w+)\(([^\)]*)\)/.exec(a)){let e,f=c[1],g=c[2];switch(f){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setRGB(Math.min(255,parseInt(e[1],10))/255,Math.min(255,parseInt(e[2],10))/255,Math.min(255,parseInt(e[3],10))/255,b);if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setRGB(Math.min(100,parseInt(e[1],10))/100,Math.min(100,parseInt(e[2],10))/100,Math.min(100,parseInt(e[3],10))/100,b);break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setHSL(parseFloat(e[1])/360,parseFloat(e[2])/100,parseFloat(e[3])/100,b);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(c=/^\#([A-Fa-f\d]+)$/.exec(a)){let d=c[1],e=d.length;if(3===e)return this.setRGB(parseInt(d.charAt(0),16)/15,parseInt(d.charAt(1),16)/15,parseInt(d.charAt(2),16)/15,b);if(6===e)return this.setHex(parseInt(d,16),b);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&a.length>0)return this.setColorName(a,b);return this}setColorName(a,b=bW){let c=ep[a.toLowerCase()];return void 0!==c?this.setHex(c,b):console.warn("THREE.Color: Unknown color "+a),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copySRGBToLinear(a){return this.r=c0(a.r),this.g=c0(a.g),this.b=c0(a.b),this}copyLinearToSRGB(a){return this.r=c1(a.r),this.g=c1(a.g),this.b=c1(a.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(a=bW){return c_.fromWorkingColorSpace(eu.copy(this),a),65536*Math.round(cG(255*eu.r,0,255))+256*Math.round(cG(255*eu.g,0,255))+Math.round(cG(255*eu.b,0,255))}getHexString(a=bW){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,b=c_.workingColorSpace){let c,d;c_.fromWorkingColorSpace(eu.copy(this),b);let e=eu.r,f=eu.g,g=eu.b,h=Math.max(e,f,g),i=Math.min(e,f,g),j=(i+h)/2;if(i===h)c=0,d=0;else{let a=h-i;switch(d=j<=.5?a/(h+i):a/(2-h-i),h){case e:c=(f-g)/a+6*(f<g);break;case f:c=(g-e)/a+2;break;case g:c=(e-f)/a+4}c/=6}return a.h=c,a.s=d,a.l=j,a}getRGB(a,b=c_.workingColorSpace){return c_.fromWorkingColorSpace(eu.copy(this),b),a.r=eu.r,a.g=eu.g,a.b=eu.b,a}getStyle(a=bW){c_.fromWorkingColorSpace(eu.copy(this),a);let b=eu.r,c=eu.g,d=eu.b;return a!==bW?`color(${a} ${b.toFixed(3)} ${c.toFixed(3)} ${d.toFixed(3)})`:`rgb(${Math.round(255*b)},${Math.round(255*c)},${Math.round(255*d)})`}offsetHSL(a,b,c){return this.getHSL(eq),this.setHSL(eq.h+a,eq.s+b,eq.l+c)}add(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this}addColors(a,b){return this.r=a.r+b.r,this.g=a.g+b.g,this.b=a.b+b.b,this}addScalar(a){return this.r+=a,this.g+=a,this.b+=a,this}sub(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this}multiply(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this}multiplyScalar(a){return this.r*=a,this.g*=a,this.b*=a,this}lerp(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this}lerpColors(a,b,c){return this.r=a.r+(b.r-a.r)*c,this.g=a.g+(b.g-a.g)*c,this.b=a.b+(b.b-a.b)*c,this}lerpHSL(a,b){this.getHSL(eq),a.getHSL(er);let c=cI(eq.h,er.h,b),d=cI(eq.s,er.s,b),e=cI(eq.l,er.l,b);return this.setHSL(c,d,e),this}setFromVector3(a){return this.r=a.x,this.g=a.y,this.b=a.z,this}applyMatrix3(a){let b=this.r,c=this.g,d=this.b,e=a.elements;return this.r=e[0]*b+e[3]*c+e[6]*d,this.g=e[1]*b+e[4]*c+e[7]*d,this.b=e[2]*b+e[5]*c+e[8]*d,this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,b=0){return this.r=a[b],this.g=a[b+1],this.b=a[b+2],this}toArray(a=[],b=0){return a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a}fromBufferAttribute(a,b){return this.r=a.getX(b),this.g=a.getY(b),this.b=a.getZ(b),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let eu=new et;et.NAMES=ep;let ev=0;class ew extends cA{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ev++}),this.uuid=cF(),this.name="",this.type="Material",this.blending=x,this.side=t,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=L,this.blendDst=M,this.blendEquation=C,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new et(0,0,0),this.blendAlpha=0,this.depthFunc=Z,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=cd,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=b_,this.stencilZFail=b_,this.stencilZPass=b_,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(a){this._alphaTest>0!=a>0&&this.version++,this._alphaTest=a}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(void 0!==a)for(let b in a){let c=a[b];if(void 0===c){console.warn(`THREE.Material: parameter '${b}' has value of undefined.`);continue}let d=this[b];if(void 0===d){console.warn(`THREE.Material: '${b}' is not a property of THREE.${this.type}.`);continue}d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]=c}}toJSON(a){let b=void 0===a||"string"==typeof a;b&&(a={textures:{},images:{}});let c={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function d(a){let b=[];for(let c in a){let d=a[c];delete d.metadata,b.push(d)}return b}if(c.uuid=this.uuid,c.type=this.type,""!==this.name&&(c.name=this.name),this.color&&this.color.isColor&&(c.color=this.color.getHex()),void 0!==this.roughness&&(c.roughness=this.roughness),void 0!==this.metalness&&(c.metalness=this.metalness),void 0!==this.sheen&&(c.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(c.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(c.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(c.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(c.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(c.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(c.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(c.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(c.shininess=this.shininess),void 0!==this.clearcoat&&(c.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(c.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(c.clearcoatMap=this.clearcoatMap.toJSON(a).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(c.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(c.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,c.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(c.dispersion=this.dispersion),void 0!==this.iridescence&&(c.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(c.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(c.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(c.iridescenceMap=this.iridescenceMap.toJSON(a).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(c.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid),void 0!==this.anisotropy&&(c.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(c.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(c.anisotropyMap=this.anisotropyMap.toJSON(a).uuid),this.map&&this.map.isTexture&&(c.map=this.map.toJSON(a).uuid),this.matcap&&this.matcap.isTexture&&(c.matcap=this.matcap.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(c.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(c.lightMap=this.lightMap.toJSON(a).uuid,c.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(c.aoMap=this.aoMap.toJSON(a).uuid,c.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(c.bumpMap=this.bumpMap.toJSON(a).uuid,c.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(c.normalMap=this.normalMap.toJSON(a).uuid,c.normalMapType=this.normalMapType,c.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(c.displacementMap=this.displacementMap.toJSON(a).uuid,c.displacementScale=this.displacementScale,c.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(c.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(c.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(c.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(c.specularMap=this.specularMap.toJSON(a).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(c.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(c.specularColorMap=this.specularColorMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(c.envMap=this.envMap.toJSON(a).uuid,void 0!==this.combine&&(c.combine=this.combine)),void 0!==this.envMapRotation&&(c.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(c.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(c.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(c.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(c.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.transmission&&(c.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(c.transmissionMap=this.transmissionMap.toJSON(a).uuid),void 0!==this.thickness&&(c.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(c.thicknessMap=this.thicknessMap.toJSON(a).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(c.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(c.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(c.size=this.size),null!==this.shadowSide&&(c.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(c.sizeAttenuation=this.sizeAttenuation),this.blending!==x&&(c.blending=this.blending),this.side!==t&&(c.side=this.side),!0===this.vertexColors&&(c.vertexColors=!0),this.opacity<1&&(c.opacity=this.opacity),!0===this.transparent&&(c.transparent=!0),this.blendSrc!==L&&(c.blendSrc=this.blendSrc),this.blendDst!==M&&(c.blendDst=this.blendDst),this.blendEquation!==C&&(c.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(c.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(c.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(c.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(c.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(c.blendAlpha=this.blendAlpha),this.depthFunc!==Z&&(c.depthFunc=this.depthFunc),!1===this.depthTest&&(c.depthTest=this.depthTest),!1===this.depthWrite&&(c.depthWrite=this.depthWrite),!1===this.colorWrite&&(c.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(c.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==cd&&(c.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(c.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(c.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==b_&&(c.stencilFail=this.stencilFail),this.stencilZFail!==b_&&(c.stencilZFail=this.stencilZFail),this.stencilZPass!==b_&&(c.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(c.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(c.rotation=this.rotation),!0===this.polygonOffset&&(c.polygonOffset=!0),0!==this.polygonOffsetFactor&&(c.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(c.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(c.linewidth=this.linewidth),void 0!==this.dashSize&&(c.dashSize=this.dashSize),void 0!==this.gapSize&&(c.gapSize=this.gapSize),void 0!==this.scale&&(c.scale=this.scale),!0===this.dithering&&(c.dithering=!0),this.alphaTest>0&&(c.alphaTest=this.alphaTest),!0===this.alphaHash&&(c.alphaHash=!0),!0===this.alphaToCoverage&&(c.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(c.premultipliedAlpha=!0),!0===this.forceSinglePass&&(c.forceSinglePass=!0),!0===this.wireframe&&(c.wireframe=!0),this.wireframeLinewidth>1&&(c.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(c.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(c.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(c.flatShading=!0),!1===this.visible&&(c.visible=!1),!1===this.toneMapped&&(c.toneMapped=!1),!1===this.fog&&(c.fog=!1),Object.keys(this.userData).length>0&&(c.userData=this.userData),b){let b=d(a.textures),e=d(a.images);b.length>0&&(c.textures=b),e.length>0&&(c.images=e)}return c}clone(){return new this.constructor().copy(this)}copy(a){this.name=a.name,this.blending=a.blending,this.side=a.side,this.vertexColors=a.vertexColors,this.opacity=a.opacity,this.transparent=a.transparent,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.blendColor.copy(a.blendColor),this.blendAlpha=a.blendAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.stencilWriteMask=a.stencilWriteMask,this.stencilFunc=a.stencilFunc,this.stencilRef=a.stencilRef,this.stencilFuncMask=a.stencilFuncMask,this.stencilFail=a.stencilFail,this.stencilZFail=a.stencilZFail,this.stencilZPass=a.stencilZPass,this.stencilWrite=a.stencilWrite;let b=a.clippingPlanes,c=null;if(null!==b){let a=b.length;c=Array(a);for(let d=0;d!==a;++d)c[d]=b[d].clone()}return this.clippingPlanes=c,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.alphaHash=a.alphaHash,this.alphaToCoverage=a.alphaToCoverage,this.premultipliedAlpha=a.premultipliedAlpha,this.forceSinglePass=a.forceSinglePass,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){!0===a&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class ex extends ew{constructor(a){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new et(0xffffff),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dV,this.combine=ac,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}let ey=function(){let a=new ArrayBuffer(4),b=new Float32Array(a),c=new Uint32Array(a),d=new Uint32Array(512),e=new Uint32Array(512);for(let a=0;a<256;++a){let b=a-127;b<-27?(d[a]=0,d[256|a]=32768,e[a]=24,e[256|a]=24):b<-14?(d[a]=1024>>-b-14,d[256|a]=1024>>-b-14|32768,e[a]=-b-1,e[256|a]=-b-1):b<=15?(d[a]=b+15<<10,d[256|a]=b+15<<10|32768,e[a]=13,e[256|a]=13):b<128?(d[a]=31744,d[256|a]=64512,e[a]=24,e[256|a]=24):(d[a]=31744,d[256|a]=64512,e[a]=13,e[256|a]=13)}let f=new Uint32Array(2048),g=new Uint32Array(64),h=new Uint32Array(64);for(let a=1;a<1024;++a){let b=a<<13,c=0;for(;(8388608&b)==0;)b<<=1,c-=8388608;b&=-8388609,c+=0x38800000,f[a]=b|c}for(let a=1024;a<2048;++a)f[a]=0x38000000+(a-1024<<13);for(let a=1;a<31;++a)g[a]=a<<23;g[31]=0x47800000,g[32]=0x80000000;for(let a=33;a<63;++a)g[a]=0x80000000+(a-32<<23);g[63]=0xc7800000;for(let a=1;a<64;++a)32!==a&&(h[a]=1024);return{floatView:b,uint32View:c,baseTable:d,shiftTable:e,mantissaTable:f,exponentTable:g,offsetTable:h}}();function ez(a){Math.abs(a)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),a=cG(a,-65504,65504),ey.floatView[0]=a;let b=ey.uint32View[0],c=b>>23&511;return ey.baseTable[c]+((8388607&b)>>ey.shiftTable[c])}function eA(a){let b=a>>10;return ey.uint32View[0]=ey.mantissaTable[ey.offsetTable[b]+(1023&a)]+ey.exponentTable[b],ey.floatView[0]}let eB={toHalfFloat:ez,fromHalfFloat:eA},eC=new dg,eD=new cM,eE=0;class eF{constructor(a,b,c=!1){if(Array.isArray(a))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:eE++}),this.name="",this.array=a,this.itemSize=b,this.count=void 0!==a?a.length/b:0,this.normalized=c,this.usage=cm,this.updateRanges=[],this.gpuType=aO,this.version=0}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}setUsage(a){return this.usage=a,this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this.gpuType=a.gpuType,this}copyAt(a,b,c){a*=this.itemSize,c*=b.itemSize;for(let d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this}copyArray(a){return this.array.set(a),this}applyMatrix3(a){if(2===this.itemSize)for(let b=0,c=this.count;b<c;b++)eD.fromBufferAttribute(this,b),eD.applyMatrix3(a),this.setXY(b,eD.x,eD.y);else if(3===this.itemSize)for(let b=0,c=this.count;b<c;b++)eC.fromBufferAttribute(this,b),eC.applyMatrix3(a),this.setXYZ(b,eC.x,eC.y,eC.z);return this}applyMatrix4(a){for(let b=0,c=this.count;b<c;b++)eC.fromBufferAttribute(this,b),eC.applyMatrix4(a),this.setXYZ(b,eC.x,eC.y,eC.z);return this}applyNormalMatrix(a){for(let b=0,c=this.count;b<c;b++)eC.fromBufferAttribute(this,b),eC.applyNormalMatrix(a),this.setXYZ(b,eC.x,eC.y,eC.z);return this}transformDirection(a){for(let b=0,c=this.count;b<c;b++)eC.fromBufferAttribute(this,b),eC.transformDirection(a),this.setXYZ(b,eC.x,eC.y,eC.z);return this}set(a,b=0){return this.array.set(a,b),this}getComponent(a,b){let c=this.array[a*this.itemSize+b];return this.normalized&&(c=cJ(c,this.array)),c}setComponent(a,b,c){return this.normalized&&(c=cK(c,this.array)),this.array[a*this.itemSize+b]=c,this}getX(a){let b=this.array[a*this.itemSize];return this.normalized&&(b=cJ(b,this.array)),b}setX(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize]=b,this}getY(a){let b=this.array[a*this.itemSize+1];return this.normalized&&(b=cJ(b,this.array)),b}setY(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize+1]=b,this}getZ(a){let b=this.array[a*this.itemSize+2];return this.normalized&&(b=cJ(b,this.array)),b}setZ(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize+2]=b,this}getW(a){let b=this.array[a*this.itemSize+3];return this.normalized&&(b=cJ(b,this.array)),b}setW(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize+3]=b,this}setXY(a,b,c){return a*=this.itemSize,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array)),this.array[a+0]=b,this.array[a+1]=c,this}setXYZ(a,b,c,d){return a*=this.itemSize,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array),d=cK(d,this.array)),this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this}setXYZW(a,b,c,d,e){return a*=this.itemSize,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array),d=cK(d,this.array),e=cK(e,this.array)),this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this.array[a+3]=e,this}onUpload(a){return this.onUploadCallback=a,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(a.name=this.name),this.usage!==cm&&(a.usage=this.usage),a}}class eG extends eF{constructor(a,b,c){super(new Int8Array(a),b,c)}}class eH extends eF{constructor(a,b,c){super(new Uint8Array(a),b,c)}}class eI extends eF{constructor(a,b,c){super(new Uint8ClampedArray(a),b,c)}}class eJ extends eF{constructor(a,b,c){super(new Int16Array(a),b,c)}}class eK extends eF{constructor(a,b,c){super(new Uint16Array(a),b,c)}}class eL extends eF{constructor(a,b,c){super(new Int32Array(a),b,c)}}class eM extends eF{constructor(a,b,c){super(new Uint32Array(a),b,c)}}class eN extends eF{constructor(a,b,c){super(new Uint16Array(a),b,c),this.isFloat16BufferAttribute=!0}getX(a){let b=eA(this.array[a*this.itemSize]);return this.normalized&&(b=cJ(b,this.array)),b}setX(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize]=ez(b),this}getY(a){let b=eA(this.array[a*this.itemSize+1]);return this.normalized&&(b=cJ(b,this.array)),b}setY(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize+1]=ez(b),this}getZ(a){let b=eA(this.array[a*this.itemSize+2]);return this.normalized&&(b=cJ(b,this.array)),b}setZ(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize+2]=ez(b),this}getW(a){let b=eA(this.array[a*this.itemSize+3]);return this.normalized&&(b=cJ(b,this.array)),b}setW(a,b){return this.normalized&&(b=cK(b,this.array)),this.array[a*this.itemSize+3]=ez(b),this}setXY(a,b,c){return a*=this.itemSize,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array)),this.array[a+0]=ez(b),this.array[a+1]=ez(c),this}setXYZ(a,b,c,d){return a*=this.itemSize,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array),d=cK(d,this.array)),this.array[a+0]=ez(b),this.array[a+1]=ez(c),this.array[a+2]=ez(d),this}setXYZW(a,b,c,d,e){return a*=this.itemSize,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array),d=cK(d,this.array),e=cK(e,this.array)),this.array[a+0]=ez(b),this.array[a+1]=ez(c),this.array[a+2]=ez(d),this.array[a+3]=ez(e),this}}class eO extends eF{constructor(a,b,c){super(new Float32Array(a),b,c)}}let eP=0,eQ=new dL,eR=new ea,eS=new dg,eT=new dj,eU=new dj,eV=new dg;class eW extends cA{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:eP++}),this.uuid=cF(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(a){return Array.isArray(a)?this.index=new(cP(a)?eM:eK)(a,1):this.index=a,this}setIndirect(a){return this.indirect=a,this}getIndirect(){return this.indirect}getAttribute(a){return this.attributes[a]}setAttribute(a,b){return this.attributes[a]=b,this}deleteAttribute(a){return delete this.attributes[a],this}hasAttribute(a){return void 0!==this.attributes[a]}addGroup(a,b,c=0){this.groups.push({start:a,count:b,materialIndex:c})}clearGroups(){this.groups=[]}setDrawRange(a,b){this.drawRange.start=a,this.drawRange.count=b}applyMatrix4(a){let b=this.attributes.position;void 0!==b&&(b.applyMatrix4(a),b.needsUpdate=!0);let c=this.attributes.normal;if(void 0!==c){let b=new cN().getNormalMatrix(a);c.applyNormalMatrix(b),c.needsUpdate=!0}let d=this.attributes.tangent;return void 0!==d&&(d.transformDirection(a),d.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(a){return eQ.makeRotationFromQuaternion(a),this.applyMatrix4(eQ),this}rotateX(a){return eQ.makeRotationX(a),this.applyMatrix4(eQ),this}rotateY(a){return eQ.makeRotationY(a),this.applyMatrix4(eQ),this}rotateZ(a){return eQ.makeRotationZ(a),this.applyMatrix4(eQ),this}translate(a,b,c){return eQ.makeTranslation(a,b,c),this.applyMatrix4(eQ),this}scale(a,b,c){return eQ.makeScale(a,b,c),this.applyMatrix4(eQ),this}lookAt(a){return eR.lookAt(a),eR.updateMatrix(),this.applyMatrix4(eR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(eS).negate(),this.translate(eS.x,eS.y,eS.z),this}setFromPoints(a){let b=this.getAttribute("position");if(void 0===b){let b=[];for(let c=0,d=a.length;c<d;c++){let d=a[c];b.push(d.x,d.y,d.z||0)}this.setAttribute("position",new eO(b,3))}else{let c=Math.min(a.length,b.count);for(let d=0;d<c;d++){let c=a[d];b.setXYZ(d,c.x,c.y,c.z||0)}a.length>b.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),b.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new dj);let a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new dg(-1/0,-1/0,-1/0),new dg(Infinity,Infinity,Infinity));return}if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),b)for(let a=0,c=b.length;a<c;a++){let c=b[a];eT.setFromBufferAttribute(c),this.morphTargetsRelative?(eV.addVectors(this.boundingBox.min,eT.min),this.boundingBox.expandByPoint(eV),eV.addVectors(this.boundingBox.max,eT.max),this.boundingBox.expandByPoint(eV)):(this.boundingBox.expandByPoint(eT.min),this.boundingBox.expandByPoint(eT.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new dC);let a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new dg,1/0);return}if(a){let c=this.boundingSphere.center;if(eT.setFromBufferAttribute(a),b)for(let a=0,c=b.length;a<c;a++){let c=b[a];eU.setFromBufferAttribute(c),this.morphTargetsRelative?(eV.addVectors(eT.min,eU.min),eT.expandByPoint(eV),eV.addVectors(eT.max,eU.max),eT.expandByPoint(eV)):(eT.expandByPoint(eU.min),eT.expandByPoint(eU.max))}eT.getCenter(c);let d=0;for(let b=0,e=a.count;b<e;b++)eV.fromBufferAttribute(a,b),d=Math.max(d,c.distanceToSquared(eV));if(b)for(let e=0,f=b.length;e<f;e++){let f=b[e],g=this.morphTargetsRelative;for(let b=0,e=f.count;b<e;b++)eV.fromBufferAttribute(f,b),g&&(eS.fromBufferAttribute(a,b),eV.add(eS)),d=Math.max(d,c.distanceToSquared(eV))}this.boundingSphere.radius=Math.sqrt(d),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let a=this.index,b=this.attributes;if(null===a||void 0===b.position||void 0===b.normal||void 0===b.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let c=b.position,d=b.normal,e=b.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new eF(new Float32Array(4*c.count),4));let f=this.getAttribute("tangent"),g=[],h=[];for(let a=0;a<c.count;a++)g[a]=new dg,h[a]=new dg;let i=new dg,j=new dg,k=new dg,l=new cM,m=new cM,n=new cM,o=new dg,p=new dg,q=this.groups;0===q.length&&(q=[{start:0,count:a.count}]);for(let b=0,d=q.length;b<d;++b){let d=q[b],f=d.start,r=d.count;for(let b=f,d=f+r;b<d;b+=3)!function(a,b,d){i.fromBufferAttribute(c,a),j.fromBufferAttribute(c,b),k.fromBufferAttribute(c,d),l.fromBufferAttribute(e,a),m.fromBufferAttribute(e,b),n.fromBufferAttribute(e,d),j.sub(i),k.sub(i),m.sub(l),n.sub(l);let f=1/(m.x*n.y-n.x*m.y);isFinite(f)&&(o.copy(j).multiplyScalar(n.y).addScaledVector(k,-m.y).multiplyScalar(f),p.copy(k).multiplyScalar(m.x).addScaledVector(j,-n.x).multiplyScalar(f),g[a].add(o),g[b].add(o),g[d].add(o),h[a].add(p),h[b].add(p),h[d].add(p))}(a.getX(b+0),a.getX(b+1),a.getX(b+2))}let r=new dg,s=new dg,t=new dg,u=new dg;function v(a){t.fromBufferAttribute(d,a),u.copy(t);let b=g[a];r.copy(b),r.sub(t.multiplyScalar(t.dot(b))).normalize(),s.crossVectors(u,b);let c=s.dot(h[a]);f.setXYZW(a,r.x,r.y,r.z,c<0?-1:1)}for(let b=0,c=q.length;b<c;++b){let c=q[b],d=c.start,e=c.count;for(let b=d,c=d+e;b<c;b+=3)v(a.getX(b+0)),v(a.getX(b+1)),v(a.getX(b+2))}}computeVertexNormals(){let a=this.index,b=this.getAttribute("position");if(void 0!==b){let c=this.getAttribute("normal");if(void 0===c)c=new eF(new Float32Array(3*b.count),3),this.setAttribute("normal",c);else for(let a=0,b=c.count;a<b;a++)c.setXYZ(a,0,0,0);let d=new dg,e=new dg,f=new dg,g=new dg,h=new dg,i=new dg,j=new dg,k=new dg;if(a)for(let l=0,m=a.count;l<m;l+=3){let m=a.getX(l+0),n=a.getX(l+1),o=a.getX(l+2);d.fromBufferAttribute(b,m),e.fromBufferAttribute(b,n),f.fromBufferAttribute(b,o),j.subVectors(f,e),k.subVectors(d,e),j.cross(k),g.fromBufferAttribute(c,m),h.fromBufferAttribute(c,n),i.fromBufferAttribute(c,o),g.add(j),h.add(j),i.add(j),c.setXYZ(m,g.x,g.y,g.z),c.setXYZ(n,h.x,h.y,h.z),c.setXYZ(o,i.x,i.y,i.z)}else for(let a=0,g=b.count;a<g;a+=3)d.fromBufferAttribute(b,a+0),e.fromBufferAttribute(b,a+1),f.fromBufferAttribute(b,a+2),j.subVectors(f,e),k.subVectors(d,e),j.cross(k),c.setXYZ(a+0,j.x,j.y,j.z),c.setXYZ(a+1,j.x,j.y,j.z),c.setXYZ(a+2,j.x,j.y,j.z);this.normalizeNormals(),c.needsUpdate=!0}}normalizeNormals(){let a=this.attributes.normal;for(let b=0,c=a.count;b<c;b++)eV.fromBufferAttribute(a,b),eV.normalize(),a.setXYZ(b,eV.x,eV.y,eV.z)}toNonIndexed(){function a(a,b){let c=a.array,d=a.itemSize,e=a.normalized,f=new c.constructor(b.length*d),g=0,h=0;for(let e=0,i=b.length;e<i;e++){g=a.isInterleavedBufferAttribute?b[e]*a.data.stride+a.offset:b[e]*d;for(let a=0;a<d;a++)f[h++]=c[g++]}return new eF(f,d,e)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let b=new eW,c=this.index.array,d=this.attributes;for(let e in d){let f=a(d[e],c);b.setAttribute(e,f)}let e=this.morphAttributes;for(let d in e){let f=[],g=e[d];for(let b=0,d=g.length;b<d;b++){let d=a(g[b],c);f.push(d)}b.morphAttributes[d]=f}b.morphTargetsRelative=this.morphTargetsRelative;let f=this.groups;for(let a=0,c=f.length;a<c;a++){let c=f[a];b.addGroup(c.start,c.count,c.materialIndex)}return b}toJSON(){let a={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),void 0!==this.parameters){let b=this.parameters;for(let c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data={attributes:{}};let b=this.index;null!==b&&(a.data.index={type:b.array.constructor.name,array:Array.prototype.slice.call(b.array)});let c=this.attributes;for(let b in c){let d=c[b];a.data.attributes[b]=d.toJSON(a.data)}let d={},e=!1;for(let b in this.morphAttributes){let c=this.morphAttributes[b],f=[];for(let b=0,d=c.length;b<d;b++){let d=c[b];f.push(d.toJSON(a.data))}f.length>0&&(d[b]=f,e=!0)}e&&(a.data.morphAttributes=d,a.data.morphTargetsRelative=this.morphTargetsRelative);let f=this.groups;f.length>0&&(a.data.groups=JSON.parse(JSON.stringify(f)));let g=this.boundingSphere;return null!==g&&(a.data.boundingSphere={center:g.center.toArray(),radius:g.radius}),a}clone(){return new this.constructor().copy(this)}copy(a){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let b={};this.name=a.name;let c=a.index;null!==c&&this.setIndex(c.clone(b));let d=a.attributes;for(let a in d){let c=d[a];this.setAttribute(a,c.clone(b))}let e=a.morphAttributes;for(let a in e){let c=[],d=e[a];for(let a=0,e=d.length;a<e;a++)c.push(d[a].clone(b));this.morphAttributes[a]=c}this.morphTargetsRelative=a.morphTargetsRelative;let f=a.groups;for(let a=0,b=f.length;a<b;a++){let b=f[a];this.addGroup(b.start,b.count,b.materialIndex)}let g=a.boundingBox;null!==g&&(this.boundingBox=g.clone());let h=a.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let eX=new dL,eY=new dK,eZ=new dC,e$=new dg,e_=new dg,e0=new dg,e1=new dg,e2=new dg,e3=new dg,e4=new dg,e5=new dg;class e6 extends ea{constructor(a=new eW,b=new ex){super(),this.isMesh=!0,this.type="Mesh",this.geometry=a,this.material=b,this.updateMorphTargets()}copy(a,b){return super.copy(a,b),void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}updateMorphTargets(){let a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0){let c=a[b[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,b=c.length;a<b;a++){let b=c[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=a}}}}getVertexPosition(a,b){let c=this.geometry,d=c.attributes.position,e=c.morphAttributes.position,f=c.morphTargetsRelative;b.fromBufferAttribute(d,a);let g=this.morphTargetInfluences;if(e&&g){e3.set(0,0,0);for(let c=0,d=e.length;c<d;c++){let d=g[c],h=e[c];0!==d&&(e2.fromBufferAttribute(h,a),f?e3.addScaledVector(e2,d):e3.addScaledVector(e2.sub(b),d))}b.add(e3)}return b}raycast(a,b){let c=this.geometry,d=this.material,e=this.matrixWorld;if(void 0!==d)null===c.boundingSphere&&c.computeBoundingSphere(),eZ.copy(c.boundingSphere),eZ.applyMatrix4(e),eY.copy(a.ray).recast(a.near),!1===eZ.containsPoint(eY.origin)&&(null===eY.intersectSphere(eZ,e$)||eY.origin.distanceToSquared(e$)>(a.far-a.near)**2)||(eX.copy(e).invert(),eY.copy(a.ray).applyMatrix4(eX),(null===c.boundingBox||!1!==eY.intersectsBox(c.boundingBox))&&this._computeIntersections(a,b,eY))}_computeIntersections(a,b,c){let d,e=this.geometry,f=this.material,g=e.index,h=e.attributes.position,i=e.attributes.uv,j=e.attributes.uv1,k=e.attributes.normal,l=e.groups,m=e.drawRange;if(null!==g)if(Array.isArray(f))for(let e=0,h=l.length;e<h;e++){let h=l[e],n=f[h.materialIndex],o=Math.max(h.start,m.start),p=Math.min(g.count,Math.min(h.start+h.count,m.start+m.count));for(let e=o;e<p;e+=3){let f=g.getX(e);(d=e7(this,n,a,c,i,j,k,f,g.getX(e+1),g.getX(e+2)))&&(d.faceIndex=Math.floor(e/3),d.face.materialIndex=h.materialIndex,b.push(d))}}else{let e=Math.max(0,m.start),h=Math.min(g.count,m.start+m.count);for(let l=e;l<h;l+=3){let e=g.getX(l);(d=e7(this,f,a,c,i,j,k,e,g.getX(l+1),g.getX(l+2)))&&(d.faceIndex=Math.floor(l/3),b.push(d))}}else if(void 0!==h)if(Array.isArray(f))for(let e=0,g=l.length;e<g;e++){let g=l[e],n=f[g.materialIndex],o=Math.max(g.start,m.start),p=Math.min(h.count,Math.min(g.start+g.count,m.start+m.count));for(let e=o;e<p;e+=3)(d=e7(this,n,a,c,i,j,k,e,e+1,e+2))&&(d.faceIndex=Math.floor(e/3),d.face.materialIndex=g.materialIndex,b.push(d))}else{let e=Math.max(0,m.start),g=Math.min(h.count,m.start+m.count);for(let h=e;h<g;h+=3)(d=e7(this,f,a,c,i,j,k,h,h+1,h+2))&&(d.faceIndex=Math.floor(h/3),b.push(d))}}}function e7(a,b,c,d,e,f,g,h,i,j){a.getVertexPosition(h,e_),a.getVertexPosition(i,e0),a.getVertexPosition(j,e1);let k=function(a,b,c,d,e,f,g,h){if(null===(b.side===u?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,b.side===t,h)))return null;e5.copy(h),e5.applyMatrix4(a.matrixWorld);let i=c.ray.origin.distanceTo(e5);return i<c.near||i>c.far?null:{distance:i,point:e5.clone(),object:a}}(a,b,c,d,e_,e0,e1,e4);if(k){let a=new dg;eo.getBarycoord(e4,e_,e0,e1,a),e&&(k.uv=eo.getInterpolatedAttribute(e,h,i,j,a,new cM)),f&&(k.uv1=eo.getInterpolatedAttribute(f,h,i,j,a,new cM)),g&&(k.normal=eo.getInterpolatedAttribute(g,h,i,j,a,new dg),k.normal.dot(d.direction)>0&&k.normal.multiplyScalar(-1));let b={a:h,b:i,c:j,normal:new dg,materialIndex:0};eo.getNormal(e_,e0,e1,b.normal),k.face=b,k.barycoord=a}return k}class e8 extends eW{constructor(a=1,b=1,c=1,d=1,e=1,f=1){super(),this.type="BoxGeometry",this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};let g=this;d=Math.floor(d),e=Math.floor(e);let h=[],i=[],j=[],k=[],l=0,m=0;function n(a,b,c,d,e,f,n,o,p,q,r){let s=f/p,t=n/q,u=f/2,v=n/2,w=o/2,x=p+1,y=q+1,z=0,A=0,B=new dg;for(let f=0;f<y;f++){let g=f*t-v;for(let h=0;h<x;h++){let l=h*s-u;B[a]=l*d,B[b]=g*e,B[c]=w,i.push(B.x,B.y,B.z),B[a]=0,B[b]=0,B[c]=o>0?1:-1,j.push(B.x,B.y,B.z),k.push(h/p),k.push(1-f/q),z+=1}}for(let a=0;a<q;a++)for(let b=0;b<p;b++){let c=l+b+x*a,d=l+b+x*(a+1),e=l+(b+1)+x*(a+1),f=l+(b+1)+x*a;h.push(c,d,f),h.push(d,e,f),A+=6}g.addGroup(m,A,r),m+=A,l+=z}n("z","y","x",-1,-1,c,b,a,f=Math.floor(f),e,0),n("z","y","x",1,-1,c,b,-a,f,e,1),n("x","z","y",1,1,a,c,b,d,f,2),n("x","z","y",1,-1,a,c,-b,d,f,3),n("x","y","z",1,-1,a,b,c,d,e,4),n("x","y","z",-1,-1,a,b,-c,d,e,5),this.setIndex(h),this.setAttribute("position",new eO(i,3)),this.setAttribute("normal",new eO(j,3)),this.setAttribute("uv",new eO(k,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new e8(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)}}function e9(a){let b={};for(let c in a)for(let d in b[c]={},a[c]){let e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||e.isVector4||e.isTexture||e.isQuaternion)?e.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),b[c][d]=null):b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}return b}function fa(a){let b={};for(let c=0;c<a.length;c++){let d=e9(a[c]);for(let a in d)b[a]=d[a]}return b}function fb(a){let b=a.getRenderTarget();return null===b?a.outputColorSpace:!0===b.isXRRenderTarget?b.texture.colorSpace:c_.workingColorSpace}let fc={clone:e9,merge:fa};class fd extends ew{constructor(a){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==a&&this.setValues(a)}copy(a){return super.copy(a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=e9(a.uniforms),this.uniformsGroups=function(a){let b=[];for(let c=0;c<a.length;c++)b.push(a[c].clone());return b}(a.uniformsGroups),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.fog=a.fog,this.lights=a.lights,this.clipping=a.clipping,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this}toJSON(a){let b=super.toJSON(a);for(let c in b.glslVersion=this.glslVersion,b.uniforms={},this.uniforms){let d=this.uniforms[c].value;d&&d.isTexture?b.uniforms[c]={type:"t",value:d.toJSON(a).uuid}:d&&d.isColor?b.uniforms[c]={type:"c",value:d.getHex()}:d&&d.isVector2?b.uniforms[c]={type:"v2",value:d.toArray()}:d&&d.isVector3?b.uniforms[c]={type:"v3",value:d.toArray()}:d&&d.isVector4?b.uniforms[c]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?b.uniforms[c]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?b.uniforms[c]={type:"m4",value:d.toArray()}:b.uniforms[c]={value:d}}Object.keys(this.defines).length>0&&(b.defines=this.defines),b.vertexShader=this.vertexShader,b.fragmentShader=this.fragmentShader,b.lights=this.lights,b.clipping=this.clipping;let c={};for(let a in this.extensions)!0===this.extensions[a]&&(c[a]=!0);return Object.keys(c).length>0&&(b.extensions=c),b}}class fe extends ea{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new dL,this.projectionMatrix=new dL,this.projectionMatrixInverse=new dL,this.coordinateSystem=cx}copy(a,b){return super.copy(a,b),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this.coordinateSystem=a.coordinateSystem,this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,b){super.updateWorldMatrix(a,b),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let ff=new dg,fg=new cM,fh=new cM;class fi extends fe{constructor(a=50,b=1,c=.1,d=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=c,this.far=d,this.focus=10,this.aspect=b,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(a,b){return super.copy(a,b),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this}setFocalLength(a){let b=.5*this.getFilmHeight()/a;this.fov=2*cE*Math.atan(b),this.updateProjectionMatrix()}getFocalLength(){let a=Math.tan(.5*cD*this.fov);return .5*this.getFilmHeight()/a}getEffectiveFOV(){return 2*cE*Math.atan(Math.tan(.5*cD*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,b,c){ff.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),b.set(ff.x,ff.y).multiplyScalar(-a/ff.z),ff.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),c.set(ff.x,ff.y).multiplyScalar(-a/ff.z)}getViewSize(a,b){return this.getViewBounds(a,fg,fh),b.subVectors(fh,fg)}setViewOffset(a,b,c,d,e,f){this.aspect=a/b,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=b,this.view.offsetX=c,this.view.offsetY=d,this.view.width=e,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let a=this.near,b=a*Math.tan(.5*cD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,f=this.view;if(null!==this.view&&this.view.enabled){let a=f.fullWidth,g=f.fullHeight;e+=f.offsetX*d/a,b-=f.offsetY*c/g,d*=f.width/a,c*=f.height/g}let g=this.filmOffset;0!==g&&(e+=a*g/this.getFilmWidth()),this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){let b=super.toJSON(a);return b.object.fov=this.fov,b.object.zoom=this.zoom,b.object.near=this.near,b.object.far=this.far,b.object.focus=this.focus,b.object.aspect=this.aspect,null!==this.view&&(b.object.view=Object.assign({},this.view)),b.object.filmGauge=this.filmGauge,b.object.filmOffset=this.filmOffset,b}}class fj extends ea{constructor(a,b,c){super(),this.type="CubeCamera",this.renderTarget=c,this.coordinateSystem=null,this.activeMipmapLevel=0;let d=new fi(-90,1,a,b);d.layers=this.layers,this.add(d);let e=new fi(-90,1,a,b);e.layers=this.layers,this.add(e);let f=new fi(-90,1,a,b);f.layers=this.layers,this.add(f);let g=new fi(-90,1,a,b);g.layers=this.layers,this.add(g);let h=new fi(-90,1,a,b);h.layers=this.layers,this.add(h);let i=new fi(-90,1,a,b);i.layers=this.layers,this.add(i)}updateCoordinateSystem(){let a=this.coordinateSystem,b=this.children.concat(),[c,d,e,f,g,h]=b;for(let a of b)this.remove(a);if(a===cx)c.up.set(0,1,0),c.lookAt(1,0,0),d.up.set(0,1,0),d.lookAt(-1,0,0),e.up.set(0,0,-1),e.lookAt(0,1,0),f.up.set(0,0,1),f.lookAt(0,-1,0),g.up.set(0,1,0),g.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(a===cy)c.up.set(0,-1,0),c.lookAt(-1,0,0),d.up.set(0,-1,0),d.lookAt(1,0,0),e.up.set(0,0,1),e.lookAt(0,1,0),f.up.set(0,0,-1),f.lookAt(0,-1,0),g.up.set(0,-1,0),g.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);for(let a of b)this.add(a),a.updateMatrixWorld()}update(a,b){null===this.parent&&this.updateMatrixWorld();let{renderTarget:c,activeMipmapLevel:d}=this;this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());let[e,f,g,h,i,j]=this.children,k=a.getRenderTarget(),l=a.getActiveCubeFace(),m=a.getActiveMipmapLevel(),n=a.xr.enabled;a.xr.enabled=!1;let o=c.texture.generateMipmaps;c.texture.generateMipmaps=!1,a.setRenderTarget(c,0,d),a.render(b,e),a.setRenderTarget(c,1,d),a.render(b,f),a.setRenderTarget(c,2,d),a.render(b,g),a.setRenderTarget(c,3,d),a.render(b,h),a.setRenderTarget(c,4,d),a.render(b,i),c.texture.generateMipmaps=o,a.setRenderTarget(c,5,d),a.render(b,j),a.setRenderTarget(k,l,m),a.xr.enabled=n,c.texture.needsPMREMUpdate=!0}}class fk extends c7{constructor(a,b,c,d,e,f,g,h,i,j){super(a=void 0!==a?a:[],b=void 0!==b?b:aq,c,d,e,f,g,h,i,j),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class fl extends da{constructor(a=1,b={}){super(a,a,b),this.isWebGLCubeRenderTarget=!0;let c={width:a,height:a,depth:1};this.texture=new fk([c,c,c,c,c,c],b.mapping,b.wrapS,b.wrapT,b.magFilter,b.minFilter,b.format,b.type,b.anisotropy,b.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==b.generateMipmaps&&b.generateMipmaps,this.texture.minFilter=void 0!==b.minFilter?b.minFilter:aD}fromEquirectangularTexture(a,b){this.texture.type=b.type,this.texture.colorSpace=b.colorSpace,this.texture.generateMipmaps=b.generateMipmaps,this.texture.minFilter=b.minFilter,this.texture.magFilter=b.magFilter;let c={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},d=new e8(5,5,5),e=new fd({name:"CubemapFromEquirect",uniforms:e9(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,side:u,blending:w});e.uniforms.tEquirect.value=b;let f=new e6(d,e),g=b.minFilter;return b.minFilter===aG&&(b.minFilter=aD),new fj(1,10,this).update(a,f),b.minFilter=g,f.geometry.dispose(),f.material.dispose(),this}clear(a,b,c,d){let e=a.getRenderTarget();for(let e=0;e<6;e++)a.setRenderTarget(this,e),a.clear(b,c,d);a.setRenderTarget(e)}}class fm extends ea{constructor(){super(),this.isGroup=!0,this.type="Group"}}let fn={type:"move"};class fo{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new fm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new fm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new dg,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new dg),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new fm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new dg,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new dg),this._grip}dispatchEvent(a){return null!==this._targetRay&&this._targetRay.dispatchEvent(a),null!==this._grip&&this._grip.dispatchEvent(a),null!==this._hand&&this._hand.dispatchEvent(a),this}connect(a){if(a&&a.hand){let b=this._hand;if(b)for(let c of a.hand.values())this._getHandJoint(b,c)}return this.dispatchEvent({type:"connected",data:a}),this}disconnect(a){return this.dispatchEvent({type:"disconnected",data:a}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(a,b,c){let d=null,e=null,f=null,g=this._targetRay,h=this._grip,i=this._hand;if(a&&"visible-blurred"!==b.session.visibilityState){if(i&&a.hand){for(let d of(f=!0,a.hand.values())){let a=b.getJointPose(d,c),e=this._getHandJoint(i,d);null!==a&&(e.matrix.fromArray(a.transform.matrix),e.matrix.decompose(e.position,e.rotation,e.scale),e.matrixWorldNeedsUpdate=!0,e.jointRadius=a.radius),e.visible=null!==a}let d=i.joints["index-finger-tip"],e=i.joints["thumb-tip"],g=d.position.distanceTo(e.position);i.inputState.pinching&&g>.025?(i.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!i.inputState.pinching&&g<=.015&&(i.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else null!==h&&a.gripSpace&&null!==(e=b.getPose(a.gripSpace,c))&&(h.matrix.fromArray(e.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,e.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(e.linearVelocity)):h.hasLinearVelocity=!1,e.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(e.angularVelocity)):h.hasAngularVelocity=!1);null!==g&&(null===(d=b.getPose(a.targetRaySpace,c))&&null!==e&&(d=e),null!==d&&(g.matrix.fromArray(d.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,d.linearVelocity?(g.hasLinearVelocity=!0,g.linearVelocity.copy(d.linearVelocity)):g.hasLinearVelocity=!1,d.angularVelocity?(g.hasAngularVelocity=!0,g.angularVelocity.copy(d.angularVelocity)):g.hasAngularVelocity=!1,this.dispatchEvent(fn)))}return null!==g&&(g.visible=null!==d),null!==h&&(h.visible=null!==e),null!==i&&(i.visible=null!==f),this}_getHandJoint(a,b){if(void 0===a.joints[b.jointName]){let c=new fm;c.matrixAutoUpdate=!1,c.visible=!1,a.joints[b.jointName]=c,a.add(c)}return a.joints[b.jointName]}}class fp{constructor(a,b=25e-5){this.isFogExp2=!0,this.name="",this.color=new et(a),this.density=b}clone(){return new fp(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class fq{constructor(a,b=1,c=1e3){this.isFog=!0,this.name="",this.color=new et(a),this.near=b,this.far=c}clone(){return new fq(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class fr extends ea{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new dV,this.environmentIntensity=1,this.environmentRotation=new dV,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,b){return super.copy(a,b),null!==a.background&&(this.background=a.background.clone()),null!==a.environment&&(this.environment=a.environment.clone()),null!==a.fog&&(this.fog=a.fog.clone()),this.backgroundBlurriness=a.backgroundBlurriness,this.backgroundIntensity=a.backgroundIntensity,this.backgroundRotation.copy(a.backgroundRotation),this.environmentIntensity=a.environmentIntensity,this.environmentRotation.copy(a.environmentRotation),null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone()),this.matrixAutoUpdate=a.matrixAutoUpdate,this}toJSON(a){let b=super.toJSON(a);return null!==this.fog&&(b.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(b.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(b.object.backgroundIntensity=this.backgroundIntensity),b.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(b.object.environmentIntensity=this.environmentIntensity),b.object.environmentRotation=this.environmentRotation.toArray(),b}}class fs{constructor(a,b){this.isInterleavedBuffer=!0,this.array=a,this.stride=b,this.count=void 0!==a?a.length/b:0,this.usage=cm,this.updateRanges=[],this.version=0,this.uuid=cF()}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}setUsage(a){return this.usage=a,this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.array=new a.array.constructor(a.array),this.count=a.count,this.stride=a.stride,this.usage=a.usage,this}copyAt(a,b,c){a*=this.stride,c*=b.stride;for(let d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this}set(a,b=0){return this.array.set(a,b),this}clone(a){void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cF()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let b=new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]),c=new this.constructor(b,this.stride);return c.setUsage(this.usage),c}onUpload(a){return this.onUploadCallback=a,this}toJSON(a){return void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cF()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}let ft=new dg;class fu{constructor(a,b,c,d=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=a,this.itemSize=b,this.offset=c,this.normalized=d}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(a){this.data.needsUpdate=a}applyMatrix4(a){for(let b=0,c=this.data.count;b<c;b++)ft.fromBufferAttribute(this,b),ft.applyMatrix4(a),this.setXYZ(b,ft.x,ft.y,ft.z);return this}applyNormalMatrix(a){for(let b=0,c=this.count;b<c;b++)ft.fromBufferAttribute(this,b),ft.applyNormalMatrix(a),this.setXYZ(b,ft.x,ft.y,ft.z);return this}transformDirection(a){for(let b=0,c=this.count;b<c;b++)ft.fromBufferAttribute(this,b),ft.transformDirection(a),this.setXYZ(b,ft.x,ft.y,ft.z);return this}getComponent(a,b){let c=this.array[a*this.data.stride+this.offset+b];return this.normalized&&(c=cJ(c,this.array)),c}setComponent(a,b,c){return this.normalized&&(c=cK(c,this.array)),this.data.array[a*this.data.stride+this.offset+b]=c,this}setX(a,b){return this.normalized&&(b=cK(b,this.array)),this.data.array[a*this.data.stride+this.offset]=b,this}setY(a,b){return this.normalized&&(b=cK(b,this.array)),this.data.array[a*this.data.stride+this.offset+1]=b,this}setZ(a,b){return this.normalized&&(b=cK(b,this.array)),this.data.array[a*this.data.stride+this.offset+2]=b,this}setW(a,b){return this.normalized&&(b=cK(b,this.array)),this.data.array[a*this.data.stride+this.offset+3]=b,this}getX(a){let b=this.data.array[a*this.data.stride+this.offset];return this.normalized&&(b=cJ(b,this.array)),b}getY(a){let b=this.data.array[a*this.data.stride+this.offset+1];return this.normalized&&(b=cJ(b,this.array)),b}getZ(a){let b=this.data.array[a*this.data.stride+this.offset+2];return this.normalized&&(b=cJ(b,this.array)),b}getW(a){let b=this.data.array[a*this.data.stride+this.offset+3];return this.normalized&&(b=cJ(b,this.array)),b}setXY(a,b,c){return a=a*this.data.stride+this.offset,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array)),this.data.array[a+0]=b,this.data.array[a+1]=c,this}setXYZ(a,b,c,d){return a=a*this.data.stride+this.offset,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array),d=cK(d,this.array)),this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this}setXYZW(a,b,c,d,e){return a=a*this.data.stride+this.offset,this.normalized&&(b=cK(b,this.array),c=cK(c,this.array),d=cK(d,this.array),e=cK(e,this.array)),this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this.data.array[a+3]=e,this}clone(a){if(void 0!==a)return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a)),new fu(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let b=0;b<this.count;b++){let c=b*this.data.stride+this.offset;for(let b=0;b<this.itemSize;b++)a.push(this.data.array[c+b])}return new eF(new this.array.constructor(a),this.itemSize,this.normalized)}}toJSON(a){if(void 0!==a)return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let b=0;b<this.count;b++){let c=b*this.data.stride+this.offset;for(let b=0;b<this.itemSize;b++)a.push(this.data.array[c+b])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}}}class fv extends ew{constructor(a){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new et(0xffffff),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}let fw=new dg,fx=new dg,fy=new dg,fz=new cM,fA=new cM,fB=new dL,fC=new dg,fD=new dg,fE=new dg,fF=new cM,fG=new cM,fH=new cM;class fI extends ea{constructor(a=new fv){if(super(),this.isSprite=!0,this.type="Sprite",void 0===e){e=new eW;let a=new fs(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);e.setIndex([0,1,2,0,2,3]),e.setAttribute("position",new fu(a,3,0,!1)),e.setAttribute("uv",new fu(a,2,3,!1))}this.geometry=e,this.material=a,this.center=new cM(.5,.5)}raycast(a,b){let c,d;null===a.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),fx.setFromMatrixScale(this.matrixWorld),fB.copy(a.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld),fy.setFromMatrixPosition(this.modelViewMatrix),a.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&fx.multiplyScalar(-fy.z);let e=this.material.rotation;0!==e&&(d=Math.cos(e),c=Math.sin(e));let f=this.center;fJ(fC.set(-.5,-.5,0),fy,f,fx,c,d),fJ(fD.set(.5,-.5,0),fy,f,fx,c,d),fJ(fE.set(.5,.5,0),fy,f,fx,c,d),fF.set(0,0),fG.set(1,0),fH.set(1,1);let g=a.ray.intersectTriangle(fC,fD,fE,!1,fw);if(null===g&&(fJ(fD.set(-.5,.5,0),fy,f,fx,c,d),fG.set(0,1),null===(g=a.ray.intersectTriangle(fC,fE,fD,!1,fw))))return;let h=a.ray.origin.distanceTo(fw);h<a.near||h>a.far||b.push({distance:h,point:fw.clone(),uv:eo.getInterpolation(fw,fC,fD,fE,fF,fG,fH,new cM),face:null,object:this})}copy(a,b){return super.copy(a,b),void 0!==a.center&&this.center.copy(a.center),this.material=a.material,this}}function fJ(a,b,c,d,e,f){fz.subVectors(a,c).addScalar(.5).multiply(d),void 0!==e?(fA.x=f*fz.x-e*fz.y,fA.y=e*fz.x+f*fz.y):fA.copy(fz),a.copy(b),a.x+=fA.x,a.y+=fA.y,a.applyMatrix4(fB)}let fK=new dg,fL=new dg;class fM extends ea{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(a){super.copy(a,!1);let b=a.levels;for(let a=0,c=b.length;a<c;a++){let c=b[a];this.addLevel(c.object.clone(),c.distance,c.hysteresis)}return this.autoUpdate=a.autoUpdate,this}addLevel(a,b=0,c=0){let d;b=Math.abs(b);let e=this.levels;for(d=0;d<e.length&&!(b<e[d].distance);d++);return e.splice(d,0,{distance:b,hysteresis:c,object:a}),this.add(a),this}removeLevel(a){let b=this.levels;for(let c=0;c<b.length;c++)if(b[c].distance===a){let a=b.splice(c,1);return this.remove(a[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(a){let b=this.levels;if(b.length>0){let c,d;for(c=1,d=b.length;c<d;c++){let d=b[c].distance;if(b[c].object.visible&&(d-=d*b[c].hysteresis),a<d)break}return b[c-1].object}return null}raycast(a,b){if(this.levels.length>0){fK.setFromMatrixPosition(this.matrixWorld);let c=a.ray.origin.distanceTo(fK);this.getObjectForDistance(c).raycast(a,b)}}update(a){let b=this.levels;if(b.length>1){let c,d;fK.setFromMatrixPosition(a.matrixWorld),fL.setFromMatrixPosition(this.matrixWorld);let e=fK.distanceTo(fL)/a.zoom;for(c=1,b[0].object.visible=!0,d=b.length;c<d;c++){let a=b[c].distance;if(b[c].object.visible&&(a-=a*b[c].hysteresis),e>=a)b[c-1].object.visible=!1,b[c].object.visible=!0;else break}for(this._currentLevel=c-1;c<d;c++)b[c].object.visible=!1}}toJSON(a){let b=super.toJSON(a);!1===this.autoUpdate&&(b.object.autoUpdate=!1),b.object.levels=[];let c=this.levels;for(let a=0,d=c.length;a<d;a++){let d=c[a];b.object.levels.push({object:d.object.uuid,distance:d.distance,hysteresis:d.hysteresis})}return b}}let fN=new dg,fO=new c8,fP=new c8,fQ=new dg,fR=new dL,fS=new dg,fT=new dC,fU=new dL,fV=new dK;class fW extends e6{constructor(a,b){super(a,b),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=an,this.bindMatrix=new dL,this.bindMatrixInverse=new dL,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let a=this.geometry;null===this.boundingBox&&(this.boundingBox=new dj),this.boundingBox.makeEmpty();let b=a.getAttribute("position");for(let a=0;a<b.count;a++)this.getVertexPosition(a,fS),this.boundingBox.expandByPoint(fS)}computeBoundingSphere(){let a=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new dC),this.boundingSphere.makeEmpty();let b=a.getAttribute("position");for(let a=0;a<b.count;a++)this.getVertexPosition(a,fS),this.boundingSphere.expandByPoint(fS)}copy(a,b){return super.copy(a,b),this.bindMode=a.bindMode,this.bindMatrix.copy(a.bindMatrix),this.bindMatrixInverse.copy(a.bindMatrixInverse),this.skeleton=a.skeleton,null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),this}raycast(a,b){let c=this.material,d=this.matrixWorld;if(void 0!==c)null===this.boundingSphere&&this.computeBoundingSphere(),fT.copy(this.boundingSphere),fT.applyMatrix4(d),!1!==a.ray.intersectsSphere(fT)&&(fU.copy(d).invert(),fV.copy(a.ray).applyMatrix4(fU),(null===this.boundingBox||!1!==fV.intersectsBox(this.boundingBox))&&this._computeIntersections(a,b,fV))}getVertexPosition(a,b){return super.getVertexPosition(a,b),this.applyBoneTransform(a,b),b}bind(a,b){this.skeleton=a,void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld),this.bindMatrix.copy(b),this.bindMatrixInverse.copy(b).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let a=new c8,b=this.geometry.attributes.skinWeight;for(let c=0,d=b.count;c<d;c++){a.fromBufferAttribute(b,c);let d=1/a.manhattanLength();d!==1/0?a.multiplyScalar(d):a.set(1,0,0,0),b.setXYZW(c,a.x,a.y,a.z,a.w)}}updateMatrixWorld(a){super.updateMatrixWorld(a),this.bindMode===an?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===ao?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(a,b){let c=this.skeleton,d=this.geometry;fO.fromBufferAttribute(d.attributes.skinIndex,a),fP.fromBufferAttribute(d.attributes.skinWeight,a),fN.copy(b).applyMatrix4(this.bindMatrix),b.set(0,0,0);for(let a=0;a<4;a++){let d=fP.getComponent(a);if(0!==d){let e=fO.getComponent(a);fR.multiplyMatrices(c.bones[e].matrixWorld,c.boneInverses[e]),b.addScaledVector(fQ.copy(fN).applyMatrix4(fR),d)}}return b.applyMatrix4(this.bindMatrixInverse)}}class fX extends ea{constructor(){super(),this.isBone=!0,this.type="Bone"}}class fY extends c7{constructor(a=null,b=1,c=1,d,e,f,g,h,i=ay,j=ay,k,l){super(null,f,g,h,i,j,d,e,k,l),this.isDataTexture=!0,this.image={data:a,width:b,height:c},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let fZ=new dL,f$=new dL;class f_{constructor(a=[],b=[]){this.uuid=cF(),this.bones=a.slice(0),this.boneInverses=b,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let a=this.bones,b=this.boneInverses;if(this.boneMatrices=new Float32Array(16*a.length),0===b.length)this.calculateInverses();else if(a.length!==b.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new dL)}}calculateInverses(){this.boneInverses.length=0;for(let a=0,b=this.bones.length;a<b;a++){let b=new dL;this.bones[a]&&b.copy(this.bones[a].matrixWorld).invert(),this.boneInverses.push(b)}}pose(){for(let a=0,b=this.bones.length;a<b;a++){let b=this.bones[a];b&&b.matrixWorld.copy(this.boneInverses[a]).invert()}for(let a=0,b=this.bones.length;a<b;a++){let b=this.bones[a];b&&(b.parent&&b.parent.isBone?(b.matrix.copy(b.parent.matrixWorld).invert(),b.matrix.multiply(b.matrixWorld)):b.matrix.copy(b.matrixWorld),b.matrix.decompose(b.position,b.quaternion,b.scale))}}update(){let a=this.bones,b=this.boneInverses,c=this.boneMatrices,d=this.boneTexture;for(let d=0,e=a.length;d<e;d++){let e=a[d]?a[d].matrixWorld:f$;fZ.multiplyMatrices(e,b[d]),fZ.toArray(c,16*d)}null!==d&&(d.needsUpdate=!0)}clone(){return new f_(this.bones,this.boneInverses)}computeBoneTexture(){let a=Math.sqrt(4*this.bones.length),b=new Float32Array((a=Math.max(a=4*Math.ceil(a/4),4))*a*4);b.set(this.boneMatrices);let c=new fY(b,a,a,aW,aO);return c.needsUpdate=!0,this.boneMatrices=b,this.boneTexture=c,this}getBoneByName(a){for(let b=0,c=this.bones.length;b<c;b++){let c=this.bones[b];if(c.name===a)return c}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(a,b){this.uuid=a.uuid;for(let c=0,d=a.bones.length;c<d;c++){let d=a.bones[c],e=b[d];void 0===e&&(console.warn("THREE.Skeleton: No bone found with UUID:",d),e=new fX),this.bones.push(e),this.boneInverses.push(new dL().fromArray(a.boneInverses[c]))}return this.init(),this}toJSON(){let a={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};a.uuid=this.uuid;let b=this.bones,c=this.boneInverses;for(let d=0,e=b.length;d<e;d++){let e=b[d];a.bones.push(e.uuid);let f=c[d];a.boneInverses.push(f.toArray())}return a}}class f0 extends eF{constructor(a,b,c,d=1){super(a,b,c),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=d}copy(a){return super.copy(a),this.meshPerAttribute=a.meshPerAttribute,this}toJSON(){let a=super.toJSON();return a.meshPerAttribute=this.meshPerAttribute,a.isInstancedBufferAttribute=!0,a}}let f1=new dL,f2=new dL,f3=[],f4=new dj,f5=new dL,f6=new e6,f7=new dC;class f8 extends e6{constructor(a,b,c){super(a,b),this.isInstancedMesh=!0,this.instanceMatrix=new f0(new Float32Array(16*c),16),this.instanceColor=null,this.morphTexture=null,this.count=c,this.boundingBox=null,this.boundingSphere=null;for(let a=0;a<c;a++)this.setMatrixAt(a,f5)}computeBoundingBox(){let a=this.geometry,b=this.count;null===this.boundingBox&&(this.boundingBox=new dj),null===a.boundingBox&&a.computeBoundingBox(),this.boundingBox.makeEmpty();for(let c=0;c<b;c++)this.getMatrixAt(c,f1),f4.copy(a.boundingBox).applyMatrix4(f1),this.boundingBox.union(f4)}computeBoundingSphere(){let a=this.geometry,b=this.count;null===this.boundingSphere&&(this.boundingSphere=new dC),null===a.boundingSphere&&a.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let c=0;c<b;c++)this.getMatrixAt(c,f1),f7.copy(a.boundingSphere).applyMatrix4(f1),this.boundingSphere.union(f7)}copy(a,b){return super.copy(a,b),this.instanceMatrix.copy(a.instanceMatrix),null!==a.morphTexture&&(this.morphTexture=a.morphTexture.clone()),null!==a.instanceColor&&(this.instanceColor=a.instanceColor.clone()),this.count=a.count,null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),this}getColorAt(a,b){b.fromArray(this.instanceColor.array,3*a)}getMatrixAt(a,b){b.fromArray(this.instanceMatrix.array,16*a)}getMorphAt(a,b){let c=b.morphTargetInfluences,d=this.morphTexture.source.data.data,e=a*(c.length+1)+1;for(let a=0;a<c.length;a++)c[a]=d[e+a]}raycast(a,b){let c=this.matrixWorld,d=this.count;if((f6.geometry=this.geometry,f6.material=this.material,void 0!==f6.material)&&(null===this.boundingSphere&&this.computeBoundingSphere(),f7.copy(this.boundingSphere),f7.applyMatrix4(c),!1!==a.ray.intersectsSphere(f7)))for(let e=0;e<d;e++){this.getMatrixAt(e,f1),f2.multiplyMatrices(c,f1),f6.matrixWorld=f2,f6.raycast(a,f3);for(let a=0,c=f3.length;a<c;a++){let c=f3[a];c.instanceId=e,c.object=this,b.push(c)}f3.length=0}}setColorAt(a,b){null===this.instanceColor&&(this.instanceColor=new f0(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),b.toArray(this.instanceColor.array,3*a)}setMatrixAt(a,b){b.toArray(this.instanceMatrix.array,16*a)}setMorphAt(a,b){let c=b.morphTargetInfluences,d=c.length+1;null===this.morphTexture&&(this.morphTexture=new fY(new Float32Array(d*this.count),d,this.count,a_,aO));let e=this.morphTexture.source.data.data,f=0;for(let a=0;a<c.length;a++)f+=c[a];let g=this.geometry.morphTargetsRelative?1:1-f,h=d*a;e[h]=g,e.set(c,h+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null),this}}let f9=new dg,ga=new dg,gb=new cN;class gc{constructor(a=new dg(1,0,0),b=0){this.isPlane=!0,this.normal=a,this.constant=b}set(a,b){return this.normal.copy(a),this.constant=b,this}setComponents(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this}setFromNormalAndCoplanarPoint(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this}setFromCoplanarPoints(a,b,c){let d=f9.subVectors(c,b).cross(ga.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(d,a),this}copy(a){return this.normal.copy(a.normal),this.constant=a.constant,this}normalize(){let a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-a.radius}projectPoint(a,b){return b.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,b){let c=a.delta(f9),d=this.normal.dot(c);if(0===d)return 0===this.distanceToPoint(a.start)?b.copy(a.start):null;let e=-(a.start.dot(this.normal)+this.constant)/d;return e<0||e>1?null:b.copy(a.start).addScaledVector(c,e)}intersectsLine(a){let b=this.distanceToPoint(a.start),c=this.distanceToPoint(a.end);return b<0&&c>0||c<0&&b>0}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,b){let c=b||gb.getNormalMatrix(a),d=this.coplanarPoint(f9).applyMatrix4(a),e=this.normal.applyMatrix3(c).normalize();return this.constant=-d.dot(e),this}translate(a){return this.constant-=a.dot(this.normal),this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return new this.constructor().copy(this)}}let gd=new dC,ge=new dg;class gf{constructor(a=new gc,b=new gc,c=new gc,d=new gc,e=new gc,f=new gc){this.planes=[a,b,c,d,e,f]}set(a,b,c,d,e,f){let g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this}copy(a){let b=this.planes;for(let c=0;c<6;c++)b[c].copy(a.planes[c]);return this}setFromProjectionMatrix(a,b=cx){let c=this.planes,d=a.elements,e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d[5],k=d[6],l=d[7],m=d[8],n=d[9],o=d[10],p=d[11],q=d[12],r=d[13],s=d[14],t=d[15];if(c[0].setComponents(h-e,l-i,p-m,t-q).normalize(),c[1].setComponents(h+e,l+i,p+m,t+q).normalize(),c[2].setComponents(h+f,l+j,p+n,t+r).normalize(),c[3].setComponents(h-f,l-j,p-n,t-r).normalize(),c[4].setComponents(h-g,l-k,p-o,t-s).normalize(),b===cx)c[5].setComponents(h+g,l+k,p+o,t+s).normalize();else if(b===cy)c[5].setComponents(g,k,o,s).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+b);return this}intersectsObject(a){if(void 0!==a.boundingSphere)null===a.boundingSphere&&a.computeBoundingSphere(),gd.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{let b=a.geometry;null===b.boundingSphere&&b.computeBoundingSphere(),gd.copy(b.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(gd)}intersectsSprite(a){return gd.center.set(0,0,0),gd.radius=.7071067811865476,gd.applyMatrix4(a.matrixWorld),this.intersectsSphere(gd)}intersectsSphere(a){let b=this.planes,c=a.center,d=-a.radius;for(let a=0;a<6;a++)if(b[a].distanceToPoint(c)<d)return!1;return!0}intersectsBox(a){let b=this.planes;for(let c=0;c<6;c++){let d=b[c];if(ge.x=d.normal.x>0?a.max.x:a.min.x,ge.y=d.normal.y>0?a.max.y:a.min.y,ge.z=d.normal.z>0?a.max.z:a.min.z,0>d.distanceToPoint(ge))return!1}return!0}containsPoint(a){let b=this.planes;for(let c=0;c<6;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}clone(){return new this.constructor().copy(this)}}function gg(a,b){return a-b}function gh(a,b){return a.z-b.z}function gi(a,b){return b.z-a.z}class gj{constructor(){this.index=0,this.pool=[],this.list=[]}push(a,b,c,d){let e=this.pool,f=this.list;this.index>=e.length&&e.push({start:-1,count:-1,z:-1,index:-1});let g=e[this.index];f.push(g),this.index++,g.start=a,g.count=b,g.z=c,g.index=d}reset(){this.list.length=0,this.index=0}}let gk=new dL,gl=new et(1,1,1),gm=new gf,gn=new dj,go=new dC,gp=new dg,gq=new dg,gr=new dg,gs=new gj,gt=new e6,gu=[];function gv(a,b){if(a.constructor!==b.constructor){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++)b[d]=a[d]}else{let c=Math.min(a.length,b.length);b.set(new a.constructor(a.buffer,0,c))}}class gw extends e6{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(a,b,c=2*b,d){super(new eW,d),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=a,this._maxVertexCount=b,this._maxIndexCount=c,this._multiDrawCounts=new Int32Array(a),this._multiDrawStarts=new Int32Array(a),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let a=Math.sqrt(4*this._maxInstanceCount),b=new fY(new Float32Array((a=Math.max(a=4*Math.ceil(a/4),4))*a*4),a,a,aW,aO);this._matricesTexture=b}_initIndirectTexture(){let a=Math.sqrt(this._maxInstanceCount),b=new fY(new Uint32Array((a=Math.ceil(a))*a),a,a,a0,aN);this._indirectTexture=b}_initColorsTexture(){let a=Math.sqrt(this._maxInstanceCount),b=new fY(new Float32Array((a=Math.ceil(a))*a*4).fill(1),a,a,aW,aO);b.colorSpace=c_.workingColorSpace,this._colorsTexture=b}_initializeGeometry(a){let b=this.geometry,c=this._maxVertexCount,d=this._maxIndexCount;if(!1===this._geometryInitialized){for(let d in a.attributes){let{array:e,itemSize:f,normalized:g}=a.getAttribute(d),h=new eF(new e.constructor(c*f),f,g);b.setAttribute(d,h)}if(null!==a.getIndex()){let a=c>65535?new Uint32Array(d):new Uint16Array(d);b.setIndex(new eF(a,1))}this._geometryInitialized=!0}}_validateGeometry(a){let b=this.geometry;if(!!a.getIndex()!=!!b.getIndex())throw Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let c in b.attributes){if(!a.hasAttribute(c))throw Error(`THREE.BatchedMesh: Added geometry missing "${c}". All geometries must have consistent attributes.`);let d=a.getAttribute(c),e=b.getAttribute(c);if(d.itemSize!==e.itemSize||d.normalized!==e.normalized)throw Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(a){let b=this._instanceInfo;if(a<0||a>=b.length||!1===b[a].active)throw Error(`THREE.BatchedMesh: Invalid instanceId ${a}. Instance is either out of range or has been deleted.`)}validateGeometryId(a){let b=this._geometryInfo;if(a<0||a>=b.length||!1===b[a].active)throw Error(`THREE.BatchedMesh: Invalid geometryId ${a}. Geometry is either out of range or has been deleted.`)}setCustomSort(a){return this.customSort=a,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new dj);let a=this.boundingBox,b=this._instanceInfo;a.makeEmpty();for(let c=0,d=b.length;c<d;c++){if(!1===b[c].active)continue;let d=b[c].geometryIndex;this.getMatrixAt(c,gk),this.getBoundingBoxAt(d,gn).applyMatrix4(gk),a.union(gn)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new dC);let a=this.boundingSphere,b=this._instanceInfo;a.makeEmpty();for(let c=0,d=b.length;c<d;c++){if(!1===b[c].active)continue;let d=b[c].geometryIndex;this.getMatrixAt(c,gk),this.getBoundingSphereAt(d,go).applyMatrix4(gk),a.union(go)}}addInstance(a){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw Error("THREE.BatchedMesh: Maximum item count reached.");let b={visible:!0,active:!0,geometryIndex:a},c=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(gg),c=this._availableInstanceIds.shift(),this._instanceInfo[c]=b):(c=this._instanceInfo.length,this._instanceInfo.push(b));let d=this._matricesTexture;gk.identity().toArray(d.image.data,16*c),d.needsUpdate=!0;let e=this._colorsTexture;return e&&(gl.toArray(e.image.data,4*c),e.needsUpdate=!0),this._visibilityChanged=!0,c}addGeometry(a,b=-1,c=-1){let d;this._initializeGeometry(a),this._validateGeometry(a);let e={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},f=this._geometryInfo;e.vertexStart=this._nextVertexStart,e.reservedVertexCount=-1===b?a.getAttribute("position").count:b;let g=a.getIndex();if(null!==g&&(e.indexStart=this._nextIndexStart,e.reservedIndexCount=-1===c?g.count:c),-1!==e.indexStart&&e.indexStart+e.reservedIndexCount>this._maxIndexCount||e.vertexStart+e.reservedVertexCount>this._maxVertexCount)throw Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(gg),f[d=this._availableGeometryIds.shift()]=e):(d=this._geometryCount,this._geometryCount++,f.push(e)),this.setGeometryAt(d,a),this._nextIndexStart=e.indexStart+e.reservedIndexCount,this._nextVertexStart=e.vertexStart+e.reservedVertexCount,d}setGeometryAt(a,b){if(a>=this._geometryCount)throw Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(b);let c=this.geometry,d=null!==c.getIndex(),e=c.getIndex(),f=b.getIndex(),g=this._geometryInfo[a];if(d&&f.count>g.reservedIndexCount||b.attributes.position.count>g.reservedVertexCount)throw Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let h=g.vertexStart,i=g.reservedVertexCount;for(let a in g.vertexCount=b.getAttribute("position").count,c.attributes){let d=b.getAttribute(a),e=c.getAttribute(a);!function(a,b,c=0){let d=b.itemSize;if(a.isInterleavedBufferAttribute||a.array.constructor!==b.array.constructor){let e=a.count;for(let f=0;f<e;f++)for(let e=0;e<d;e++)b.setComponent(f+c,e,a.getComponent(f,e))}else b.array.set(a.array,c*d);b.needsUpdate=!0}(d,e,h);let f=d.itemSize;for(let a=d.count;a<i;a++){let b=h+a;for(let a=0;a<f;a++)e.setComponent(b,a,0)}e.needsUpdate=!0,e.addUpdateRange(h*f,i*f)}if(d){let a=g.indexStart,c=g.reservedIndexCount;g.indexCount=b.getIndex().count;for(let b=0;b<f.count;b++)e.setX(a+b,h+f.getX(b));for(let b=f.count;b<c;b++)e.setX(a+b,h);e.needsUpdate=!0,e.addUpdateRange(a,g.reservedIndexCount)}return g.start=d?g.indexStart:g.vertexStart,g.count=d?g.indexCount:g.vertexCount,g.boundingBox=null,null!==b.boundingBox&&(g.boundingBox=b.boundingBox.clone()),g.boundingSphere=null,null!==b.boundingSphere&&(g.boundingSphere=b.boundingSphere.clone()),this._visibilityChanged=!0,a}deleteGeometry(a){let b=this._geometryInfo;if(a>=b.length||!1===b[a].active)return this;let c=this._instanceInfo;for(let b=0,d=c.length;b<d;b++)c[b].active&&c[b].geometryIndex===a&&this.deleteInstance(b);return b[a].active=!1,this._availableGeometryIds.push(a),this._visibilityChanged=!0,this}deleteInstance(a){return this.validateInstanceId(a),this._instanceInfo[a].active=!1,this._availableInstanceIds.push(a),this._visibilityChanged=!0,this}optimize(){let a=0,b=0,c=this._geometryInfo,d=c.map((a,b)=>b).sort((a,b)=>c[a].vertexStart-c[b].vertexStart),e=this.geometry;for(let f=0,g=c.length;f<g;f++){let g=c[d[f]];if(!1!==g.active){if(null!==e.index){if(g.indexStart!==b){let{indexStart:c,vertexStart:d,reservedIndexCount:f}=g,h=e.index,i=h.array,j=a-d;for(let a=c;a<c+f;a++)i[a]=i[a]+j;h.array.copyWithin(b,c,c+f),h.addUpdateRange(b,f),g.indexStart=b}b+=g.reservedIndexCount}if(g.vertexStart!==a){let{vertexStart:b,reservedVertexCount:c}=g,d=e.attributes;for(let e in d){let f=d[e],{array:g,itemSize:h}=f;g.copyWithin(a*h,b*h,(b+c)*h),f.addUpdateRange(a*h,c*h)}g.vertexStart=a}a+=g.reservedVertexCount,g.start=e.index?g.indexStart:g.vertexStart,this._nextIndexStart=e.index?g.indexStart+g.reservedIndexCount:0,this._nextVertexStart=g.vertexStart+g.reservedVertexCount}}return this}getBoundingBoxAt(a,b){if(a>=this._geometryCount)return null;let c=this.geometry,d=this._geometryInfo[a];if(null===d.boundingBox){let a=new dj,b=c.index,e=c.attributes.position;for(let c=d.start,f=d.start+d.count;c<f;c++){let d=c;b&&(d=b.getX(d)),a.expandByPoint(gp.fromBufferAttribute(e,d))}d.boundingBox=a}return b.copy(d.boundingBox),b}getBoundingSphereAt(a,b){if(a>=this._geometryCount)return null;let c=this.geometry,d=this._geometryInfo[a];if(null===d.boundingSphere){let b=new dC;this.getBoundingBoxAt(a,gn),gn.getCenter(b.center);let e=c.index,f=c.attributes.position,g=0;for(let a=d.start,c=d.start+d.count;a<c;a++){let c=a;e&&(c=e.getX(c)),gp.fromBufferAttribute(f,c),g=Math.max(g,b.center.distanceToSquared(gp))}b.radius=Math.sqrt(g),d.boundingSphere=b}return b.copy(d.boundingSphere),b}setMatrixAt(a,b){this.validateInstanceId(a);let c=this._matricesTexture,d=this._matricesTexture.image.data;return b.toArray(d,16*a),c.needsUpdate=!0,this}getMatrixAt(a,b){return this.validateInstanceId(a),b.fromArray(this._matricesTexture.image.data,16*a)}setColorAt(a,b){return this.validateInstanceId(a),null===this._colorsTexture&&this._initColorsTexture(),b.toArray(this._colorsTexture.image.data,4*a),this._colorsTexture.needsUpdate=!0,this}getColorAt(a,b){return this.validateInstanceId(a),b.fromArray(this._colorsTexture.image.data,4*a)}setVisibleAt(a,b){return this.validateInstanceId(a),this._instanceInfo[a].visible===b||(this._instanceInfo[a].visible=b,this._visibilityChanged=!0),this}getVisibleAt(a){return this.validateInstanceId(a),this._instanceInfo[a].visible}setGeometryIdAt(a,b){return this.validateInstanceId(a),this.validateGeometryId(b),this._instanceInfo[a].geometryIndex=b,this}getGeometryIdAt(a){return this.validateInstanceId(a),this._instanceInfo[a].geometryIndex}getGeometryRangeAt(a,b={}){this.validateGeometryId(a);let c=this._geometryInfo[a];return b.vertexStart=c.vertexStart,b.vertexCount=c.vertexCount,b.reservedVertexCount=c.reservedVertexCount,b.indexStart=c.indexStart,b.indexCount=c.indexCount,b.reservedIndexCount=c.reservedIndexCount,b.start=c.start,b.count=c.count,b}setInstanceCount(a){let b=this._availableInstanceIds,c=this._instanceInfo;for(b.sort(gg);b[b.length-1]===c.length;)c.pop(),b.pop();if(a<c.length)throw Error(`BatchedMesh: Instance ids outside the range ${a} are being used. Cannot shrink instance count.`);let d=new Int32Array(a),e=new Int32Array(a);gv(this._multiDrawCounts,d),gv(this._multiDrawStarts,e),this._multiDrawCounts=d,this._multiDrawStarts=e,this._maxInstanceCount=a;let f=this._indirectTexture,g=this._matricesTexture,h=this._colorsTexture;f.dispose(),this._initIndirectTexture(),gv(f.image.data,this._indirectTexture.image.data),g.dispose(),this._initMatricesTexture(),gv(g.image.data,this._matricesTexture.image.data),h&&(h.dispose(),this._initColorsTexture(),gv(h.image.data,this._colorsTexture.image.data))}setGeometrySize(a,b){let c=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...c.map(a=>a.vertexStart+a.reservedVertexCount))>a)throw Error(`BatchedMesh: Geometry vertex values are being used outside the range ${b}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...c.map(a=>a.indexStart+a.reservedIndexCount))>b)throw Error(`BatchedMesh: Geometry index values are being used outside the range ${b}. Cannot shrink further.`);let d=this.geometry;d.dispose(),this._maxVertexCount=a,this._maxIndexCount=b,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new eW,this._initializeGeometry(d));let e=this.geometry;for(let a in d.index&&gv(d.index.array,e.index.array),d.attributes)gv(d.attributes[a].array,e.attributes[a].array)}raycast(a,b){let c=this._instanceInfo,d=this._geometryInfo,e=this.matrixWorld,f=this.geometry;gt.material=this.material,gt.geometry.index=f.index,gt.geometry.attributes=f.attributes,null===gt.geometry.boundingBox&&(gt.geometry.boundingBox=new dj),null===gt.geometry.boundingSphere&&(gt.geometry.boundingSphere=new dC);for(let f=0,g=c.length;f<g;f++){if(!c[f].visible||!c[f].active)continue;let g=c[f].geometryIndex,h=d[g];gt.geometry.setDrawRange(h.start,h.count),this.getMatrixAt(f,gt.matrixWorld).premultiply(e),this.getBoundingBoxAt(g,gt.geometry.boundingBox),this.getBoundingSphereAt(g,gt.geometry.boundingSphere),gt.raycast(a,gu);for(let a=0,c=gu.length;a<c;a++){let c=gu[a];c.object=this,c.batchId=f,b.push(c)}gu.length=0}gt.material=null,gt.geometry.index=null,gt.geometry.attributes={},gt.geometry.setDrawRange(0,1/0)}copy(a){return super.copy(a),this.geometry=a.geometry.clone(),this.perObjectFrustumCulled=a.perObjectFrustumCulled,this.sortObjects=a.sortObjects,this.boundingBox=null!==a.boundingBox?a.boundingBox.clone():null,this.boundingSphere=null!==a.boundingSphere?a.boundingSphere.clone():null,this._geometryInfo=a._geometryInfo.map(a=>({...a,boundingBox:null!==a.boundingBox?a.boundingBox.clone():null,boundingSphere:null!==a.boundingSphere?a.boundingSphere.clone():null})),this._instanceInfo=a._instanceInfo.map(a=>({...a})),this._maxInstanceCount=a._maxInstanceCount,this._maxVertexCount=a._maxVertexCount,this._maxIndexCount=a._maxIndexCount,this._geometryInitialized=a._geometryInitialized,this._geometryCount=a._geometryCount,this._multiDrawCounts=a._multiDrawCounts.slice(),this._multiDrawStarts=a._multiDrawStarts.slice(),this._matricesTexture=a._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=a._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(a,b,c,d,e){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let f=d.getIndex(),g=null===f?1:f.array.BYTES_PER_ELEMENT,h=this._instanceInfo,i=this._multiDrawStarts,j=this._multiDrawCounts,k=this._geometryInfo,l=this.perObjectFrustumCulled,m=this._indirectTexture,n=m.image.data;l&&(gk.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse).multiply(this.matrixWorld),gm.setFromProjectionMatrix(gk,a.coordinateSystem));let o=0;if(this.sortObjects){gk.copy(this.matrixWorld).invert(),gp.setFromMatrixPosition(c.matrixWorld).applyMatrix4(gk),gq.set(0,0,-1).transformDirection(c.matrixWorld).transformDirection(gk);for(let a=0,b=h.length;a<b;a++)if(h[a].visible&&h[a].active){let b=h[a].geometryIndex;this.getMatrixAt(a,gk),this.getBoundingSphereAt(b,go).applyMatrix4(gk);let c=!1;if(l&&(c=!gm.intersectsSphere(go)),!c){let c=k[b],d=gr.subVectors(go.center,gp).dot(gq);gs.push(c.start,c.count,d,a)}}let a=gs.list,b=this.customSort;null===b?a.sort(e.transparent?gi:gh):b.call(this,a,c);for(let b=0,c=a.length;b<c;b++){let c=a[b];i[o]=c.start*g,j[o]=c.count,n[o]=c.index,o++}gs.reset()}else for(let a=0,b=h.length;a<b;a++)if(h[a].visible&&h[a].active){let b=h[a].geometryIndex,c=!1;if(l&&(this.getMatrixAt(a,gk),this.getBoundingSphereAt(b,go).applyMatrix4(gk),c=!gm.intersectsSphere(go)),!c){let c=k[b];i[o]=c.start*g,j[o]=c.count,n[o]=a,o++}}m.needsUpdate=!0,this._multiDrawCount=o,this._visibilityChanged=!1}onBeforeShadow(a,b,c,d,e,f){this.onBeforeRender(a,null,d,e,f)}}class gx extends ew{constructor(a){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new et(0xffffff),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.fog=a.fog,this}}let gy=new dg,gz=new dg,gA=new dL,gB=new dK,gC=new dC,gD=new dg,gE=new dg;class gF extends ea{constructor(a=new eW,b=new gx){super(),this.isLine=!0,this.type="Line",this.geometry=a,this.material=b,this.updateMorphTargets()}copy(a,b){return super.copy(a,b),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}computeLineDistances(){let a=this.geometry;if(null===a.index){let b=a.attributes.position,c=[0];for(let a=1,d=b.count;a<d;a++)gy.fromBufferAttribute(b,a-1),gz.fromBufferAttribute(b,a),c[a]=c[a-1],c[a]+=gy.distanceTo(gz);a.setAttribute("lineDistance",new eO(c,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,b){let c=this.geometry,d=this.matrixWorld,e=a.params.Line.threshold,f=c.drawRange;if(null===c.boundingSphere&&c.computeBoundingSphere(),gC.copy(c.boundingSphere),gC.applyMatrix4(d),gC.radius+=e,!1===a.ray.intersectsSphere(gC))return;gA.copy(d).invert(),gB.copy(a.ray).applyMatrix4(gA);let g=e/((this.scale.x+this.scale.y+this.scale.z)/3),h=g*g,i=this.isLineSegments?2:1,j=c.index,k=c.attributes.position;if(null!==j){let c=Math.max(0,f.start),d=Math.min(j.count,f.start+f.count);for(let e=c,f=d-1;e<f;e+=i){let c=gG(this,a,gB,h,j.getX(e),j.getX(e+1),e);c&&b.push(c)}if(this.isLineLoop){let e=gG(this,a,gB,h,j.getX(d-1),j.getX(c),d-1);e&&b.push(e)}}else{let c=Math.max(0,f.start),d=Math.min(k.count,f.start+f.count);for(let e=c,f=d-1;e<f;e+=i){let c=gG(this,a,gB,h,e,e+1,e);c&&b.push(c)}if(this.isLineLoop){let e=gG(this,a,gB,h,d-1,c,d-1);e&&b.push(e)}}}updateMorphTargets(){let a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0){let c=a[b[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,b=c.length;a<b;a++){let b=c[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=a}}}}}function gG(a,b,c,d,e,f,g){let h=a.geometry.attributes.position;if(gy.fromBufferAttribute(h,e),gz.fromBufferAttribute(h,f),c.distanceSqToSegment(gy,gz,gD,gE)>d)return;gD.applyMatrix4(a.matrixWorld);let i=b.ray.origin.distanceTo(gD);if(!(i<b.near)&&!(i>b.far))return{distance:i,point:gE.clone().applyMatrix4(a.matrixWorld),index:g,face:null,faceIndex:null,barycoord:null,object:a}}let gH=new dg,gI=new dg;class gJ extends gF{constructor(a,b){super(a,b),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let a=this.geometry;if(null===a.index){let b=a.attributes.position,c=[];for(let a=0,d=b.count;a<d;a+=2)gH.fromBufferAttribute(b,a),gI.fromBufferAttribute(b,a+1),c[a]=0===a?0:c[a-1],c[a+1]=c[a]+gH.distanceTo(gI);a.setAttribute("lineDistance",new eO(c,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class gK extends gF{constructor(a,b){super(a,b),this.isLineLoop=!0,this.type="LineLoop"}}class gL extends ew{constructor(a){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new et(0xffffff),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}let gM=new dL,gN=new dK,gO=new dC,gP=new dg;class gQ extends ea{constructor(a=new eW,b=new gL){super(),this.isPoints=!0,this.type="Points",this.geometry=a,this.material=b,this.updateMorphTargets()}copy(a,b){return super.copy(a,b),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}raycast(a,b){let c=this.geometry,d=this.matrixWorld,e=a.params.Points.threshold,f=c.drawRange;if(null===c.boundingSphere&&c.computeBoundingSphere(),gO.copy(c.boundingSphere),gO.applyMatrix4(d),gO.radius+=e,!1===a.ray.intersectsSphere(gO))return;gM.copy(d).invert(),gN.copy(a.ray).applyMatrix4(gM);let g=e/((this.scale.x+this.scale.y+this.scale.z)/3),h=g*g,i=c.index,j=c.attributes.position;if(null!==i){let c=Math.max(0,f.start),e=Math.min(i.count,f.start+f.count);for(let f=c;f<e;f++){let c=i.getX(f);gP.fromBufferAttribute(j,c),gR(gP,c,h,d,a,b,this)}}else{let c=Math.max(0,f.start),e=Math.min(j.count,f.start+f.count);for(let f=c;f<e;f++)gP.fromBufferAttribute(j,f),gR(gP,f,h,d,a,b,this)}}updateMorphTargets(){let a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0){let c=a[b[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,b=c.length;a<b;a++){let b=c[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=a}}}}}function gR(a,b,c,d,e,f,g){let h=gN.distanceSqToPoint(a);if(h<c){let c=new dg;gN.closestPointToPoint(a,c),c.applyMatrix4(d);let i=e.ray.origin.distanceTo(c);if(i<e.near||i>e.far)return;f.push({distance:i,distanceToRay:Math.sqrt(h),point:c,index:b,face:null,faceIndex:null,barycoord:null,object:g})}}class gS extends c7{constructor(a,b,c,d,e,f,g,h,i){super(a,b,c,d,e,f,g,h,i),this.isVideoTexture=!0,this.minFilter=void 0!==f?f:aD,this.magFilter=void 0!==e?e:aD,this.generateMipmaps=!1;let j=this;"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(function b(){j.needsUpdate=!0,a.requestVideoFrameCallback(b)})}clone(){return new this.constructor(this.image).copy(this)}update(){let a=this.image;!1=="requestVideoFrameCallback"in a&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class gT extends gS{constructor(a,b,c,d,e,f,g,h){super({},a,b,c,d,e,f,g,h),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(a){this.image=a,this.needsUpdate=!0}}class gU extends c7{constructor(a,b){super({width:a,height:b}),this.isFramebufferTexture=!0,this.magFilter=ay,this.minFilter=ay,this.generateMipmaps=!1,this.needsUpdate=!0}}class gV extends c7{constructor(a,b,c,d,e,f,g,h,i,j,k,l){super(null,f,g,h,i,j,d,e,k,l),this.isCompressedTexture=!0,this.image={width:b,height:c},this.mipmaps=a,this.flipY=!1,this.generateMipmaps=!1}}class gW extends gV{constructor(a,b,c,d,e,f){super(a,b,c,e,f),this.isCompressedArrayTexture=!0,this.image.depth=d,this.wrapR=aw,this.layerUpdates=new Set}addLayerUpdate(a){this.layerUpdates.add(a)}clearLayerUpdates(){this.layerUpdates.clear()}}class gX extends gV{constructor(a,b,c){super(void 0,a[0].width,a[0].height,b,c,aq),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=a}}class gY extends c7{constructor(a,b,c,d,e,f,g,h,i){super(a,b,c,d,e,f,g,h,i),this.isCanvasTexture=!0,this.needsUpdate=!0}}class gZ extends c7{constructor(a,b,c,d,e,f,g,h,i,j=aZ){if(j!==aZ&&j!==a$)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&j===aZ&&(c=aN),void 0===c&&j===a$&&(c=aS),super(null,d,e,f,g,h,j,c,i),this.isDepthTexture=!0,this.image={width:a,height:b},this.magFilter=void 0!==g?g:ay,this.minFilter=void 0!==h?h:ay,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(a){return super.copy(a),this.compareFunction=a.compareFunction,this}toJSON(a){let b=super.toJSON(a);return null!==this.compareFunction&&(b.compareFunction=this.compareFunction),b}}class g${constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(a,b){let c=this.getUtoTmapping(a);return this.getPoint(c,b)}getPoints(a=5){let b=[];for(let c=0;c<=a;c++)b.push(this.getPoint(c/a));return b}getSpacedPoints(a=5){let b=[];for(let c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b}getLength(){let a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let b=[],c,d=this.getPoint(0),e=0;b.push(0);for(let f=1;f<=a;f++)b.push(e+=(c=this.getPoint(f/a)).distanceTo(d)),d=c;return this.cacheArcLengths=b,b}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(a,b){let c,d=this.getLengths(),e=0,f=d.length;c=b||a*d[f-1];let g=0,h=f-1,i;for(;g<=h;)if((i=d[e=Math.floor(g+(h-g)/2)]-c)<0)g=e+1;else if(i>0)h=e-1;else{h=e;break}if(d[e=h]===c)return e/(f-1);let j=d[e],k=d[e+1];return(e+(c-j)/(k-j))/(f-1)}getTangent(a,b){let c=a-1e-4,d=a+1e-4;c<0&&(c=0),d>1&&(d=1);let e=this.getPoint(c),f=this.getPoint(d),g=b||(e.isVector2?new cM:new dg);return g.copy(f).sub(e).normalize(),g}getTangentAt(a,b){let c=this.getUtoTmapping(a);return this.getTangent(c,b)}computeFrenetFrames(a,b){let c=new dg,d=[],e=[],f=[],g=new dg,h=new dL;for(let b=0;b<=a;b++){let c=b/a;d[b]=this.getTangentAt(c,new dg)}e[0]=new dg,f[0]=new dg;let i=Number.MAX_VALUE,j=Math.abs(d[0].x),k=Math.abs(d[0].y),l=Math.abs(d[0].z);j<=i&&(i=j,c.set(1,0,0)),k<=i&&(i=k,c.set(0,1,0)),l<=i&&c.set(0,0,1),g.crossVectors(d[0],c).normalize(),e[0].crossVectors(d[0],g),f[0].crossVectors(d[0],e[0]);for(let b=1;b<=a;b++){if(e[b]=e[b-1].clone(),f[b]=f[b-1].clone(),g.crossVectors(d[b-1],d[b]),g.length()>Number.EPSILON){g.normalize();let a=Math.acos(cG(d[b-1].dot(d[b]),-1,1));e[b].applyMatrix4(h.makeRotationAxis(g,a))}f[b].crossVectors(d[b],e[b])}if(!0===b){let b=Math.acos(cG(e[0].dot(e[a]),-1,1));b/=a,d[0].dot(g.crossVectors(e[0],e[a]))>0&&(b=-b);for(let c=1;c<=a;c++)e[c].applyMatrix4(h.makeRotationAxis(d[c],b*c)),f[c].crossVectors(d[c],e[c])}return{tangents:d,normals:e,binormals:f}}clone(){return new this.constructor().copy(this)}copy(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}toJSON(){let a={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a}fromJSON(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}class g_ extends g${constructor(a=0,b=0,c=1,d=1,e=0,f=2*Math.PI,g=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=a,this.aY=b,this.xRadius=c,this.yRadius=d,this.aStartAngle=e,this.aEndAngle=f,this.aClockwise=g,this.aRotation=h}getPoint(a,b=new cM){let c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;for(;d<0;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c),!0!==this.aClockwise||e||(d===c?d=-c:d-=c);let f=this.aStartAngle+a*d,g=this.aX+this.xRadius*Math.cos(f),h=this.aY+this.yRadius*Math.sin(f);if(0!==this.aRotation){let a=Math.cos(this.aRotation),b=Math.sin(this.aRotation),c=g-this.aX,d=h-this.aY;g=c*a-d*b+this.aX,h=c*b+d*a+this.aY}return b.set(g,h)}copy(a){return super.copy(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}toJSON(){let a=super.toJSON();return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a}fromJSON(a){return super.fromJSON(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}}class g0 extends g_{constructor(a,b,c,d,e,f){super(a,b,c,c,d,e,f),this.isArcCurve=!0,this.type="ArcCurve"}}function g1(){let a=0,b=0,c=0,d=0;function e(e,f,g,h){a=e,b=g,c=-3*e+3*f-2*g-h,d=2*e-2*f+g+h}return{initCatmullRom:function(a,b,c,d,f){e(b,c,f*(c-a),f*(d-b))},initNonuniformCatmullRom:function(a,b,c,d,f,g,h){let i=(b-a)/f-(c-a)/(f+g)+(c-b)/g,j=(c-b)/g-(d-b)/(g+h)+(d-c)/h;e(b,c,i*=g,j*=g)},calc:function(e){let f=e*e;return a+b*e+c*f+f*e*d}}}let g2=new dg,g3=new g1,g4=new g1,g5=new g1;class g6 extends g${constructor(a=[],b=!1,c="centripetal",d=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=a,this.closed=b,this.curveType=c,this.tension=d}getPoint(a,b=new dg){let c,d,e=this.points,f=e.length,g=(f-!this.closed)*a,h=Math.floor(g),i=g-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/f)+1)*f:0===i&&h===f-1&&(h=f-2,i=1),this.closed||h>0?c=e[(h-1)%f]:(g2.subVectors(e[0],e[1]).add(e[0]),c=g2);let j=e[h%f],k=e[(h+1)%f];if(this.closed||h+2<f?d=e[(h+2)%f]:(g2.subVectors(e[f-1],e[f-2]).add(e[f-1]),d=g2),"centripetal"===this.curveType||"chordal"===this.curveType){let a="chordal"===this.curveType?.5:.25,b=Math.pow(c.distanceToSquared(j),a),e=Math.pow(j.distanceToSquared(k),a),f=Math.pow(k.distanceToSquared(d),a);e<1e-4&&(e=1),b<1e-4&&(b=e),f<1e-4&&(f=e),g3.initNonuniformCatmullRom(c.x,j.x,k.x,d.x,b,e,f),g4.initNonuniformCatmullRom(c.y,j.y,k.y,d.y,b,e,f),g5.initNonuniformCatmullRom(c.z,j.z,k.z,d.z,b,e,f)}else"catmullrom"===this.curveType&&(g3.initCatmullRom(c.x,j.x,k.x,d.x,this.tension),g4.initCatmullRom(c.y,j.y,k.y,d.y,this.tension),g5.initCatmullRom(c.z,j.z,k.z,d.z,this.tension));return b.set(g3.calc(i),g4.calc(i),g5.calc(i)),b}copy(a){super.copy(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(c.clone())}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}toJSON(){let a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++){let c=this.points[b];a.points.push(c.toArray())}return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a}fromJSON(a){super.fromJSON(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(new dg().fromArray(c))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}}function g7(a,b,c,d,e){let f=(d-b)*.5,g=(e-c)*.5,h=a*a;return a*h*(2*c-2*d+f+g)+(-3*c+3*d-2*f-g)*h+f*a+c}function g8(a,b,c,d){return function(a,b){let c=1-a;return c*c*b}(a,b)+2*(1-a)*a*c+a*a*d}function g9(a,b,c,d,e){return function(a,b){let c=1-a;return c*c*c*b}(a,b)+function(a,b){let c=1-a;return 3*c*c*a*b}(a,c)+3*(1-a)*a*a*d+a*a*a*e}class ha extends g${constructor(a=new cM,b=new cM,c=new cM,d=new cM){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=a,this.v1=b,this.v2=c,this.v3=d}getPoint(a,b=new cM){let c=this.v0,d=this.v1,e=this.v2,f=this.v3;return b.set(g9(a,c.x,d.x,e.x,f.x),g9(a,c.y,d.y,e.y,f.y)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class hb extends g${constructor(a=new dg,b=new dg,c=new dg,d=new dg){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=a,this.v1=b,this.v2=c,this.v3=d}getPoint(a,b=new dg){let c=this.v0,d=this.v1,e=this.v2,f=this.v3;return b.set(g9(a,c.x,d.x,e.x,f.x),g9(a,c.y,d.y,e.y,f.y),g9(a,c.z,d.z,e.z,f.z)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class hc extends g${constructor(a=new cM,b=new cM){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=a,this.v2=b}getPoint(a,b=new cM){return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new cM){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class hd extends g${constructor(a=new dg,b=new dg){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=a,this.v2=b}getPoint(a,b=new dg){return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new dg){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class he extends g${constructor(a=new cM,b=new cM,c=new cM){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=a,this.v1=b,this.v2=c}getPoint(a,b=new cM){let c=this.v0,d=this.v1,e=this.v2;return b.set(g8(a,c.x,d.x,e.x),g8(a,c.y,d.y,e.y)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class hf extends g${constructor(a=new dg,b=new dg,c=new dg){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=a,this.v1=b,this.v2=c}getPoint(a,b=new dg){let c=this.v0,d=this.v1,e=this.v2;return b.set(g8(a,c.x,d.x,e.x),g8(a,c.y,d.y,e.y),g8(a,c.z,d.z,e.z)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class hg extends g${constructor(a=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=a}getPoint(a,b=new cM){let c=this.points,d=(c.length-1)*a,e=Math.floor(d),f=d-e,g=c[0===e?e:e-1],h=c[e],i=c[e>c.length-2?c.length-1:e+1],j=c[e>c.length-3?c.length-1:e+2];return b.set(g7(f,g.x,h.x,i.x,j.x),g7(f,g.y,h.y,i.y,j.y)),b}copy(a){super.copy(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(c.clone())}return this}toJSON(){let a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++){let c=this.points[b];a.points.push(c.toArray())}return a}fromJSON(a){super.fromJSON(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(new cM().fromArray(c))}return this}}var hh=Object.freeze({__proto__:null,ArcCurve:g0,CatmullRomCurve3:g6,CubicBezierCurve:ha,CubicBezierCurve3:hb,EllipseCurve:g_,LineCurve:hc,LineCurve3:hd,QuadraticBezierCurve:he,QuadraticBezierCurve3:hf,SplineCurve:hg});class hi extends g${constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(a){this.curves.push(a)}closePath(){let a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);if(!a.equals(b)){let c=!0===a.isVector2?"LineCurve":"LineCurve3";this.curves.push(new hh[c](b,a))}return this}getPoint(a,b){let c=a*this.getLength(),d=this.getCurveLengths(),e=0;for(;e<d.length;){if(d[e]>=c){let a=d[e]-c,f=this.curves[e],g=f.getLength(),h=0===g?0:1-a/g;return f.getPointAt(h,b)}e++}return null}getLength(){let a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let a=[],b=0;for(let c=0,d=this.curves.length;c<d;c++)a.push(b+=this.curves[c].getLength());return this.cacheLengths=a,a}getSpacedPoints(a=40){let b=[];for(let c=0;c<=a;c++)b.push(this.getPoint(c/a));return this.autoClose&&b.push(b[0]),b}getPoints(a=12){let b,c=[];for(let d=0,e=this.curves;d<e.length;d++){let f=e[d],g=f.isEllipseCurve?2*a:f.isLineCurve||f.isLineCurve3?1:f.isSplineCurve?a*f.points.length:a,h=f.getPoints(g);for(let a=0;a<h.length;a++){let d=h[a];b&&b.equals(d)||(c.push(d),b=d)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(a){super.copy(a),this.curves=[];for(let b=0,c=a.curves.length;b<c;b++){let c=a.curves[b];this.curves.push(c.clone())}return this.autoClose=a.autoClose,this}toJSON(){let a=super.toJSON();a.autoClose=this.autoClose,a.curves=[];for(let b=0,c=this.curves.length;b<c;b++){let c=this.curves[b];a.curves.push(c.toJSON())}return a}fromJSON(a){super.fromJSON(a),this.autoClose=a.autoClose,this.curves=[];for(let b=0,c=a.curves.length;b<c;b++){let c=a.curves[b];this.curves.push(new hh[c.type]().fromJSON(c))}return this}}class hj extends hi{constructor(a){super(),this.type="Path",this.currentPoint=new cM,a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,a[0].y);for(let b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y);return this}moveTo(a,b){return this.currentPoint.set(a,b),this}lineTo(a,b){let c=new hc(this.currentPoint.clone(),new cM(a,b));return this.curves.push(c),this.currentPoint.set(a,b),this}quadraticCurveTo(a,b,c,d){let e=new he(this.currentPoint.clone(),new cM(a,b),new cM(c,d));return this.curves.push(e),this.currentPoint.set(c,d),this}bezierCurveTo(a,b,c,d,e,f){let g=new ha(this.currentPoint.clone(),new cM(a,b),new cM(c,d),new cM(e,f));return this.curves.push(g),this.currentPoint.set(e,f),this}splineThru(a){let b=new hg([this.currentPoint.clone()].concat(a));return this.curves.push(b),this.currentPoint.copy(a[a.length-1]),this}arc(a,b,c,d,e,f){let g=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(a+g,b+h,c,d,e,f),this}absarc(a,b,c,d,e,f){return this.absellipse(a,b,c,c,d,e,f),this}ellipse(a,b,c,d,e,f,g,h){let i=this.currentPoint.x,j=this.currentPoint.y;return this.absellipse(a+i,b+j,c,d,e,f,g,h),this}absellipse(a,b,c,d,e,f,g,h){let i=new g_(a,b,c,d,e,f,g,h);if(this.curves.length>0){let a=i.getPoint(0);a.equals(this.currentPoint)||this.lineTo(a.x,a.y)}this.curves.push(i);let j=i.getPoint(1);return this.currentPoint.copy(j),this}copy(a){return super.copy(a),this.currentPoint.copy(a.currentPoint),this}toJSON(){let a=super.toJSON();return a.currentPoint=this.currentPoint.toArray(),a}fromJSON(a){return super.fromJSON(a),this.currentPoint.fromArray(a.currentPoint),this}}class hk extends eW{constructor(a=[new cM(0,-.5),new cM(.5,0),new cM(0,.5)],b=12,c=0,d=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:a,segments:b,phiStart:c,phiLength:d},b=Math.floor(b),d=cG(d,0,2*Math.PI);let e=[],f=[],g=[],h=[],i=[],j=1/b,k=new dg,l=new cM,m=new dg,n=new dg,o=new dg,p=0,q=0;for(let b=0;b<=a.length-1;b++)switch(b){case 0:p=a[b+1].x-a[b].x,m.x=+(q=a[b+1].y-a[b].y),m.y=-p,m.z=0*q,o.copy(m),m.normalize(),h.push(m.x,m.y,m.z);break;case a.length-1:h.push(o.x,o.y,o.z);break;default:p=a[b+1].x-a[b].x,m.x=+(q=a[b+1].y-a[b].y),m.y=-p,m.z=0*q,n.copy(m),m.x+=o.x,m.y+=o.y,m.z+=o.z,m.normalize(),h.push(m.x,m.y,m.z),o.copy(n)}for(let e=0;e<=b;e++){let m=c+e*j*d,n=Math.sin(m),o=Math.cos(m);for(let c=0;c<=a.length-1;c++){k.x=a[c].x*n,k.y=a[c].y,k.z=a[c].x*o,f.push(k.x,k.y,k.z),l.x=e/b,l.y=c/(a.length-1),g.push(l.x,l.y);let d=h[3*c+0]*n,j=h[3*c+1],m=h[3*c+0]*o;i.push(d,j,m)}}for(let c=0;c<b;c++)for(let b=0;b<a.length-1;b++){let d=b+c*a.length,f=d+a.length,g=d+a.length+1,h=d+1;e.push(d,f,h),e.push(g,h,f)}this.setIndex(e),this.setAttribute("position",new eO(f,3)),this.setAttribute("uv",new eO(g,2)),this.setAttribute("normal",new eO(i,3))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hk(a.points,a.segments,a.phiStart,a.phiLength)}}class hl extends hk{constructor(a=1,b=1,c=4,d=8){let e=new hj;e.absarc(0,-b/2,a,1.5*Math.PI,0),e.absarc(0,b/2,a,0,.5*Math.PI),super(e.getPoints(c),d),this.type="CapsuleGeometry",this.parameters={radius:a,length:b,capSegments:c,radialSegments:d}}static fromJSON(a){return new hl(a.radius,a.length,a.capSegments,a.radialSegments)}}class hm extends eW{constructor(a=1,b=32,c=0,d=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d},b=Math.max(3,b);let e=[],f=[],g=[],h=[],i=new dg,j=new cM;f.push(0,0,0),g.push(0,0,1),h.push(.5,.5);for(let e=0,k=3;e<=b;e++,k+=3){let l=c+e/b*d;i.x=a*Math.cos(l),i.y=a*Math.sin(l),f.push(i.x,i.y,i.z),g.push(0,0,1),j.x=(f[k]/a+1)/2,j.y=(f[k+1]/a+1)/2,h.push(j.x,j.y)}for(let a=1;a<=b;a++)e.push(a,a+1,0);this.setIndex(e),this.setAttribute("position",new eO(f,3)),this.setAttribute("normal",new eO(g,3)),this.setAttribute("uv",new eO(h,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hm(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class hn extends eW{constructor(a=1,b=1,c=1,d=32,e=1,f=!1,g=0,h=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};let i=this;d=Math.floor(d),e=Math.floor(e);let j=[],k=[],l=[],m=[],n=0,o=[],p=c/2,q=0;function r(c){let e=n,f=new cM,o=new dg,r=0,s=!0===c?a:b,t=!0===c?1:-1;for(let a=1;a<=d;a++)k.push(0,p*t,0),l.push(0,t,0),m.push(.5,.5),n++;let u=n;for(let a=0;a<=d;a++){let b=a/d*h+g,c=Math.cos(b),e=Math.sin(b);o.x=s*e,o.y=p*t,o.z=s*c,k.push(o.x,o.y,o.z),l.push(0,t,0),f.x=.5*c+.5,f.y=.5*e*t+.5,m.push(f.x,f.y),n++}for(let a=0;a<d;a++){let b=e+a,d=u+a;!0===c?j.push(d,d+1,b):j.push(d+1,d,b),r+=3}i.addGroup(q,r,!0===c?1:2),q+=r}(function(){let f=new dg,r=new dg,s=0,t=(b-a)/c;for(let i=0;i<=e;i++){let j=[],q=i/e,s=q*(b-a)+a;for(let a=0;a<=d;a++){let b=a/d,e=b*h+g,i=Math.sin(e),o=Math.cos(e);r.x=s*i,r.y=-q*c+p,r.z=s*o,k.push(r.x,r.y,r.z),f.set(i,t,o).normalize(),l.push(f.x,f.y,f.z),m.push(b,1-q),j.push(n++)}o.push(j)}for(let c=0;c<d;c++)for(let d=0;d<e;d++){let f=o[d][c],g=o[d+1][c],h=o[d+1][c+1],i=o[d][c+1];(a>0||0!==d)&&(j.push(f,g,i),s+=3),(b>0||d!==e-1)&&(j.push(g,h,i),s+=3)}i.addGroup(q,s,0),q+=s})(),!1===f&&(a>0&&r(!0),b>0&&r(!1)),this.setIndex(j),this.setAttribute("position",new eO(k,3)),this.setAttribute("normal",new eO(l,3)),this.setAttribute("uv",new eO(m,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hn(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class ho extends hn{constructor(a=1,b=1,c=32,d=1,e=!1,f=0,g=2*Math.PI){super(0,a,b,c,d,e,f,g),this.type="ConeGeometry",this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}static fromJSON(a){return new ho(a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class hp extends eW{constructor(a=[],b=[],c=1,d=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:a,indices:b,radius:c,detail:d};let e=[],f=[];function g(a){e.push(a.x,a.y,a.z)}function h(b,c){let d=3*b;c.x=a[d+0],c.y=a[d+1],c.z=a[d+2]}function i(a,b,c,d){d<0&&1===a.x&&(f[b]=a.x-1),0===c.x&&0===c.z&&(f[b]=d/2/Math.PI+.5)}function j(a){return Math.atan2(a.z,-a.x)}(function(a){let c=new dg,d=new dg,e=new dg;for(let f=0;f<b.length;f+=3)h(b[f+0],c),h(b[f+1],d),h(b[f+2],e),function(a,b,c,d){let e=d+1,f=[];for(let d=0;d<=e;d++){f[d]=[];let g=a.clone().lerp(c,d/e),h=b.clone().lerp(c,d/e),i=e-d;for(let a=0;a<=i;a++)0===a&&d===e?f[d][a]=g:f[d][a]=g.clone().lerp(h,a/i)}for(let a=0;a<e;a++)for(let b=0;b<2*(e-a)-1;b++){let c=Math.floor(b/2);b%2==0?(g(f[a][c+1]),g(f[a+1][c]),g(f[a][c])):(g(f[a][c+1]),g(f[a+1][c+1]),g(f[a+1][c]))}}(c,d,e,a)})(d),function(a){let b=new dg;for(let c=0;c<e.length;c+=3)b.x=e[c+0],b.y=e[c+1],b.z=e[c+2],b.normalize().multiplyScalar(a),e[c+0]=b.x,e[c+1]=b.y,e[c+2]=b.z}(c),function(){let a=new dg;for(let c=0;c<e.length;c+=3){var b;a.x=e[c+0],a.y=e[c+1],a.z=e[c+2];let d=j(a)/2/Math.PI+.5,g=Math.atan2(-(b=a).y,Math.sqrt(b.x*b.x+b.z*b.z))/Math.PI+.5;f.push(d,1-g)}(function(){let a=new dg,b=new dg,c=new dg,d=new dg,g=new cM,h=new cM,k=new cM;for(let l=0,m=0;l<e.length;l+=9,m+=6){a.set(e[l+0],e[l+1],e[l+2]),b.set(e[l+3],e[l+4],e[l+5]),c.set(e[l+6],e[l+7],e[l+8]),g.set(f[m+0],f[m+1]),h.set(f[m+2],f[m+3]),k.set(f[m+4],f[m+5]),d.copy(a).add(b).add(c).divideScalar(3);let n=j(d);i(g,m+0,a,n),i(h,m+2,b,n),i(k,m+4,c,n)}})(),function(){for(let a=0;a<f.length;a+=6){let b=f[a+0],c=f[a+2],d=f[a+4],e=Math.max(b,c,d),g=Math.min(b,c,d);e>.9&&g<.1&&(b<.2&&(f[a+0]+=1),c<.2&&(f[a+2]+=1),d<.2&&(f[a+4]+=1))}}()}(),this.setAttribute("position",new eO(e,3)),this.setAttribute("normal",new eO(e.slice(),3)),this.setAttribute("uv",new eO(f,2)),0===d?this.computeVertexNormals():this.normalizeNormals()}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hp(a.vertices,a.indices,a.radius,a.details)}}class hq extends hp{constructor(a=1,b=0){let c=(1+Math.sqrt(5))/2,d=1/c;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b),this.type="DodecahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new hq(a.radius,a.detail)}}let hr=new dg,hs=new dg,ht=new dg,hu=new eo;class hv extends eW{constructor(a=null,b=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:a,thresholdAngle:b},null!==a){let c=Math.cos(cD*b),d=a.getIndex(),e=a.getAttribute("position"),f=d?d.count:e.count,g=[0,0,0],h=["a","b","c"],i=[,,,],j={},k=[];for(let a=0;a<f;a+=3){d?(g[0]=d.getX(a),g[1]=d.getX(a+1),g[2]=d.getX(a+2)):(g[0]=a,g[1]=a+1,g[2]=a+2);let{a:b,b:f,c:l}=hu;if(b.fromBufferAttribute(e,g[0]),f.fromBufferAttribute(e,g[1]),l.fromBufferAttribute(e,g[2]),hu.getNormal(ht),i[0]=`${Math.round(1e4*b.x)},${Math.round(1e4*b.y)},${Math.round(1e4*b.z)}`,i[1]=`${Math.round(1e4*f.x)},${Math.round(1e4*f.y)},${Math.round(1e4*f.z)}`,i[2]=`${Math.round(1e4*l.x)},${Math.round(1e4*l.y)},${Math.round(1e4*l.z)}`,i[0]!==i[1]&&i[1]!==i[2]&&i[2]!==i[0])for(let a=0;a<3;a++){let b=(a+1)%3,d=i[a],e=i[b],f=hu[h[a]],l=hu[h[b]],m=`${d}_${e}`,n=`${e}_${d}`;n in j&&j[n]?(ht.dot(j[n].normal)<=c&&(k.push(f.x,f.y,f.z),k.push(l.x,l.y,l.z)),j[n]=null):m in j||(j[m]={index0:g[a],index1:g[b],normal:ht.clone()})}}for(let a in j)if(j[a]){let{index0:b,index1:c}=j[a];hr.fromBufferAttribute(e,b),hs.fromBufferAttribute(e,c),k.push(hr.x,hr.y,hr.z),k.push(hs.x,hs.y,hs.z)}this.setAttribute("position",new eO(k,3))}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}}class hw extends hj{constructor(a){super(a),this.uuid=cF(),this.type="Shape",this.holes=[]}getPointsHoles(a){let b=[];for(let c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a),this.holes=[];for(let b=0,c=a.holes.length;b<c;b++){let c=a.holes[b];this.holes.push(c.clone())}return this}toJSON(){let a=super.toJSON();a.uuid=this.uuid,a.holes=[];for(let b=0,c=this.holes.length;b<c;b++){let c=this.holes[b];a.holes.push(c.toJSON())}return a}fromJSON(a){super.fromJSON(a),this.uuid=a.uuid,this.holes=[];for(let b=0,c=a.holes.length;b<c;b++){let c=a.holes[b];this.holes.push(new hj().fromJSON(c))}return this}}let hx={triangulate:function(a,b,c=2){let d,e,f,g,h,i,j,k=b&&b.length,l=k?b[0]*c:a.length,m=hy(a,0,l,c,!0),n=[];if(!m||m.next===m.prev)return n;if(k&&(m=function(a,b,c,d){let e,f,g,h,i,j=[];for(e=0,f=b.length;e<f;e++)g=b[e]*d,h=e<f-1?b[e+1]*d:a.length,(i=hy(a,g,h,d,!1))===i.next&&(i.steiner=!0),j.push(function(a){let b=a,c=a;do(b.x<c.x||b.x===c.x&&b.y<c.y)&&(c=b),b=b.next;while(b!==a);return c}(i));for(j.sort(hA),e=0;e<j.length;e++)c=function(a,b){let c=function(a,b){let c=b,d=-1/0,e,f=a.x,g=a.y;do{if(g<=c.y&&g>=c.next.y&&c.next.y!==c.y){let a=c.x+(g-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(a<=f&&a>d&&(d=a,e=c.x<c.next.x?c:c.next,a===f))return e}c=c.next}while(c!==b);if(!e)return null;let h=e,i=e.x,j=e.y,k=1/0,l;c=e;do{var m,n;f>=c.x&&c.x>=i&&f!==c.x&&hC(g<j?f:d,g,i,j,g<j?d:f,g,c.x,c.y)&&(l=Math.abs(g-c.y)/(f-c.x),hI(c,a)&&(l<k||l===k&&(c.x>e.x||c.x===e.x&&(m=e,n=c,0>hD(m.prev,m,n.prev)&&0>hD(n.next,m,m.next))))&&(e=c,k=l)),c=c.next}while(c!==h);return e}(a,b);if(!c)return b;let d=hJ(c,a);return hz(d,d.next),hz(c,c.next)}(j[e],c);return c}(a,b,m,c)),a.length>80*c){d=f=a[0],e=g=a[1];for(let b=c;b<l;b+=c)h=a[b],i=a[b+1],h<d&&(d=h),i<e&&(e=i),h>f&&(f=h),i>g&&(g=i);j=0!==(j=Math.max(f-d,g-e))?32767/j:0}return function a(b,c,d,e,f,g,h){if(!b)return;!h&&g&&function(a,b,c,d){let e=a;do 0===e.z&&(e.z=hB(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next;while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,function(a){let b,c,d,e,f,g,h,i,j=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<j&&(h++,d=d.nextZ);b++);for(i=j;h>0||i>0&&d;)0!==h&&(0===i||!d||c.z<=d.z)?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,i--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,j*=2}while(g>1)}(e)}(b,e,f,g);let i=b,j,k;for(;b.prev!==b.next;){if(j=b.prev,k=b.next,g?function(a,b,c,d){let e=a.prev,f=a.next;if(hD(e,a,f)>=0)return!1;let g=e.x,h=a.x,i=f.x,j=e.y,k=a.y,l=f.y,m=g<h?g<i?g:i:h<i?h:i,n=j<k?j<l?j:l:k<l?k:l,o=g>h?g>i?g:i:h>i?h:i,p=j>k?j>l?j:l:k>l?k:l,q=hB(m,n,b,c,d),r=hB(o,p,b,c,d),s=a.prevZ,t=a.nextZ;for(;s&&s.z>=q&&t&&t.z<=r;){if(s.x>=m&&s.x<=o&&s.y>=n&&s.y<=p&&s!==e&&s!==f&&hC(g,j,h,k,i,l,s.x,s.y)&&hD(s.prev,s,s.next)>=0||(s=s.prevZ,t.x>=m&&t.x<=o&&t.y>=n&&t.y<=p&&t!==e&&t!==f&&hC(g,j,h,k,i,l,t.x,t.y)&&hD(t.prev,t,t.next)>=0))return!1;t=t.nextZ}for(;s&&s.z>=q;){if(s.x>=m&&s.x<=o&&s.y>=n&&s.y<=p&&s!==e&&s!==f&&hC(g,j,h,k,i,l,s.x,s.y)&&hD(s.prev,s,s.next)>=0)return!1;s=s.prevZ}for(;t&&t.z<=r;){if(t.x>=m&&t.x<=o&&t.y>=n&&t.y<=p&&t!==e&&t!==f&&hC(g,j,h,k,i,l,t.x,t.y)&&hD(t.prev,t,t.next)>=0)return!1;t=t.nextZ}return!0}(b,e,f,g):function(a){let b=a.prev,c=a.next;if(hD(b,a,c)>=0)return!1;let d=b.x,e=a.x,f=c.x,g=b.y,h=a.y,i=c.y,j=d<e?d<f?d:f:e<f?e:f,k=g<h?g<i?g:i:h<i?h:i,l=d>e?d>f?d:f:e>f?e:f,m=g>h?g>i?g:i:h>i?h:i,n=c.next;for(;n!==b;){if(n.x>=j&&n.x<=l&&n.y>=k&&n.y<=m&&hC(d,g,e,h,f,i,n.x,n.y)&&hD(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}(b)){c.push(j.i/d|0),c.push(b.i/d|0),c.push(k.i/d|0),hL(b),b=k.next,i=k.next;continue}if((b=k)===i){h?1===h?a(b=function(a,b,c){let d=a;do{let e=d.prev,f=d.next.next;!hE(e,f)&&hF(e,d,d.next,f)&&hI(e,f)&&hI(f,e)&&(b.push(e.i/c|0),b.push(d.i/c|0),b.push(f.i/c|0),hL(d),hL(d.next),d=a=f),d=d.next}while(d!==a);return hz(d)}(hz(b),c,d),c,d,e,f,g,2):2===h&&function(b,c,d,e,f,g){let h=b;do{let b=h.next.next;for(;b!==h.prev;){var i,j;if(h.i!==b.i&&(i=h,j=b,i.next.i!==j.i&&i.prev.i!==j.i&&!function(a,b){let c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&hF(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}(i,j)&&(hI(i,j)&&hI(j,i)&&function(a,b){let c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do c.y>f!=c.next.y>f&&c.next.y!==c.y&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next;while(c!==a);return d}(i,j)&&(hD(i.prev,i,j.prev)||hD(i,j.prev,j))||hE(i,j)&&hD(i.prev,i,i.next)>0&&hD(j.prev,j,j.next)>0))){let i=hJ(h,b);h=hz(h,h.next),i=hz(i,i.next),a(h,c,d,e,f,g,0),a(i,c,d,e,f,g,0);return}b=b.next}h=h.next}while(h!==b)}(b,c,d,e,f,g):a(hz(b),c,d,e,f,g,1);break}}}(m,n,c,d,e,j,0),n}};function hy(a,b,c,d,e){let f,g;if(e===function(a,b,c,d){let e=0;for(let f=b,g=c-d;f<c;f+=d)e+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;return e}(a,b,c,d)>0)for(f=b;f<c;f+=d)g=hK(f,a[f],a[f+1],g);else for(f=c-d;f>=b;f-=d)g=hK(f,a[f],a[f+1],g);return g&&hE(g,g.next)&&(hL(g),g=g.next),g}function hz(a,b){if(!a)return a;b||(b=a);let c=a,d;do if(d=!1,!c.steiner&&(hE(c,c.next)||0===hD(c.prev,c,c.next))){if(hL(c),(c=b=c.prev)===c.next)break;d=!0}else c=c.next;while(d||c!==b);return b}function hA(a,b){return a.x-b.x}function hB(a,b,c,d,e){return(a=((a=((a=((a=((a=(a-c)*e|0)|a<<8)&0xff00ff)|a<<4)&0xf0f0f0f)|a<<2)&0x33333333)|a<<1)&0x55555555)|(b=((b=((b=((b=((b=(b-d)*e|0)|b<<8)&0xff00ff)|b<<4)&0xf0f0f0f)|b<<2)&0x33333333)|b<<1)&0x55555555)<<1}function hC(a,b,c,d,e,f,g,h){return(e-g)*(b-h)>=(a-g)*(f-h)&&(a-g)*(d-h)>=(c-g)*(b-h)&&(c-g)*(f-h)>=(e-g)*(d-h)}function hD(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function hE(a,b){return a.x===b.x&&a.y===b.y}function hF(a,b,c,d){let e=hH(hD(a,b,c)),f=hH(hD(a,b,d)),g=hH(hD(c,d,a)),h=hH(hD(c,d,b));return!!(e!==f&&g!==h||0===e&&hG(a,c,b)||0===f&&hG(a,d,b)||0===g&&hG(c,a,d)||0===h&&hG(c,b,d))}function hG(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function hH(a){return a>0?1:a<0?-1:0}function hI(a,b){return 0>hD(a.prev,a,a.next)?hD(a,b,a.next)>=0&&hD(a,a.prev,b)>=0:0>hD(a,b,a.prev)||0>hD(a,a.next,b)}function hJ(a,b){let c=new hM(a.i,a.x,a.y),d=new hM(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function hK(a,b,c,d){let e=new hM(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function hL(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function hM(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class hN{static area(a){let b=a.length,c=0;for(let d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return .5*c}static isClockWise(a){return 0>hN.area(a)}static triangulateShape(a,b){let c=[],d=[],e=[];hO(a),hP(c,a);let f=a.length;b.forEach(hO);for(let a=0;a<b.length;a++)d.push(f),f+=b[a].length,hP(c,b[a]);let g=hx.triangulate(c,d);for(let a=0;a<g.length;a+=3)e.push(g.slice(a,a+3));return e}}function hO(a){let b=a.length;b>2&&a[b-1].equals(a[0])&&a.pop()}function hP(a,b){for(let c=0;c<b.length;c++)a.push(b[c].x),a.push(b[c].y)}class hQ extends eW{constructor(a=new hw([new cM(.5,.5),new cM(-.5,.5),new cM(-.5,-.5),new cM(.5,-.5)]),b={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:a,options:b},a=Array.isArray(a)?a:[a];let c=this,d=[],e=[];for(let f=0,g=a.length;f<g;f++)!function(a){let f,g,h,i,j=[],k=void 0!==b.curveSegments?b.curveSegments:12,l=void 0!==b.steps?b.steps:1,m=void 0!==b.depth?b.depth:1,n=void 0===b.bevelEnabled||b.bevelEnabled,o=void 0!==b.bevelThickness?b.bevelThickness:.2,p=void 0!==b.bevelSize?b.bevelSize:o-.1,q=void 0!==b.bevelOffset?b.bevelOffset:0,r=void 0!==b.bevelSegments?b.bevelSegments:3,s=b.extrudePath,t=void 0!==b.UVGenerator?b.UVGenerator:hR,u,v=!1;s&&(u=s.getSpacedPoints(l),v=!0,n=!1,f=s.computeFrenetFrames(l,!1),g=new dg,h=new dg,i=new dg),n||(r=0,o=0,p=0,q=0);let w=a.extractPoints(k),x=w.shape,y=w.holes;if(!hN.isClockWise(x)){x=x.reverse();for(let a=0,b=y.length;a<b;a++){let b=y[a];hN.isClockWise(b)&&(y[a]=b.reverse())}}let z=hN.triangulateShape(x,y),A=x;for(let a=0,b=y.length;a<b;a++){let b=y[a];x=x.concat(b)}function B(a,b,c){return b||console.error("THREE.ExtrudeGeometry: vec does not exist"),a.clone().addScaledVector(b,c)}let C=x.length,D=z.length;function E(a,b,c){let d,e,f,g=a.x-b.x,h=a.y-b.y,i=c.x-a.x,j=c.y-a.y,k=g*g+h*h;if(Math.abs(g*j-h*i)>Number.EPSILON){let l=Math.sqrt(k),m=Math.sqrt(i*i+j*j),n=b.x-h/l,o=b.y+g/l,p=((c.x-j/m-n)*j-(c.y+i/m-o)*i)/(g*j-h*i),q=(d=n+g*p-a.x)*d+(e=o+h*p-a.y)*e;if(q<=2)return new cM(d,e);f=Math.sqrt(q/2)}else{let a=!1;g>Number.EPSILON?i>Number.EPSILON&&(a=!0):g<-Number.EPSILON?i<-Number.EPSILON&&(a=!0):Math.sign(h)===Math.sign(j)&&(a=!0),a?(d=-h,e=g,f=Math.sqrt(k)):(d=g,e=h,f=Math.sqrt(k/2))}return new cM(d/f,e/f)}let F=[];for(let a=0,b=A.length,c=b-1,d=a+1;a<b;a++,c++,d++)c===b&&(c=0),d===b&&(d=0),F[a]=E(A[a],A[c],A[d]);let G=[],H,I=F.concat();for(let a=0,b=y.length;a<b;a++){let b=y[a];H=[];for(let a=0,c=b.length,d=c-1,e=a+1;a<c;a++,d++,e++)d===c&&(d=0),e===c&&(e=0),H[a]=E(b[a],b[d],b[e]);G.push(H),I=I.concat(H)}for(let a=0;a<r;a++){let b=a/r,c=o*Math.cos(b*Math.PI/2),d=p*Math.sin(b*Math.PI/2)+q;for(let a=0,b=A.length;a<b;a++){let b=B(A[a],F[a],d);L(b.x,b.y,-c)}for(let a=0,b=y.length;a<b;a++){let b=y[a];H=G[a];for(let a=0,e=b.length;a<e;a++){let e=B(b[a],H[a],d);L(e.x,e.y,-c)}}}let J=p+q;for(let a=0;a<C;a++){let b=n?B(x[a],I[a],J):x[a];v?(h.copy(f.normals[0]).multiplyScalar(b.x),g.copy(f.binormals[0]).multiplyScalar(b.y),i.copy(u[0]).add(h).add(g),L(i.x,i.y,i.z)):L(b.x,b.y,0)}for(let a=1;a<=l;a++)for(let b=0;b<C;b++){let c=n?B(x[b],I[b],J):x[b];v?(h.copy(f.normals[a]).multiplyScalar(c.x),g.copy(f.binormals[a]).multiplyScalar(c.y),i.copy(u[a]).add(h).add(g),L(i.x,i.y,i.z)):L(c.x,c.y,m/l*a)}for(let a=r-1;a>=0;a--){let b=a/r,c=o*Math.cos(b*Math.PI/2),d=p*Math.sin(b*Math.PI/2)+q;for(let a=0,b=A.length;a<b;a++){let b=B(A[a],F[a],d);L(b.x,b.y,m+c)}for(let a=0,b=y.length;a<b;a++){let b=y[a];H=G[a];for(let a=0,e=b.length;a<e;a++){let e=B(b[a],H[a],d);v?L(e.x,e.y+u[l-1].y,u[l-1].x+c):L(e.x,e.y,m+c)}}}function K(a,b){let e=a.length;for(;--e>=0;){let f=e,g=e-1;g<0&&(g=a.length-1);for(let a=0,e=l+2*r;a<e;a++){let e=C*a,h=C*(a+1);!function(a,b,e,f){N(a),N(b),N(f),N(b),N(e),N(f);let g=d.length/3,h=t.generateSideWallUV(c,d,g-6,g-3,g-2,g-1);O(h[0]),O(h[1]),O(h[3]),O(h[1]),O(h[2]),O(h[3])}(b+f+e,b+g+e,b+g+h,b+f+h)}}}function L(a,b,c){j.push(a),j.push(b),j.push(c)}function M(a,b,e){N(a),N(b),N(e);let f=d.length/3,g=t.generateTopUV(c,d,f-3,f-2,f-1);O(g[0]),O(g[1]),O(g[2])}function N(a){d.push(j[3*a+0]),d.push(j[3*a+1]),d.push(j[3*a+2])}function O(a){e.push(a.x),e.push(a.y)}(function(){let a=d.length/3;if(n){let a=0*C;for(let b=0;b<D;b++){let c=z[b];M(c[2]+a,c[1]+a,c[0]+a)}a=C*(l+2*r);for(let b=0;b<D;b++){let c=z[b];M(c[0]+a,c[1]+a,c[2]+a)}}else{for(let a=0;a<D;a++){let b=z[a];M(b[2],b[1],b[0])}for(let a=0;a<D;a++){let b=z[a];M(b[0]+C*l,b[1]+C*l,b[2]+C*l)}}c.addGroup(a,d.length/3-a,0)})(),function(){let a=d.length/3,b=0;K(A,0),b+=A.length;for(let a=0,c=y.length;a<c;a++){let c=y[a];K(c,b),b+=c.length}c.addGroup(a,d.length/3-a,1)}()}(a[f]);this.setAttribute("position",new eO(d,3)),this.setAttribute("uv",new eO(e,2)),this.computeVertexNormals()}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){let a=super.toJSON();return function(a,b,c){if(c.shapes=[],Array.isArray(a))for(let b=0,d=a.length;b<d;b++){let d=a[b];c.shapes.push(d.uuid)}else c.shapes.push(a.uuid);return c.options=Object.assign({},b),void 0!==b.extrudePath&&(c.options.extrudePath=b.extrudePath.toJSON()),c}(this.parameters.shapes,this.parameters.options,a)}static fromJSON(a,b){let c=[];for(let d=0,e=a.shapes.length;d<e;d++){let e=b[a.shapes[d]];c.push(e)}let d=a.options.extrudePath;return void 0!==d&&(a.options.extrudePath=new hh[d.type]().fromJSON(d)),new hQ(c,a.options)}}let hR={generateTopUV:function(a,b,c,d,e){let f=b[3*c],g=b[3*c+1],h=b[3*d],i=b[3*d+1],j=b[3*e],k=b[3*e+1];return[new cM(f,g),new cM(h,i),new cM(j,k)]},generateSideWallUV:function(a,b,c,d,e,f){let g=b[3*c],h=b[3*c+1],i=b[3*c+2],j=b[3*d],k=b[3*d+1],l=b[3*d+2],m=b[3*e],n=b[3*e+1],o=b[3*e+2],p=b[3*f],q=b[3*f+1],r=b[3*f+2];return Math.abs(h-k)<Math.abs(g-j)?[new cM(g,1-i),new cM(j,1-l),new cM(m,1-o),new cM(p,1-r)]:[new cM(h,1-i),new cM(k,1-l),new cM(n,1-o),new cM(q,1-r)]}};class hS extends hp{constructor(a=1,b=0){let c=(1+Math.sqrt(5))/2;super([-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b),this.type="IcosahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new hS(a.radius,a.detail)}}class hT extends hp{constructor(a=1,b=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b),this.type="OctahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new hT(a.radius,a.detail)}}class hU extends eW{constructor(a=1,b=1,c=1,d=1){super(),this.type="PlaneGeometry",this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};let e=a/2,f=b/2,g=Math.floor(c),h=Math.floor(d),i=g+1,j=h+1,k=a/g,l=b/h,m=[],n=[],o=[],p=[];for(let a=0;a<j;a++){let b=a*l-f;for(let c=0;c<i;c++){let d=c*k-e;n.push(d,-b,0),o.push(0,0,1),p.push(c/g),p.push(1-a/h)}}for(let a=0;a<h;a++)for(let b=0;b<g;b++){let c=b+i*a,d=b+i*(a+1),e=b+1+i*(a+1),f=b+1+i*a;m.push(c,d,f),m.push(d,e,f)}this.setIndex(m),this.setAttribute("position",new eO(n,3)),this.setAttribute("normal",new eO(o,3)),this.setAttribute("uv",new eO(p,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hU(a.width,a.height,a.widthSegments,a.heightSegments)}}class hV extends eW{constructor(a=.5,b=1,c=32,d=1,e=0,f=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f},c=Math.max(3,c);let g=[],h=[],i=[],j=[],k=a,l=(b-a)/(d=Math.max(1,d)),m=new dg,n=new cM;for(let a=0;a<=d;a++){for(let a=0;a<=c;a++){let d=e+a/c*f;m.x=k*Math.cos(d),m.y=k*Math.sin(d),h.push(m.x,m.y,m.z),i.push(0,0,1),n.x=(m.x/b+1)/2,n.y=(m.y/b+1)/2,j.push(n.x,n.y)}k+=l}for(let a=0;a<d;a++){let b=a*(c+1);for(let a=0;a<c;a++){let d=a+b,e=d+c+1,f=d+c+2,h=d+1;g.push(d,e,h),g.push(e,f,h)}}this.setIndex(g),this.setAttribute("position",new eO(h,3)),this.setAttribute("normal",new eO(i,3)),this.setAttribute("uv",new eO(j,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hV(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)}}class hW extends eW{constructor(a=new hw([new cM(0,.5),new cM(-.5,-.5),new cM(.5,-.5)]),b=12){super(),this.type="ShapeGeometry",this.parameters={shapes:a,curveSegments:b};let c=[],d=[],e=[],f=[],g=0,h=0;if(!1===Array.isArray(a))i(a);else for(let b=0;b<a.length;b++)i(a[b]),this.addGroup(g,h,b),g+=h,h=0;function i(a){let g=d.length/3,i=a.extractPoints(b),j=i.shape,k=i.holes;!1===hN.isClockWise(j)&&(j=j.reverse());for(let a=0,b=k.length;a<b;a++){let b=k[a];!0===hN.isClockWise(b)&&(k[a]=b.reverse())}let l=hN.triangulateShape(j,k);for(let a=0,b=k.length;a<b;a++){let b=k[a];j=j.concat(b)}for(let a=0,b=j.length;a<b;a++){let b=j[a];d.push(b.x,b.y,0),e.push(0,0,1),f.push(b.x,b.y)}for(let a=0,b=l.length;a<b;a++){let b=l[a],d=b[0]+g,e=b[1]+g,f=b[2]+g;c.push(d,e,f),h+=3}}this.setIndex(c),this.setAttribute("position",new eO(d,3)),this.setAttribute("normal",new eO(e,3)),this.setAttribute("uv",new eO(f,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){let a=super.toJSON();return function(a,b){if(b.shapes=[],Array.isArray(a))for(let c=0,d=a.length;c<d;c++){let d=a[c];b.shapes.push(d.uuid)}else b.shapes.push(a.uuid);return b}(this.parameters.shapes,a)}static fromJSON(a,b){let c=[];for(let d=0,e=a.shapes.length;d<e;d++){let e=b[a.shapes[d]];c.push(e)}return new hW(c,a.curveSegments)}}class hX extends eW{constructor(a=1,b=32,c=16,d=0,e=2*Math.PI,f=0,g=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g},b=Math.max(3,Math.floor(b)),c=Math.max(2,Math.floor(c));let h=Math.min(f+g,Math.PI),i=0,j=[],k=new dg,l=new dg,m=[],n=[],o=[],p=[];for(let m=0;m<=c;m++){let q=[],r=m/c,s=0;0===m&&0===f?s=.5/b:m===c&&h===Math.PI&&(s=-.5/b);for(let c=0;c<=b;c++){let h=c/b;k.x=-a*Math.cos(d+h*e)*Math.sin(f+r*g),k.y=a*Math.cos(f+r*g),k.z=a*Math.sin(d+h*e)*Math.sin(f+r*g),n.push(k.x,k.y,k.z),l.copy(k).normalize(),o.push(l.x,l.y,l.z),p.push(h+s,1-r),q.push(i++)}j.push(q)}for(let a=0;a<c;a++)for(let d=0;d<b;d++){let b=j[a][d+1],e=j[a][d],g=j[a+1][d],i=j[a+1][d+1];(0!==a||f>0)&&m.push(b,e,i),(a!==c-1||h<Math.PI)&&m.push(e,g,i)}this.setIndex(m),this.setAttribute("position",new eO(n,3)),this.setAttribute("normal",new eO(o,3)),this.setAttribute("uv",new eO(p,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hX(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class hY extends hp{constructor(a=1,b=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b),this.type="TetrahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new hY(a.radius,a.detail)}}class hZ extends eW{constructor(a=1,b=.4,c=12,d=48,e=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e},c=Math.floor(c),d=Math.floor(d);let f=[],g=[],h=[],i=[],j=new dg,k=new dg,l=new dg;for(let f=0;f<=c;f++)for(let m=0;m<=d;m++){let n=m/d*e,o=f/c*Math.PI*2;k.x=(a+b*Math.cos(o))*Math.cos(n),k.y=(a+b*Math.cos(o))*Math.sin(n),k.z=b*Math.sin(o),g.push(k.x,k.y,k.z),j.x=a*Math.cos(n),j.y=a*Math.sin(n),l.subVectors(k,j).normalize(),h.push(l.x,l.y,l.z),i.push(m/d),i.push(f/c)}for(let a=1;a<=c;a++)for(let b=1;b<=d;b++){let c=(d+1)*a+b-1,e=(d+1)*(a-1)+b-1,g=(d+1)*(a-1)+b,h=(d+1)*a+b;f.push(c,e,h),f.push(e,g,h)}this.setIndex(f),this.setAttribute("position",new eO(g,3)),this.setAttribute("normal",new eO(h,3)),this.setAttribute("uv",new eO(i,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hZ(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc)}}class h$ extends eW{constructor(a=1,b=.4,c=64,d=8,e=2,f=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f},c=Math.floor(c),d=Math.floor(d);let g=[],h=[],i=[],j=[],k=new dg,l=new dg,m=new dg,n=new dg,o=new dg,p=new dg,q=new dg;for(let g=0;g<=c;++g){let s=g/c*e*Math.PI*2;r(s,e,f,a,m),r(s+.01,e,f,a,n),p.subVectors(n,m),q.addVectors(n,m),o.crossVectors(p,q),q.crossVectors(o,p),o.normalize(),q.normalize();for(let a=0;a<=d;++a){let e=a/d*Math.PI*2,f=-b*Math.cos(e),n=b*Math.sin(e);k.x=m.x+(f*q.x+n*o.x),k.y=m.y+(f*q.y+n*o.y),k.z=m.z+(f*q.z+n*o.z),h.push(k.x,k.y,k.z),l.subVectors(k,m).normalize(),i.push(l.x,l.y,l.z),j.push(g/c),j.push(a/d)}}for(let a=1;a<=c;a++)for(let b=1;b<=d;b++){let c=(d+1)*(a-1)+(b-1),e=(d+1)*a+(b-1),f=(d+1)*a+b,h=(d+1)*(a-1)+b;g.push(c,e,h),g.push(e,f,h)}function r(a,b,c,d,e){let f=Math.cos(a),g=Math.sin(a),h=c/b*a,i=Math.cos(h);e.x=d*(2+i)*.5*f,e.y=d*(2+i)*g*.5,e.z=d*Math.sin(h)*.5}this.setIndex(g),this.setAttribute("position",new eO(h,3)),this.setAttribute("normal",new eO(i,3)),this.setAttribute("uv",new eO(j,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new h$(a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q)}}class h_ extends eW{constructor(a=new hf(new dg(-1,-1,0),new dg(-1,1,0),new dg(1,1,0)),b=64,c=1,d=8,e=!1){super(),this.type="TubeGeometry",this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};let f=a.computeFrenetFrames(b,e);this.tangents=f.tangents,this.normals=f.normals,this.binormals=f.binormals;let g=new dg,h=new dg,i=new cM,j=new dg,k=[],l=[],m=[],n=[];function o(e){j=a.getPointAt(e/b,j);let i=f.normals[e],m=f.binormals[e];for(let a=0;a<=d;a++){let b=a/d*Math.PI*2,e=Math.sin(b),f=-Math.cos(b);h.x=f*i.x+e*m.x,h.y=f*i.y+e*m.y,h.z=f*i.z+e*m.z,h.normalize(),l.push(h.x,h.y,h.z),g.x=j.x+c*h.x,g.y=j.y+c*h.y,g.z=j.z+c*h.z,k.push(g.x,g.y,g.z)}}(function(){for(let a=0;a<b;a++)o(a);o(!1===e?b:0),function(){for(let a=0;a<=b;a++)for(let c=0;c<=d;c++)i.x=a/b,i.y=c/d,m.push(i.x,i.y)}(),function(){for(let a=1;a<=b;a++)for(let b=1;b<=d;b++){let c=(d+1)*(a-1)+(b-1),e=(d+1)*a+(b-1),f=(d+1)*a+b,g=(d+1)*(a-1)+b;n.push(c,e,g),n.push(e,f,g)}}()})(),this.setIndex(n),this.setAttribute("position",new eO(k,3)),this.setAttribute("normal",new eO(l,3)),this.setAttribute("uv",new eO(m,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){let a=super.toJSON();return a.path=this.parameters.path.toJSON(),a}static fromJSON(a){return new h_(new hh[a.path.type]().fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed)}}class h0 extends eW{constructor(a=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:a},null!==a){let b=[],c=new Set,d=new dg,e=new dg;if(null!==a.index){let f=a.attributes.position,g=a.index,h=a.groups;0===h.length&&(h=[{start:0,count:g.count,materialIndex:0}]);for(let a=0,i=h.length;a<i;++a){let i=h[a],j=i.start,k=i.count;for(let a=j,h=j+k;a<h;a+=3)for(let h=0;h<3;h++){let i=g.getX(a+h),j=g.getX(a+(h+1)%3);d.fromBufferAttribute(f,i),e.fromBufferAttribute(f,j),!0===h1(d,e,c)&&(b.push(d.x,d.y,d.z),b.push(e.x,e.y,e.z))}}}else{let f=a.attributes.position;for(let a=0,g=f.count/3;a<g;a++)for(let g=0;g<3;g++){let h=3*a+g,i=3*a+(g+1)%3;d.fromBufferAttribute(f,h),e.fromBufferAttribute(f,i),!0===h1(d,e,c)&&(b.push(d.x,d.y,d.z),b.push(e.x,e.y,e.z))}}this.setAttribute("position",new eO(b,3))}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}}function h1(a,b,c){let d=`${a.x},${a.y},${a.z}-${b.x},${b.y},${b.z}`,e=`${b.x},${b.y},${b.z}-${a.x},${a.y},${a.z}`;return!0!==c.has(d)&&!0!==c.has(e)&&(c.add(d),c.add(e),!0)}var h2=Object.freeze({__proto__:null,BoxGeometry:e8,CapsuleGeometry:hl,CircleGeometry:hm,ConeGeometry:ho,CylinderGeometry:hn,DodecahedronGeometry:hq,EdgesGeometry:hv,ExtrudeGeometry:hQ,IcosahedronGeometry:hS,LatheGeometry:hk,OctahedronGeometry:hT,PlaneGeometry:hU,PolyhedronGeometry:hp,RingGeometry:hV,ShapeGeometry:hW,SphereGeometry:hX,TetrahedronGeometry:hY,TorusGeometry:hZ,TorusKnotGeometry:h$,TubeGeometry:h_,WireframeGeometry:h0});class h3 extends ew{constructor(a){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new et(0),this.transparent=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.fog=a.fog,this}}class h4 extends fd{constructor(a){super(a),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class h5 extends ew{constructor(a){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new et(0xffffff),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new et(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bT,this.normalScale=new cM(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dV,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.envMapIntensity=a.envMapIntensity,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class h6 extends h5{constructor(a){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new cM(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return cG(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(a){this.ior=(1+.4*a)/(1-.4*a)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new et(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new et(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new et(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){this._anisotropy>0!=a>0&&this.version++,this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){this._clearcoat>0!=a>0&&this.version++,this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){this._iridescence>0!=a>0&&this.version++,this._iridescence=a}get dispersion(){return this._dispersion}set dispersion(a){this._dispersion>0!=a>0&&this.version++,this._dispersion=a}get sheen(){return this._sheen}set sheen(a){this._sheen>0!=a>0&&this.version++,this._sheen=a}get transmission(){return this._transmission}set transmission(a){this._transmission>0!=a>0&&this.version++,this._transmission=a}copy(a){return super.copy(a),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=a.anisotropy,this.anisotropyRotation=a.anisotropyRotation,this.anisotropyMap=a.anisotropyMap,this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.dispersion=a.dispersion,this.ior=a.ior,this.iridescence=a.iridescence,this.iridescenceMap=a.iridescenceMap,this.iridescenceIOR=a.iridescenceIOR,this.iridescenceThicknessRange=[...a.iridescenceThicknessRange],this.iridescenceThicknessMap=a.iridescenceThicknessMap,this.sheen=a.sheen,this.sheenColor.copy(a.sheenColor),this.sheenColorMap=a.sheenColorMap,this.sheenRoughness=a.sheenRoughness,this.sheenRoughnessMap=a.sheenRoughnessMap,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this.thickness=a.thickness,this.thicknessMap=a.thicknessMap,this.attenuationDistance=a.attenuationDistance,this.attenuationColor.copy(a.attenuationColor),this.specularIntensity=a.specularIntensity,this.specularIntensityMap=a.specularIntensityMap,this.specularColor.copy(a.specularColor),this.specularColorMap=a.specularColorMap,this}}class h7 extends ew{constructor(a){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new et(0xffffff),this.specular=new et(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new et(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bT,this.normalScale=new cM(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dV,this.combine=ac,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class h8 extends ew{constructor(a){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new et(0xffffff),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new et(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bT,this.normalScale=new cM(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}class h9 extends ew{constructor(a){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bT,this.normalScale=new cM(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(a)}copy(a){return super.copy(a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.flatShading=a.flatShading,this}}class ia extends ew{constructor(a){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new et(0xffffff),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new et(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bT,this.normalScale=new cM(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dV,this.combine=ac,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class ib extends ew{constructor(a){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=bP,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(a)}copy(a){return super.copy(a),this.depthPacking=a.depthPacking,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this}}class ic extends ew{constructor(a){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(a)}copy(a){return super.copy(a),this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this}}class id extends ew{constructor(a){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new et(0xffffff),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bT,this.normalScale=new cM(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.flatShading=a.flatShading,this.fog=a.fog,this}}class ie extends gx{constructor(a){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}copy(a){return super.copy(a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this}}function ig(a,b,c){return a&&(c||a.constructor!==b)?"number"==typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a):a}function ih(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function ii(a){let b=a.length,c=Array(b);for(let a=0;a!==b;++a)c[a]=a;return c.sort(function(b,c){return a[b]-a[c]}),c}function ij(a,b,c){let d=a.length,e=new a.constructor(d);for(let f=0,g=0;g!==d;++f){let d=c[f]*b;for(let c=0;c!==b;++c)e[g++]=a[d+c]}return e}function ik(a,b,c,d){let e=1,f=a[0];for(;void 0!==f&&void 0===f[d];)f=a[e++];if(void 0===f)return;let g=f[d];if(void 0!==g)if(Array.isArray(g))do void 0!==(g=f[d])&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f);else if(void 0!==g.toArray)do void 0!==(g=f[d])&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f);else do void 0!==(g=f[d])&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}let il={convertArray:ig,isTypedArray:ih,getKeyframeOrder:ii,sortedArray:ij,flattenJSON:ik,subclip:function(a,b,c,d,e=30){let f=a.clone();f.name=b;let g=[];for(let a=0;a<f.tracks.length;++a){let b=f.tracks[a],h=b.getValueSize(),i=[],j=[];for(let a=0;a<b.times.length;++a){let f=b.times[a]*e;if(!(f<c)&&!(f>=d)){i.push(b.times[a]);for(let c=0;c<h;++c)j.push(b.values[a*h+c])}}0!==i.length&&(b.times=ig(i,b.times.constructor),b.values=ig(j,b.values.constructor),g.push(b))}f.tracks=g;let h=1/0;for(let a=0;a<f.tracks.length;++a)h>f.tracks[a].times[0]&&(h=f.tracks[a].times[0]);for(let a=0;a<f.tracks.length;++a)f.tracks[a].shift(-1*h);return f.resetDuration(),f},makeClipAdditive:function(a,b=0,c=a,d=30){d<=0&&(d=30);let e=c.tracks.length,f=b/d;for(let b=0;b<e;++b){let d,e=c.tracks[b],g=e.ValueTypeName;if("bool"===g||"string"===g)continue;let h=a.tracks.find(function(a){return a.name===e.name&&a.ValueTypeName===g});if(void 0===h)continue;let i=0,j=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(i=j/3);let k=0,l=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(k=l/3);let m=e.times.length-1;if(f<=e.times[0]){let a=i,b=j-i;d=e.values.slice(a,b)}else if(f>=e.times[m]){let a=m*j+i,b=a+j-i;d=e.values.slice(a,b)}else{let a=e.createInterpolant(),b=i,c=j-i;a.evaluate(f),d=a.resultBuffer.slice(b,c)}"quaternion"===g&&new df().fromArray(d).normalize().conjugate().toArray(d);let n=h.times.length;for(let a=0;a<n;++a){let b=a*l+k;if("quaternion"===g)df.multiplyQuaternionsFlat(h.values,b,d,0,h.values,b);else{let a=l-2*k;for(let c=0;c<a;++c)h.values[b+c]-=d[c]}}}return a.blendMode=bL,a}};class im{constructor(a,b,c,d){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=void 0!==d?d:new b.constructor(c),this.sampleValues=b,this.valueSize=c,this.settings=null,this.DefaultSettings_={}}evaluate(a){let b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{let f;c:{d:if(!(a<d)){for(let f=c+2;;){if(void 0===d){if(a<e)break d;return c=b.length,this._cachedIndex=c,this.copySampleValue_(c-1)}if(c===f)break;if(e=d,a<(d=b[++c]))break b}f=b.length;break c}if(!(a>=e)){let g=b[1];a<g&&(c=2,e=g);for(let f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.copySampleValue_(0);if(c===f)break;if(d=e,a>=(e=b[--c-1]))break b}f=c,c=0;break c}break a}for(;c<f;){let d=c+f>>>1;a<b[d]?f=d:c=d+1}if(d=b[c],void 0===(e=b[c-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===d)return c=b.length,this._cachedIndex=c,this.copySampleValue_(c-1)}this._cachedIndex=c,this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){let b=this.resultBuffer,c=this.sampleValues,d=this.valueSize,e=a*d;for(let a=0;a!==d;++a)b[a]=c[e+a];return b}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}}class io extends im{constructor(a,b,c,d){super(a,b,c,d),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:bH,endingEnd:bH}}intervalChanged_(a,b,c){let d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case bI:e=a,g=2*b-c;break;case bJ:e=d.length-2,g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case bI:f=a,h=2*c-b;break;case bJ:f=1,h=c+d[1]-d[0];break;default:f=a-1,h=b}let i=(c-b)*.5,j=this.valueSize;this._weightPrev=i/(b-g),this._weightNext=i/(h-c),this._offsetPrev=e*j,this._offsetNext=f*j}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=a*g,i=h-g,j=this._offsetPrev,k=this._offsetNext,l=this._weightPrev,m=this._weightNext,n=(c-b)/(d-b),o=n*n,p=o*n,q=-l*p+2*l*o-l*n,r=(1+l)*p+(-1.5-2*l)*o+(-.5+l)*n+1,s=(-1-m)*p+(1.5+m)*o+.5*n,t=m*p-m*o;for(let a=0;a!==g;++a)e[a]=q*f[j+a]+r*f[i+a]+s*f[h+a]+t*f[k+a];return e}}class ip extends im{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=a*g,i=h-g,j=(c-b)/(d-b),k=1-j;for(let a=0;a!==g;++a)e[a]=f[i+a]*k+f[h+a]*j;return e}}class iq extends im{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a){return this.copySampleValue_(a-1)}}class ir{constructor(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=ig(b,this.TimeBufferType),this.values=ig(c,this.ValueBufferType),this.setInterpolation(d||this.DefaultInterpolation)}static toJSON(a){let b,c=a.constructor;if(c.toJSON!==this.toJSON)b=c.toJSON(a);else{b={name:a.name,times:ig(a.times,Array),values:ig(a.values,Array)};let c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}return b.type=a.ValueTypeName,b}InterpolantFactoryMethodDiscrete(a){return new iq(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new ip(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new io(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){let b;switch(a){case bE:b=this.InterpolantFactoryMethodDiscrete;break;case bF:b=this.InterpolantFactoryMethodLinear;break;case bG:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){let b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);return console.warn("THREE.KeyframeTrack:",b),this}return this.createInterpolant=b,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return bE;case this.InterpolantFactoryMethodLinear:return bF;case this.InterpolantFactoryMethodSmooth:return bG}}getValueSize(){return this.values.length/this.times.length}shift(a){if(0!==a){let b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]+=a}return this}scale(a){if(1!==a){let b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]*=a}return this}trim(a,b){let c=this.times,d=c.length,e=0,f=d-1;for(;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;if(++f,0!==e||f!==d){e>=f&&(e=(f=Math.max(f,1))-1);let a=this.getValueSize();this.times=c.slice(e,f),this.values=this.values.slice(e*a,f*a)}return this}validate(){let a=!0,b=this.getValueSize();b-Math.floor(b)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);let c=this.times,d=this.values,e=c.length;0===e&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let f=null;for(let b=0;b!==e;b++){let d=c[b];if("number"==typeof d&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,b,d),a=!1;break}if(null!==f&&f>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,b,d,f),a=!1;break}f=d}if(void 0!==d&&ih(d))for(let b=0,c=d.length;b!==c;++b){let c=d[b];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,b,c),a=!1;break}}return a}optimize(){let a=this.times.slice(),b=this.values.slice(),c=this.getValueSize(),d=this.getInterpolation()===bG,e=a.length-1,f=1;for(let g=1;g<e;++g){let e=!1,h=a[g];if(h!==a[g+1]&&(1!==g||h!==a[0]))if(d)e=!0;else{let a=g*c,d=a-c,f=a+c;for(let g=0;g!==c;++g){let c=b[a+g];if(c!==b[d+g]||c!==b[f+g]){e=!0;break}}}if(e){if(g!==f){a[f]=a[g];let d=g*c,e=f*c;for(let a=0;a!==c;++a)b[e+a]=b[d+a]}++f}}if(e>0){a[f]=a[e];for(let a=e*c,d=f*c,g=0;g!==c;++g)b[d+g]=b[a+g];++f}return f!==a.length?(this.times=a.slice(0,f),this.values=b.slice(0,f*c)):(this.times=a,this.values=b),this}clone(){let a=this.times.slice(),b=this.values.slice(),c=new this.constructor(this.name,a,b);return c.createInterpolant=this.createInterpolant,c}}ir.prototype.TimeBufferType=Float32Array,ir.prototype.ValueBufferType=Float32Array,ir.prototype.DefaultInterpolation=bF;class is extends ir{constructor(a,b,c){super(a,b,c)}}is.prototype.ValueTypeName="bool",is.prototype.ValueBufferType=Array,is.prototype.DefaultInterpolation=bE,is.prototype.InterpolantFactoryMethodLinear=void 0,is.prototype.InterpolantFactoryMethodSmooth=void 0;class it extends ir{}it.prototype.ValueTypeName="color";class iu extends ir{}iu.prototype.ValueTypeName="number";class iv extends im{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=(c-b)/(d-b),i=a*g;for(let a=i+g;i!==a;i+=4)df.slerpFlat(e,0,f,i-g,f,i,h);return e}}class iw extends ir{InterpolantFactoryMethodLinear(a){return new iv(this.times,this.values,this.getValueSize(),a)}}iw.prototype.ValueTypeName="quaternion",iw.prototype.InterpolantFactoryMethodSmooth=void 0;class ix extends ir{constructor(a,b,c){super(a,b,c)}}ix.prototype.ValueTypeName="string",ix.prototype.ValueBufferType=Array,ix.prototype.DefaultInterpolation=bE,ix.prototype.InterpolantFactoryMethodLinear=void 0,ix.prototype.InterpolantFactoryMethodSmooth=void 0;class iy extends ir{}iy.prototype.ValueTypeName="vector";class iz{constructor(a="",b=-1,c=[],d=bK){this.name=a,this.tracks=c,this.duration=b,this.blendMode=d,this.uuid=cF(),this.duration<0&&this.resetDuration()}static parse(a){let b=[],c=a.tracks,d=1/(a.fps||1);for(let a=0,e=c.length;a!==e;++a)b.push((function(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");let b=function(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return iu;case"vector":case"vector2":case"vector3":case"vector4":return iy;case"color":return it;case"quaternion":return iw;case"bool":case"boolean":return is;case"string":return ix}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}(a.type);if(void 0===a.times){let b=[],c=[];ik(a.keys,b,c,"value"),a.times=b,a.values=c}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)})(c[a]).scale(d));let e=new this(a.name,a.duration,b,a.blendMode);return e.uuid=a.uuid,e}static toJSON(a){let b=[],c=a.tracks,d={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid,blendMode:a.blendMode};for(let a=0,d=c.length;a!==d;++a)b.push(ir.toJSON(c[a]));return d}static CreateFromMorphTargetSequence(a,b,c,d){let e=b.length,f=[];for(let a=0;a<e;a++){let g=[],h=[];g.push((a+e-1)%e,a,(a+1)%e),h.push(0,1,0);let i=ii(g);g=ij(g,1,i),h=ij(h,1,i),d||0!==g[0]||(g.push(e),h.push(h[0])),f.push(new iu(".morphTargetInfluences["+b[a].name+"]",g,h).scale(1/c))}return new this(a,-1,f)}static findByName(a,b){let c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(let a=0;a<c.length;a++)if(c[a].name===b)return c[a];return null}static CreateClipsFromMorphTargetSequences(a,b,c){let d={},e=/^([\w-]*?)([\d]+)$/;for(let b=0,c=a.length;b<c;b++){let c=a[b],f=c.name.match(e);if(f&&f.length>1){let a=f[1],b=d[a];b||(d[a]=b=[]),b.push(c)}}let f=[];for(let a in d)f.push(this.CreateFromMorphTargetSequence(a,d[a],b,c));return f}static parseAnimation(a,b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let c=function(a,b,c,d,e){if(0!==c.length){let f=[],g=[];ik(c,f,g,d),0!==f.length&&e.push(new a(b,f,g))}},d=[],e=a.name||"default",f=a.fps||30,g=a.blendMode,h=a.length||-1,i=a.hierarchy||[];for(let a=0;a<i.length;a++){let e=i[a].keys;if(e&&0!==e.length)if(e[0].morphTargets){let a,b={};for(a=0;a<e.length;a++)if(e[a].morphTargets)for(let c=0;c<e[a].morphTargets.length;c++)b[e[a].morphTargets[c]]=-1;for(let c in b){let b=[],f=[];for(let d=0;d!==e[a].morphTargets.length;++d){let d=e[a];b.push(d.time),f.push(+(d.morphTarget===c))}d.push(new iu(".morphTargetInfluence["+c+"]",b,f))}h=b.length*f}else{let f=".bones["+b[a].name+"]";c(iy,f+".position",e,"pos",d),c(iw,f+".quaternion",e,"rot",d),c(iy,f+".scale",e,"scl",d)}}return 0===d.length?null:new this(e,h,d,g)}resetDuration(){let a=this.tracks,b=0;for(let c=0,d=a.length;c!==d;++c){let a=this.tracks[c];b=Math.max(b,a.times[a.times.length-1])}return this.duration=b,this}trim(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this}validate(){let a=!0;for(let b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a}optimize(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}clone(){let a=[];for(let b=0;b<this.tracks.length;b++)a.push(this.tracks[b].clone());return new this.constructor(this.name,this.duration,a,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}let iA={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class iB{constructor(a,b,c){let d,e=this,f=!1,g=0,h=0,i=[];this.onStart=void 0,this.onLoad=a,this.onProgress=b,this.onError=c,this.itemStart=function(a){h++,!1===f&&void 0!==e.onStart&&e.onStart(a,g,h),f=!0},this.itemEnd=function(a){g++,void 0!==e.onProgress&&e.onProgress(a,g,h),g===h&&(f=!1,void 0!==e.onLoad&&e.onLoad())},this.itemError=function(a){void 0!==e.onError&&e.onError(a)},this.resolveURL=function(a){return d?d(a):a},this.setURLModifier=function(a){return d=a,this},this.addHandler=function(a,b){return i.push(a,b),this},this.removeHandler=function(a){let b=i.indexOf(a);return -1!==b&&i.splice(b,2),this},this.getHandler=function(a){for(let b=0,c=i.length;b<c;b+=2){let c=i[b],d=i[b+1];if(c.global&&(c.lastIndex=0),c.test(a))return d}return null}}}let iC=new iB;class iD{constructor(a){this.manager=void 0!==a?a:iC,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(a,b){let c=this;return new Promise(function(d,e){c.load(a,d,b,e)})}parse(){}setCrossOrigin(a){return this.crossOrigin=a,this}setWithCredentials(a){return this.withCredentials=a,this}setPath(a){return this.path=a,this}setResourcePath(a){return this.resourcePath=a,this}setRequestHeader(a){return this.requestHeader=a,this}}iD.DEFAULT_MATERIAL_NAME="__DEFAULT";let iE={};class iF extends Error{constructor(a,b){super(a),this.response=b}}class iG extends iD{constructor(a){super(a)}load(a,b,c,d){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);let e=iA.get(a);if(void 0!==e)return this.manager.itemStart(a),setTimeout(()=>{b&&b(e),this.manager.itemEnd(a)},0),e;if(void 0!==iE[a])return void iE[a].push({onLoad:b,onProgress:c,onError:d});iE[a]=[],iE[a].push({onLoad:b,onProgress:c,onError:d});let f=new Request(a,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),g=this.mimeType,h=this.responseType;fetch(f).then(b=>{if(200===b.status||0===b.status){if(0===b.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===b.body||void 0===b.body.getReader)return b;let c=iE[a],d=b.body.getReader(),e=b.headers.get("X-File-Size")||b.headers.get("Content-Length"),f=e?parseInt(e):0,g=0!==f,h=0;return new Response(new ReadableStream({start(a){!function b(){d.read().then(({done:d,value:e})=>{if(d)a.close();else{let d=new ProgressEvent("progress",{lengthComputable:g,loaded:h+=e.byteLength,total:f});for(let a=0,b=c.length;a<b;a++){let b=c[a];b.onProgress&&b.onProgress(d)}a.enqueue(e),b()}},b=>{a.error(b)})}()}}))}throw new iF(`fetch for "${b.url}" responded with ${b.status}: ${b.statusText}`,b)}).then(a=>{switch(h){case"arraybuffer":return a.arrayBuffer();case"blob":return a.blob();case"document":return a.text().then(a=>new DOMParser().parseFromString(a,g));case"json":return a.json();default:if(void 0===g)return a.text();{let b=/charset="?([^;"\s]*)"?/i.exec(g),c=new TextDecoder(b&&b[1]?b[1].toLowerCase():void 0);return a.arrayBuffer().then(a=>c.decode(a))}}}).then(b=>{iA.add(a,b);let c=iE[a];delete iE[a];for(let a=0,d=c.length;a<d;a++){let d=c[a];d.onLoad&&d.onLoad(b)}}).catch(b=>{let c=iE[a];if(void 0===c)throw this.manager.itemError(a),b;delete iE[a];for(let a=0,d=c.length;a<d;a++){let d=c[a];d.onError&&d.onError(b)}this.manager.itemError(a)}).finally(()=>{this.manager.itemEnd(a)}),this.manager.itemStart(a)}setResponseType(a){return this.responseType=a,this}setMimeType(a){return this.mimeType=a,this}}class iH extends iD{constructor(a){super(a)}load(a,b,c,d){let e=this,f=new iG(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(a,function(c){try{b(e.parse(JSON.parse(c)))}catch(b){d?d(b):console.error(b),e.manager.itemError(a)}},c,d)}parse(a){let b=[];for(let c=0;c<a.length;c++){let d=iz.parse(a[c]);b.push(d)}return b}}class iI extends iD{constructor(a){super(a)}load(a,b,c,d){let e=this,f=[],g=new gV,h=new iG(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(e.withCredentials);let i=0;if(Array.isArray(a))for(let j=0,k=a.length;j<k;++j)!function(j){h.load(a[j],function(a){let c=e.parse(a,!0);f[j]={width:c.width,height:c.height,format:c.format,mipmaps:c.mipmaps},6===(i+=1)&&(1===c.mipmapCount&&(g.minFilter=aD),g.image=f,g.format=c.format,g.needsUpdate=!0,b&&b(g))},c,d)}(j);else h.load(a,function(a){let c=e.parse(a,!0);if(c.isCubemap){let a=c.mipmaps.length/c.mipmapCount;for(let b=0;b<a;b++){f[b]={mipmaps:[]};for(let a=0;a<c.mipmapCount;a++)f[b].mipmaps.push(c.mipmaps[b*c.mipmapCount+a]),f[b].format=c.format,f[b].width=c.width,f[b].height=c.height}g.image=f}else g.image.width=c.width,g.image.height=c.height,g.mipmaps=c.mipmaps;1===c.mipmapCount&&(g.minFilter=aD),g.format=c.format,g.needsUpdate=!0,b&&b(g)},c,d);return g}}class iJ extends iD{constructor(a){super(a)}load(a,b,c,d){void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);let e=this,f=iA.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f),e.manager.itemEnd(a)},0),f;let g=cS("img");function h(){j(),iA.add(a,this),b&&b(this),e.manager.itemEnd(a)}function i(b){j(),d&&d(b),e.manager.itemError(a),e.manager.itemEnd(a)}function j(){g.removeEventListener("load",h,!1),g.removeEventListener("error",i,!1)}return g.addEventListener("load",h,!1),g.addEventListener("error",i,!1),"data:"!==a.slice(0,5)&&void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin),e.manager.itemStart(a),g.src=a,g}}class iK extends iD{constructor(a){super(a)}load(a,b,c,d){let e=new fk;e.colorSpace=bW;let f=new iJ(this.manager);f.setCrossOrigin(this.crossOrigin),f.setPath(this.path);let g=0;for(let c=0;c<a.length;++c)!function(c){f.load(a[c],function(a){e.images[c]=a,6==++g&&(e.needsUpdate=!0,b&&b(e))},void 0,d)}(c);return e}}class iL extends iD{constructor(a){super(a)}load(a,b,c,d){let e=this,f=new fY,g=new iG(this.manager);return g.setResponseType("arraybuffer"),g.setRequestHeader(this.requestHeader),g.setPath(this.path),g.setWithCredentials(e.withCredentials),g.load(a,function(a){let c;try{c=e.parse(a)}catch(a){if(void 0===d)return void console.error(a);d(a)}void 0!==c.image?f.image=c.image:void 0!==c.data&&(f.image.width=c.width,f.image.height=c.height,f.image.data=c.data),f.wrapS=void 0!==c.wrapS?c.wrapS:aw,f.wrapT=void 0!==c.wrapT?c.wrapT:aw,f.magFilter=void 0!==c.magFilter?c.magFilter:aD,f.minFilter=void 0!==c.minFilter?c.minFilter:aD,f.anisotropy=void 0!==c.anisotropy?c.anisotropy:1,void 0!==c.colorSpace&&(f.colorSpace=c.colorSpace),void 0!==c.flipY&&(f.flipY=c.flipY),void 0!==c.format&&(f.format=c.format),void 0!==c.type&&(f.type=c.type),void 0!==c.mipmaps&&(f.mipmaps=c.mipmaps,f.minFilter=aG),1===c.mipmapCount&&(f.minFilter=aD),void 0!==c.generateMipmaps&&(f.generateMipmaps=c.generateMipmaps),f.needsUpdate=!0,b&&b(f,c)},c,d),f}}class iM extends iD{constructor(a){super(a)}load(a,b,c,d){let e=new c7,f=new iJ(this.manager);return f.setCrossOrigin(this.crossOrigin),f.setPath(this.path),f.load(a,function(a){e.image=a,e.needsUpdate=!0,void 0!==b&&b(e)},c,d),e}}class iN extends ea{constructor(a,b=1){super(),this.isLight=!0,this.type="Light",this.color=new et(a),this.intensity=b}dispose(){}copy(a,b){return super.copy(a,b),this.color.copy(a.color),this.intensity=a.intensity,this}toJSON(a){let b=super.toJSON(a);return b.object.color=this.color.getHex(),b.object.intensity=this.intensity,void 0!==this.groundColor&&(b.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(b.object.distance=this.distance),void 0!==this.angle&&(b.object.angle=this.angle),void 0!==this.decay&&(b.object.decay=this.decay),void 0!==this.penumbra&&(b.object.penumbra=this.penumbra),void 0!==this.shadow&&(b.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(b.object.target=this.target.uuid),b}}class iO extends iN{constructor(a,b,c){super(a,c),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ea.DEFAULT_UP),this.updateMatrix(),this.groundColor=new et(b)}copy(a,b){return super.copy(a,b),this.groundColor.copy(a.groundColor),this}}let iP=new dL,iQ=new dg,iR=new dg;class iS{constructor(a){this.camera=a,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new cM(512,512),this.map=null,this.mapPass=null,this.matrix=new dL,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new gf,this._frameExtents=new cM(1,1),this._viewportCount=1,this._viewports=[new c8(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){let b=this.camera,c=this.matrix;iQ.setFromMatrixPosition(a.matrixWorld),b.position.copy(iQ),iR.setFromMatrixPosition(a.target.matrixWorld),b.lookAt(iR),b.updateMatrixWorld(),iP.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iP),c.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),c.multiply(iP)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(a){return this.camera=a.camera.clone(),this.intensity=a.intensity,this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let a={};return 1!==this.intensity&&(a.intensity=this.intensity),0!==this.bias&&(a.bias=this.bias),0!==this.normalBias&&(a.normalBias=this.normalBias),1!==this.radius&&(a.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}}class iT extends iS{constructor(){super(new fi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(a){let b=this.camera,c=2*cE*a.angle*this.focus,d=this.mapSize.width/this.mapSize.height,e=a.distance||b.far;(c!==b.fov||d!==b.aspect||e!==b.far)&&(b.fov=c,b.aspect=d,b.far=e,b.updateProjectionMatrix()),super.updateMatrices(a)}copy(a){return super.copy(a),this.focus=a.focus,this}}class iU extends iN{constructor(a,b,c=0,d=Math.PI/3,e=0,f=2){super(a,b),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ea.DEFAULT_UP),this.updateMatrix(),this.target=new ea,this.distance=c,this.angle=d,this.penumbra=e,this.decay=f,this.map=null,this.shadow=new iT}get power(){return this.intensity*Math.PI}set power(a){this.intensity=a/Math.PI}dispose(){this.shadow.dispose()}copy(a,b){return super.copy(a,b),this.distance=a.distance,this.angle=a.angle,this.penumbra=a.penumbra,this.decay=a.decay,this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}let iV=new dL,iW=new dg,iX=new dg;class iY extends iS{constructor(){super(new fi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new cM(4,2),this._viewportCount=6,this._viewports=[new c8(2,1,1,1),new c8(0,1,1,1),new c8(3,1,1,1),new c8(1,1,1,1),new c8(3,0,1,1),new c8(1,0,1,1)],this._cubeDirections=[new dg(1,0,0),new dg(-1,0,0),new dg(0,0,1),new dg(0,0,-1),new dg(0,1,0),new dg(0,-1,0)],this._cubeUps=[new dg(0,1,0),new dg(0,1,0),new dg(0,1,0),new dg(0,1,0),new dg(0,0,1),new dg(0,0,-1)]}updateMatrices(a,b=0){let c=this.camera,d=this.matrix,e=a.distance||c.far;e!==c.far&&(c.far=e,c.updateProjectionMatrix()),iW.setFromMatrixPosition(a.matrixWorld),c.position.copy(iW),iX.copy(c.position),iX.add(this._cubeDirections[b]),c.up.copy(this._cubeUps[b]),c.lookAt(iX),c.updateMatrixWorld(),d.makeTranslation(-iW.x,-iW.y,-iW.z),iV.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iV)}}class iZ extends iN{constructor(a,b,c=0,d=2){super(a,b),this.isPointLight=!0,this.type="PointLight",this.distance=c,this.decay=d,this.shadow=new iY}get power(){return 4*this.intensity*Math.PI}set power(a){this.intensity=a/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(a,b){return super.copy(a,b),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this}}class i$ extends fe{constructor(a=-1,b=1,c=1,d=-1,e=.1,f=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=b,this.top=c,this.bottom=d,this.near=e,this.far=f,this.updateProjectionMatrix()}copy(a,b){return super.copy(a,b),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this}setViewOffset(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=b,this.view.offsetX=c,this.view.offsetY=d,this.view.width=e,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a,f=c+a,g=d+b,h=d-b;if(null!==this.view&&this.view.enabled){let a=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;e+=a*this.view.offsetX,f=e+a*this.view.width,g-=b*this.view.offsetY,h=g-b*this.view.height}this.projectionMatrix.makeOrthographic(e,f,g,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){let b=super.toJSON(a);return b.object.zoom=this.zoom,b.object.left=this.left,b.object.right=this.right,b.object.top=this.top,b.object.bottom=this.bottom,b.object.near=this.near,b.object.far=this.far,null!==this.view&&(b.object.view=Object.assign({},this.view)),b}}class i_ extends iS{constructor(){super(new i$(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class i0 extends iN{constructor(a,b){super(a,b),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ea.DEFAULT_UP),this.updateMatrix(),this.target=new ea,this.shadow=new i_}dispose(){this.shadow.dispose()}copy(a){return super.copy(a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}class i1 extends iN{constructor(a,b){super(a,b),this.isAmbientLight=!0,this.type="AmbientLight"}}class i2 extends iN{constructor(a,b,c=10,d=10){super(a,b),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=c,this.height=d}get power(){return this.intensity*this.width*this.height*Math.PI}set power(a){this.intensity=a/(this.width*this.height*Math.PI)}copy(a){return super.copy(a),this.width=a.width,this.height=a.height,this}toJSON(a){let b=super.toJSON(a);return b.object.width=this.width,b.object.height=this.height,b}}class i3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let a=0;a<9;a++)this.coefficients.push(new dg)}set(a){for(let b=0;b<9;b++)this.coefficients[b].copy(a[b]);return this}zero(){for(let a=0;a<9;a++)this.coefficients[a].set(0,0,0);return this}getAt(a,b){let c=a.x,d=a.y,e=a.z,f=this.coefficients;return b.copy(f[0]).multiplyScalar(.282095),b.addScaledVector(f[1],.488603*d),b.addScaledVector(f[2],.488603*e),b.addScaledVector(f[3],.488603*c),b.addScaledVector(f[4],c*d*1.092548),b.addScaledVector(f[5],d*e*1.092548),b.addScaledVector(f[6],.315392*(3*e*e-1)),b.addScaledVector(f[7],c*e*1.092548),b.addScaledVector(f[8],.546274*(c*c-d*d)),b}getIrradianceAt(a,b){let c=a.x,d=a.y,e=a.z,f=this.coefficients;return b.copy(f[0]).multiplyScalar(.886227),b.addScaledVector(f[1],1.023328*d),b.addScaledVector(f[2],1.023328*e),b.addScaledVector(f[3],1.023328*c),b.addScaledVector(f[4],.858086*c*d),b.addScaledVector(f[5],.858086*d*e),b.addScaledVector(f[6],.743125*e*e-.247708),b.addScaledVector(f[7],.858086*c*e),b.addScaledVector(f[8],.429043*(c*c-d*d)),b}add(a){for(let b=0;b<9;b++)this.coefficients[b].add(a.coefficients[b]);return this}addScaledSH(a,b){for(let c=0;c<9;c++)this.coefficients[c].addScaledVector(a.coefficients[c],b);return this}scale(a){for(let b=0;b<9;b++)this.coefficients[b].multiplyScalar(a);return this}lerp(a,b){for(let c=0;c<9;c++)this.coefficients[c].lerp(a.coefficients[c],b);return this}equals(a){for(let b=0;b<9;b++)if(!this.coefficients[b].equals(a.coefficients[b]))return!1;return!0}copy(a){return this.set(a.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(a,b=0){let c=this.coefficients;for(let d=0;d<9;d++)c[d].fromArray(a,b+3*d);return this}toArray(a=[],b=0){let c=this.coefficients;for(let d=0;d<9;d++)c[d].toArray(a,b+3*d);return a}static getBasisAt(a,b){let c=a.x,d=a.y,e=a.z;b[0]=.282095,b[1]=.488603*d,b[2]=.488603*e,b[3]=.488603*c,b[4]=1.092548*c*d,b[5]=1.092548*d*e,b[6]=.315392*(3*e*e-1),b[7]=1.092548*c*e,b[8]=.546274*(c*c-d*d)}}class i4 extends iN{constructor(a=new i3,b=1){super(void 0,b),this.isLightProbe=!0,this.sh=a}copy(a){return super.copy(a),this.sh.copy(a.sh),this}fromJSON(a){return this.intensity=a.intensity,this.sh.fromArray(a.sh),this}toJSON(a){let b=super.toJSON(a);return b.object.sh=this.sh.toArray(),b}}class i5 extends iD{constructor(a){super(a),this.textures={}}load(a,b,c,d){let e=this,f=new iG(e.manager);f.setPath(e.path),f.setRequestHeader(e.requestHeader),f.setWithCredentials(e.withCredentials),f.load(a,function(c){try{b(e.parse(JSON.parse(c)))}catch(b){d?d(b):console.error(b),e.manager.itemError(a)}},c,d)}parse(a){let b=this.textures;function c(a){return void 0===b[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a),b[a]}let d=this.createMaterialFromType(a.type);if(void 0!==a.uuid&&(d.uuid=a.uuid),void 0!==a.name&&(d.name=a.name),void 0!==a.color&&void 0!==d.color&&d.color.setHex(a.color),void 0!==a.roughness&&(d.roughness=a.roughness),void 0!==a.metalness&&(d.metalness=a.metalness),void 0!==a.sheen&&(d.sheen=a.sheen),void 0!==a.sheenColor&&(d.sheenColor=new et().setHex(a.sheenColor)),void 0!==a.sheenRoughness&&(d.sheenRoughness=a.sheenRoughness),void 0!==a.emissive&&void 0!==d.emissive&&d.emissive.setHex(a.emissive),void 0!==a.specular&&void 0!==d.specular&&d.specular.setHex(a.specular),void 0!==a.specularIntensity&&(d.specularIntensity=a.specularIntensity),void 0!==a.specularColor&&void 0!==d.specularColor&&d.specularColor.setHex(a.specularColor),void 0!==a.shininess&&(d.shininess=a.shininess),void 0!==a.clearcoat&&(d.clearcoat=a.clearcoat),void 0!==a.clearcoatRoughness&&(d.clearcoatRoughness=a.clearcoatRoughness),void 0!==a.dispersion&&(d.dispersion=a.dispersion),void 0!==a.iridescence&&(d.iridescence=a.iridescence),void 0!==a.iridescenceIOR&&(d.iridescenceIOR=a.iridescenceIOR),void 0!==a.iridescenceThicknessRange&&(d.iridescenceThicknessRange=a.iridescenceThicknessRange),void 0!==a.transmission&&(d.transmission=a.transmission),void 0!==a.thickness&&(d.thickness=a.thickness),void 0!==a.attenuationDistance&&(d.attenuationDistance=a.attenuationDistance),void 0!==a.attenuationColor&&void 0!==d.attenuationColor&&d.attenuationColor.setHex(a.attenuationColor),void 0!==a.anisotropy&&(d.anisotropy=a.anisotropy),void 0!==a.anisotropyRotation&&(d.anisotropyRotation=a.anisotropyRotation),void 0!==a.fog&&(d.fog=a.fog),void 0!==a.flatShading&&(d.flatShading=a.flatShading),void 0!==a.blending&&(d.blending=a.blending),void 0!==a.combine&&(d.combine=a.combine),void 0!==a.side&&(d.side=a.side),void 0!==a.shadowSide&&(d.shadowSide=a.shadowSide),void 0!==a.opacity&&(d.opacity=a.opacity),void 0!==a.transparent&&(d.transparent=a.transparent),void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest),void 0!==a.alphaHash&&(d.alphaHash=a.alphaHash),void 0!==a.depthFunc&&(d.depthFunc=a.depthFunc),void 0!==a.depthTest&&(d.depthTest=a.depthTest),void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite),void 0!==a.colorWrite&&(d.colorWrite=a.colorWrite),void 0!==a.blendSrc&&(d.blendSrc=a.blendSrc),void 0!==a.blendDst&&(d.blendDst=a.blendDst),void 0!==a.blendEquation&&(d.blendEquation=a.blendEquation),void 0!==a.blendSrcAlpha&&(d.blendSrcAlpha=a.blendSrcAlpha),void 0!==a.blendDstAlpha&&(d.blendDstAlpha=a.blendDstAlpha),void 0!==a.blendEquationAlpha&&(d.blendEquationAlpha=a.blendEquationAlpha),void 0!==a.blendColor&&void 0!==d.blendColor&&d.blendColor.setHex(a.blendColor),void 0!==a.blendAlpha&&(d.blendAlpha=a.blendAlpha),void 0!==a.stencilWriteMask&&(d.stencilWriteMask=a.stencilWriteMask),void 0!==a.stencilFunc&&(d.stencilFunc=a.stencilFunc),void 0!==a.stencilRef&&(d.stencilRef=a.stencilRef),void 0!==a.stencilFuncMask&&(d.stencilFuncMask=a.stencilFuncMask),void 0!==a.stencilFail&&(d.stencilFail=a.stencilFail),void 0!==a.stencilZFail&&(d.stencilZFail=a.stencilZFail),void 0!==a.stencilZPass&&(d.stencilZPass=a.stencilZPass),void 0!==a.stencilWrite&&(d.stencilWrite=a.stencilWrite),void 0!==a.wireframe&&(d.wireframe=a.wireframe),void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth),void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap),void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin),void 0!==a.rotation&&(d.rotation=a.rotation),void 0!==a.linewidth&&(d.linewidth=a.linewidth),void 0!==a.dashSize&&(d.dashSize=a.dashSize),void 0!==a.gapSize&&(d.gapSize=a.gapSize),void 0!==a.scale&&(d.scale=a.scale),void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset),void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor),void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits),void 0!==a.dithering&&(d.dithering=a.dithering),void 0!==a.alphaToCoverage&&(d.alphaToCoverage=a.alphaToCoverage),void 0!==a.premultipliedAlpha&&(d.premultipliedAlpha=a.premultipliedAlpha),void 0!==a.forceSinglePass&&(d.forceSinglePass=a.forceSinglePass),void 0!==a.visible&&(d.visible=a.visible),void 0!==a.toneMapped&&(d.toneMapped=a.toneMapped),void 0!==a.userData&&(d.userData=a.userData),void 0!==a.vertexColors&&("number"==typeof a.vertexColors?d.vertexColors=a.vertexColors>0:d.vertexColors=a.vertexColors),void 0!==a.uniforms)for(let b in a.uniforms){let e=a.uniforms[b];switch(d.uniforms[b]={},e.type){case"t":d.uniforms[b].value=c(e.value);break;case"c":d.uniforms[b].value=new et().setHex(e.value);break;case"v2":d.uniforms[b].value=new cM().fromArray(e.value);break;case"v3":d.uniforms[b].value=new dg().fromArray(e.value);break;case"v4":d.uniforms[b].value=new c8().fromArray(e.value);break;case"m3":d.uniforms[b].value=new cN().fromArray(e.value);break;case"m4":d.uniforms[b].value=new dL().fromArray(e.value);break;default:d.uniforms[b].value=e.value}}if(void 0!==a.defines&&(d.defines=a.defines),void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader),void 0!==a.fragmentShader&&(d.fragmentShader=a.fragmentShader),void 0!==a.glslVersion&&(d.glslVersion=a.glslVersion),void 0!==a.extensions)for(let b in a.extensions)d.extensions[b]=a.extensions[b];if(void 0!==a.lights&&(d.lights=a.lights),void 0!==a.clipping&&(d.clipping=a.clipping),void 0!==a.size&&(d.size=a.size),void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation),void 0!==a.map&&(d.map=c(a.map)),void 0!==a.matcap&&(d.matcap=c(a.matcap)),void 0!==a.alphaMap&&(d.alphaMap=c(a.alphaMap)),void 0!==a.bumpMap&&(d.bumpMap=c(a.bumpMap)),void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale),void 0!==a.normalMap&&(d.normalMap=c(a.normalMap)),void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType),void 0!==a.normalScale){let b=a.normalScale;!1===Array.isArray(b)&&(b=[b,b]),d.normalScale=new cM().fromArray(b)}return void 0!==a.displacementMap&&(d.displacementMap=c(a.displacementMap)),void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale),void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias),void 0!==a.roughnessMap&&(d.roughnessMap=c(a.roughnessMap)),void 0!==a.metalnessMap&&(d.metalnessMap=c(a.metalnessMap)),void 0!==a.emissiveMap&&(d.emissiveMap=c(a.emissiveMap)),void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity),void 0!==a.specularMap&&(d.specularMap=c(a.specularMap)),void 0!==a.specularIntensityMap&&(d.specularIntensityMap=c(a.specularIntensityMap)),void 0!==a.specularColorMap&&(d.specularColorMap=c(a.specularColorMap)),void 0!==a.envMap&&(d.envMap=c(a.envMap)),void 0!==a.envMapRotation&&d.envMapRotation.fromArray(a.envMapRotation),void 0!==a.envMapIntensity&&(d.envMapIntensity=a.envMapIntensity),void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity),void 0!==a.refractionRatio&&(d.refractionRatio=a.refractionRatio),void 0!==a.lightMap&&(d.lightMap=c(a.lightMap)),void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity),void 0!==a.aoMap&&(d.aoMap=c(a.aoMap)),void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity),void 0!==a.gradientMap&&(d.gradientMap=c(a.gradientMap)),void 0!==a.clearcoatMap&&(d.clearcoatMap=c(a.clearcoatMap)),void 0!==a.clearcoatRoughnessMap&&(d.clearcoatRoughnessMap=c(a.clearcoatRoughnessMap)),void 0!==a.clearcoatNormalMap&&(d.clearcoatNormalMap=c(a.clearcoatNormalMap)),void 0!==a.clearcoatNormalScale&&(d.clearcoatNormalScale=new cM().fromArray(a.clearcoatNormalScale)),void 0!==a.iridescenceMap&&(d.iridescenceMap=c(a.iridescenceMap)),void 0!==a.iridescenceThicknessMap&&(d.iridescenceThicknessMap=c(a.iridescenceThicknessMap)),void 0!==a.transmissionMap&&(d.transmissionMap=c(a.transmissionMap)),void 0!==a.thicknessMap&&(d.thicknessMap=c(a.thicknessMap)),void 0!==a.anisotropyMap&&(d.anisotropyMap=c(a.anisotropyMap)),void 0!==a.sheenColorMap&&(d.sheenColorMap=c(a.sheenColorMap)),void 0!==a.sheenRoughnessMap&&(d.sheenRoughnessMap=c(a.sheenRoughnessMap)),d}setTextures(a){return this.textures=a,this}createMaterialFromType(a){return i5.createMaterialFromType(a)}static createMaterialFromType(a){return new({ShadowMaterial:h3,SpriteMaterial:fv,RawShaderMaterial:h4,ShaderMaterial:fd,PointsMaterial:gL,MeshPhysicalMaterial:h6,MeshStandardMaterial:h5,MeshPhongMaterial:h7,MeshToonMaterial:h8,MeshNormalMaterial:h9,MeshLambertMaterial:ia,MeshDepthMaterial:ib,MeshDistanceMaterial:ic,MeshBasicMaterial:ex,MeshMatcapMaterial:id,LineDashedMaterial:ie,LineBasicMaterial:gx,Material:ew})[a]}}class i6{static decodeText(a){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),"undefined"!=typeof TextDecoder)return new TextDecoder().decode(a);let b="";for(let c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);try{return decodeURIComponent(escape(b))}catch(a){return b}}static extractUrlBase(a){let b=a.lastIndexOf("/");return -1===b?"./":a.slice(0,b+1)}static resolveURL(a,b){return"string"!=typeof a||""===a?"":(/^https?:\/\//i.test(b)&&/^\//.test(a)&&(b=b.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(a)||/^data:.*,.*$/i.test(a)||/^blob:.*$/i.test(a))?a:b+a}}class i7 extends eW{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(a){return super.copy(a),this.instanceCount=a.instanceCount,this}toJSON(){let a=super.toJSON();return a.instanceCount=this.instanceCount,a.isInstancedBufferGeometry=!0,a}}class i8 extends iD{constructor(a){super(a)}load(a,b,c,d){let e=this,f=new iG(e.manager);f.setPath(e.path),f.setRequestHeader(e.requestHeader),f.setWithCredentials(e.withCredentials),f.load(a,function(c){try{b(e.parse(JSON.parse(c)))}catch(b){d?d(b):console.error(b),e.manager.itemError(a)}},c,d)}parse(a){let b={},c={};function d(a,d){if(void 0!==b[d])return b[d];let e=a.interleavedBuffers[d],f=function(a,b){if(void 0!==c[b])return c[b];let d=new Uint32Array(a.arrayBuffers[b]).buffer;return c[b]=d,d}(a,e.buffer),g=new fs(cR(e.type,f),e.stride);return g.uuid=e.uuid,b[d]=g,g}let e=a.isInstancedBufferGeometry?new i7:new eW,f=a.data.index;if(void 0!==f){let a=cR(f.type,f.array);e.setIndex(new eF(a,1))}let g=a.data.attributes;for(let b in g){let c,f=g[b];if(f.isInterleavedBufferAttribute)c=new fu(d(a.data,f.data),f.itemSize,f.offset,f.normalized);else{let a=cR(f.type,f.array);c=new(f.isInstancedBufferAttribute?f0:eF)(a,f.itemSize,f.normalized)}void 0!==f.name&&(c.name=f.name),void 0!==f.usage&&c.setUsage(f.usage),e.setAttribute(b,c)}let h=a.data.morphAttributes;if(h)for(let b in h){let c=h[b],f=[];for(let b=0,e=c.length;b<e;b++){let e,g=c[b];e=g.isInterleavedBufferAttribute?new fu(d(a.data,g.data),g.itemSize,g.offset,g.normalized):new eF(cR(g.type,g.array),g.itemSize,g.normalized),void 0!==g.name&&(e.name=g.name),f.push(e)}e.morphAttributes[b]=f}a.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);let i=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==i)for(let a=0,b=i.length;a!==b;++a){let b=i[a];e.addGroup(b.start,b.count,b.materialIndex)}let j=a.data.boundingSphere;if(void 0!==j){let a=new dg;void 0!==j.center&&a.fromArray(j.center),e.boundingSphere=new dC(a,j.radius)}return a.name&&(e.name=a.name),a.userData&&(e.userData=a.userData),e}}class i9 extends iD{constructor(a){super(a)}load(a,b,c,d){let e=this,f=""===this.path?i6.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||f;let g=new iG(this.manager);g.setPath(this.path),g.setRequestHeader(this.requestHeader),g.setWithCredentials(this.withCredentials),g.load(a,function(c){let f=null;try{f=JSON.parse(c)}catch(b){void 0!==d&&d(b),console.error("THREE:ObjectLoader: Can't parse "+a+".",b.message);return}let g=f.metadata;if(void 0===g||void 0===g.type||"geometry"===g.type.toLowerCase()){void 0!==d&&d(Error("THREE.ObjectLoader: Can't load "+a)),console.error("THREE.ObjectLoader: Can't load "+a);return}e.parse(f,b)},c,d)}async loadAsync(a,b){let c=""===this.path?i6.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||c;let d=new iG(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials);let e=JSON.parse(await d.loadAsync(a,b)),f=e.metadata;if(void 0===f||void 0===f.type||"geometry"===f.type.toLowerCase())throw Error("THREE.ObjectLoader: Can't load "+a);return await this.parseAsync(e)}parse(a,b){let c=this.parseAnimations(a.animations),d=this.parseShapes(a.shapes),e=this.parseGeometries(a.geometries,d),f=this.parseImages(a.images,function(){void 0!==b&&b(i)}),g=this.parseTextures(a.textures,f),h=this.parseMaterials(a.materials,g),i=this.parseObject(a.object,e,h,g,c),j=this.parseSkeletons(a.skeletons,i);if(this.bindSkeletons(i,j),this.bindLightTargets(i),void 0!==b){let a=!1;for(let b in f)if(f[b].data instanceof HTMLImageElement){a=!0;break}!1===a&&b(i)}return i}async parseAsync(a){let b=this.parseAnimations(a.animations),c=this.parseShapes(a.shapes),d=this.parseGeometries(a.geometries,c),e=await this.parseImagesAsync(a.images),f=this.parseTextures(a.textures,e),g=this.parseMaterials(a.materials,f),h=this.parseObject(a.object,d,g,f,b),i=this.parseSkeletons(a.skeletons,h);return this.bindSkeletons(h,i),this.bindLightTargets(h),h}parseShapes(a){let b={};if(void 0!==a)for(let c=0,d=a.length;c<d;c++){let d=new hw().fromJSON(a[c]);b[d.uuid]=d}return b}parseSkeletons(a,b){let c={},d={};if(b.traverse(function(a){a.isBone&&(d[a.uuid]=a)}),void 0!==a)for(let b=0,e=a.length;b<e;b++){let e=new f_().fromJSON(a[b],d);c[e.uuid]=e}return c}parseGeometries(a,b){let c={};if(void 0!==a){let d=new i8;for(let e=0,f=a.length;e<f;e++){let f,g=a[e];switch(g.type){case"BufferGeometry":case"InstancedBufferGeometry":f=d.parse(g);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?f=new THREE.LegacyJSONLoader().parse(g,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:g.type in h2?f=h2[g.type].fromJSON(g,b):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${g.type}"`)}f.uuid=g.uuid,void 0!==g.name&&(f.name=g.name),void 0!==g.userData&&(f.userData=g.userData),c[g.uuid]=f}}return c}parseMaterials(a,b){let c={},d={};if(void 0!==a){let e=new i5;e.setTextures(b);for(let b=0,f=a.length;b<f;b++){let f=a[b];void 0===c[f.uuid]&&(c[f.uuid]=e.parse(f)),d[f.uuid]=c[f.uuid]}}return d}parseAnimations(a){let b={};if(void 0!==a)for(let c=0;c<a.length;c++){let d=a[c],e=iz.parse(d);b[e.uuid]=e}return b}parseImages(a,b){let c,d=this,e={};function f(a){if("string"==typeof a){var b;return b=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:d.resourcePath+a,d.manager.itemStart(b),c.load(b,function(){d.manager.itemEnd(b)},void 0,function(){d.manager.itemError(b),d.manager.itemEnd(b)})}return a.data?{data:cR(a.type,a.data),width:a.width,height:a.height}:null}if(void 0!==a&&a.length>0){(c=new iJ(new iB(b))).setCrossOrigin(this.crossOrigin);for(let b=0,c=a.length;b<c;b++){let c=a[b],d=c.url;if(Array.isArray(d)){let a=[];for(let b=0,c=d.length;b<c;b++){let c=f(d[b]);null!==c&&(c instanceof HTMLImageElement?a.push(c):a.push(new fY(c.data,c.width,c.height)))}e[c.uuid]=new c4(a)}else{let a=f(c.url);e[c.uuid]=new c4(a)}}}return e}async parseImagesAsync(a){let b,c=this,d={};async function e(a){if("string"==typeof a){let d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:c.resourcePath+a;return await b.loadAsync(d)}return a.data?{data:cR(a.type,a.data),width:a.width,height:a.height}:null}if(void 0!==a&&a.length>0){(b=new iJ(this.manager)).setCrossOrigin(this.crossOrigin);for(let b=0,c=a.length;b<c;b++){let c=a[b],f=c.url;if(Array.isArray(f)){let a=[];for(let b=0,c=f.length;b<c;b++){let c=f[b],d=await e(c);null!==d&&(d instanceof HTMLImageElement?a.push(d):a.push(new fY(d.data,d.width,d.height)))}d[c.uuid]=new c4(a)}else{let a=await e(c.url);d[c.uuid]=new c4(a)}}}return d}parseTextures(a,b){function c(a,b){return"number"==typeof a?a:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a),b[a])}let d={};if(void 0!==a)for(let e=0,f=a.length;e<f;e++){let f,g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid),void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);let h=b[g.image],i=h.data;Array.isArray(i)?(f=new fk,6===i.length&&(f.needsUpdate=!0)):(f=i&&i.data?new fY:new c7,i&&(f.needsUpdate=!0)),f.source=h,f.uuid=g.uuid,void 0!==g.name&&(f.name=g.name),void 0!==g.mapping&&(f.mapping=c(g.mapping,ja)),void 0!==g.channel&&(f.channel=g.channel),void 0!==g.offset&&f.offset.fromArray(g.offset),void 0!==g.repeat&&f.repeat.fromArray(g.repeat),void 0!==g.center&&f.center.fromArray(g.center),void 0!==g.rotation&&(f.rotation=g.rotation),void 0!==g.wrap&&(f.wrapS=c(g.wrap[0],jb),f.wrapT=c(g.wrap[1],jb)),void 0!==g.format&&(f.format=g.format),void 0!==g.internalFormat&&(f.internalFormat=g.internalFormat),void 0!==g.type&&(f.type=g.type),void 0!==g.colorSpace&&(f.colorSpace=g.colorSpace),void 0!==g.minFilter&&(f.minFilter=c(g.minFilter,jc)),void 0!==g.magFilter&&(f.magFilter=c(g.magFilter,jc)),void 0!==g.anisotropy&&(f.anisotropy=g.anisotropy),void 0!==g.flipY&&(f.flipY=g.flipY),void 0!==g.generateMipmaps&&(f.generateMipmaps=g.generateMipmaps),void 0!==g.premultiplyAlpha&&(f.premultiplyAlpha=g.premultiplyAlpha),void 0!==g.unpackAlignment&&(f.unpackAlignment=g.unpackAlignment),void 0!==g.compareFunction&&(f.compareFunction=g.compareFunction),void 0!==g.userData&&(f.userData=g.userData),d[g.uuid]=f}return d}parseObject(a,b,c,d,e){let f,g,h;function i(a){return void 0===b[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",a),b[a]}function j(a){if(void 0!==a){if(Array.isArray(a)){let b=[];for(let d=0,e=a.length;d<e;d++){let e=a[d];void 0===c[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),b.push(c[e])}return b}return void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),c[a]}}function k(a){return void 0===d[a]&&console.warn("THREE.ObjectLoader: Undefined texture",a),d[a]}switch(a.type){case"Scene":f=new fr,void 0!==a.background&&(Number.isInteger(a.background)?f.background=new et(a.background):f.background=k(a.background)),void 0!==a.environment&&(f.environment=k(a.environment)),void 0!==a.fog&&("Fog"===a.fog.type?f.fog=new fq(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(f.fog=new fp(a.fog.color,a.fog.density)),""!==a.fog.name&&(f.fog.name=a.fog.name)),void 0!==a.backgroundBlurriness&&(f.backgroundBlurriness=a.backgroundBlurriness),void 0!==a.backgroundIntensity&&(f.backgroundIntensity=a.backgroundIntensity),void 0!==a.backgroundRotation&&f.backgroundRotation.fromArray(a.backgroundRotation),void 0!==a.environmentIntensity&&(f.environmentIntensity=a.environmentIntensity),void 0!==a.environmentRotation&&f.environmentRotation.fromArray(a.environmentRotation);break;case"PerspectiveCamera":f=new fi(a.fov,a.aspect,a.near,a.far),void 0!==a.focus&&(f.focus=a.focus),void 0!==a.zoom&&(f.zoom=a.zoom),void 0!==a.filmGauge&&(f.filmGauge=a.filmGauge),void 0!==a.filmOffset&&(f.filmOffset=a.filmOffset),void 0!==a.view&&(f.view=Object.assign({},a.view));break;case"OrthographicCamera":f=new i$(a.left,a.right,a.top,a.bottom,a.near,a.far),void 0!==a.zoom&&(f.zoom=a.zoom),void 0!==a.view&&(f.view=Object.assign({},a.view));break;case"AmbientLight":f=new i1(a.color,a.intensity);break;case"DirectionalLight":(f=new i0(a.color,a.intensity)).target=a.target||"";break;case"PointLight":f=new iZ(a.color,a.intensity,a.distance,a.decay);break;case"RectAreaLight":f=new i2(a.color,a.intensity,a.width,a.height);break;case"SpotLight":(f=new iU(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay)).target=a.target||"";break;case"HemisphereLight":f=new iO(a.color,a.groundColor,a.intensity);break;case"LightProbe":f=new i4().fromJSON(a);break;case"SkinnedMesh":f=new fW(g=i(a.geometry),h=j(a.material)),void 0!==a.bindMode&&(f.bindMode=a.bindMode),void 0!==a.bindMatrix&&f.bindMatrix.fromArray(a.bindMatrix),void 0!==a.skeleton&&(f.skeleton=a.skeleton);break;case"Mesh":f=new e6(g=i(a.geometry),h=j(a.material));break;case"InstancedMesh":g=i(a.geometry),h=j(a.material);let l=a.count,m=a.instanceMatrix,n=a.instanceColor;(f=new f8(g,h,l)).instanceMatrix=new f0(new Float32Array(m.array),16),void 0!==n&&(f.instanceColor=new f0(new Float32Array(n.array),n.itemSize));break;case"BatchedMesh":g=i(a.geometry),h=j(a.material),(f=new gw(a.maxInstanceCount,a.maxVertexCount,a.maxIndexCount,h)).geometry=g,f.perObjectFrustumCulled=a.perObjectFrustumCulled,f.sortObjects=a.sortObjects,f._drawRanges=a.drawRanges,f._reservedRanges=a.reservedRanges,f._visibility=a.visibility,f._active=a.active,f._bounds=a.bounds.map(a=>{let b=new dj;b.min.fromArray(a.boxMin),b.max.fromArray(a.boxMax);let c=new dC;return c.radius=a.sphereRadius,c.center.fromArray(a.sphereCenter),{boxInitialized:a.boxInitialized,box:b,sphereInitialized:a.sphereInitialized,sphere:c}}),f._maxInstanceCount=a.maxInstanceCount,f._maxVertexCount=a.maxVertexCount,f._maxIndexCount=a.maxIndexCount,f._geometryInitialized=a.geometryInitialized,f._geometryCount=a.geometryCount,f._matricesTexture=k(a.matricesTexture.uuid),void 0!==a.colorsTexture&&(f._colorsTexture=k(a.colorsTexture.uuid));break;case"LOD":f=new fM;break;case"Line":f=new gF(i(a.geometry),j(a.material));break;case"LineLoop":f=new gK(i(a.geometry),j(a.material));break;case"LineSegments":f=new gJ(i(a.geometry),j(a.material));break;case"PointCloud":case"Points":f=new gQ(i(a.geometry),j(a.material));break;case"Sprite":f=new fI(j(a.material));break;case"Group":f=new fm;break;case"Bone":f=new fX;break;default:f=new ea}if(f.uuid=a.uuid,void 0!==a.name&&(f.name=a.name),void 0!==a.matrix?(f.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(void 0!==a.position&&f.position.fromArray(a.position),void 0!==a.rotation&&f.rotation.fromArray(a.rotation),void 0!==a.quaternion&&f.quaternion.fromArray(a.quaternion),void 0!==a.scale&&f.scale.fromArray(a.scale)),void 0!==a.up&&f.up.fromArray(a.up),void 0!==a.castShadow&&(f.castShadow=a.castShadow),void 0!==a.receiveShadow&&(f.receiveShadow=a.receiveShadow),a.shadow&&(void 0!==a.shadow.intensity&&(f.shadow.intensity=a.shadow.intensity),void 0!==a.shadow.bias&&(f.shadow.bias=a.shadow.bias),void 0!==a.shadow.normalBias&&(f.shadow.normalBias=a.shadow.normalBias),void 0!==a.shadow.radius&&(f.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&f.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(f.shadow.camera=this.parseObject(a.shadow.camera))),void 0!==a.visible&&(f.visible=a.visible),void 0!==a.frustumCulled&&(f.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(f.renderOrder=a.renderOrder),void 0!==a.userData&&(f.userData=a.userData),void 0!==a.layers&&(f.layers.mask=a.layers),void 0!==a.children){let g=a.children;for(let a=0;a<g.length;a++)f.add(this.parseObject(g[a],b,c,d,e))}if(void 0!==a.animations){let b=a.animations;for(let a=0;a<b.length;a++){let c=b[a];f.animations.push(e[c])}}if("LOD"===a.type){void 0!==a.autoUpdate&&(f.autoUpdate=a.autoUpdate);let b=a.levels;for(let a=0;a<b.length;a++){let c=b[a],d=f.getObjectByProperty("uuid",c.object);void 0!==d&&f.addLevel(d,c.distance,c.hysteresis)}}return f}bindSkeletons(a,b){0!==Object.keys(b).length&&a.traverse(function(a){if(!0===a.isSkinnedMesh&&void 0!==a.skeleton){let c=b[a.skeleton];void 0===c?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",a.skeleton):a.bind(c,a.bindMatrix)}})}bindLightTargets(a){a.traverse(function(b){if(b.isDirectionalLight||b.isSpotLight){let c=b.target,d=a.getObjectByProperty("uuid",c);void 0!==d?b.target=d:b.target=new ea}})}}let ja={UVMapping:ap,CubeReflectionMapping:aq,CubeRefractionMapping:ar,EquirectangularReflectionMapping:as,EquirectangularRefractionMapping:at,CubeUVReflectionMapping:au},jb={RepeatWrapping:av,ClampToEdgeWrapping:aw,MirroredRepeatWrapping:ax},jc={NearestFilter:ay,NearestMipmapNearestFilter:az,NearestMipmapLinearFilter:aB,LinearFilter:aD,LinearMipmapNearestFilter:aE,LinearMipmapLinearFilter:aG};class jd extends iD{constructor(a){super(a),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(a){return this.options=a,this}load(a,b,c,d){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);let e=this,f=iA.get(a);if(void 0!==f)return(e.manager.itemStart(a),f.then)?void f.then(c=>{b&&b(c),e.manager.itemEnd(a)}).catch(a=>{d&&d(a)}):(setTimeout(function(){b&&b(f),e.manager.itemEnd(a)},0),f);let g={};g.credentials="anonymous"===this.crossOrigin?"same-origin":"include",g.headers=this.requestHeader;let h=fetch(a,g).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,Object.assign(e.options,{colorSpaceConversion:"none"}))}).then(function(c){return iA.add(a,c),b&&b(c),e.manager.itemEnd(a),c}).catch(function(b){d&&d(b),iA.remove(a),e.manager.itemError(a),e.manager.itemEnd(a)});iA.add(a,h),e.manager.itemStart(a)}}class je{static getContext(){return void 0===f&&(f=new(window.AudioContext||window.webkitAudioContext)),f}static setContext(a){f=a}}class jf extends iD{constructor(a){super(a)}load(a,b,c,d){let e=this,f=new iG(this.manager);function g(b){d?d(b):console.error(b),e.manager.itemError(a)}f.setResponseType("arraybuffer"),f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(a,function(a){try{let c=a.slice(0);je.getContext().decodeAudioData(c,function(a){b(a)}).catch(g)}catch(a){g(a)}},c,d)}}let jg=new dL,jh=new dL,ji=new dL;class jj{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(a){let b=this._cache;if(b.focus!==a.focus||b.fov!==a.fov||b.aspect!==a.aspect*this.aspect||b.near!==a.near||b.far!==a.far||b.zoom!==a.zoom||b.eyeSep!==this.eyeSep){let c,d;b.focus=a.focus,b.fov=a.fov,b.aspect=a.aspect*this.aspect,b.near=a.near,b.far=a.far,b.zoom=a.zoom,b.eyeSep=this.eyeSep,ji.copy(a.projectionMatrix);let e=b.eyeSep/2,f=e*b.near/b.focus,g=b.near*Math.tan(cD*b.fov*.5)/b.zoom;jh.elements[12]=-e,jg.elements[12]=e,c=-g*b.aspect+f,d=g*b.aspect+f,ji.elements[0]=2*b.near/(d-c),ji.elements[8]=(d+c)/(d-c),this.cameraL.projectionMatrix.copy(ji),c=-g*b.aspect-f,d=g*b.aspect-f,ji.elements[0]=2*b.near/(d-c),ji.elements[8]=(d+c)/(d-c),this.cameraR.projectionMatrix.copy(ji)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(jh),this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(jg)}}class jk extends fi{constructor(a=[]){super(),this.isArrayCamera=!0,this.cameras=a,this.index=0}}class jl{constructor(a=!0){this.autoStart=a,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=jm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let b=jm();a=(b-this.oldTime)/1e3,this.oldTime=b,this.elapsedTime+=a}return a}}function jm(){return performance.now()}let jn=new dg,jo=new df,jp=new dg,jq=new dg;class jr extends ea{constructor(){super(),this.type="AudioListener",this.context=je.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new jl}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(a){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this}updateMatrixWorld(a){super.updateMatrixWorld(a);let b=this.context.listener,c=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(jn,jo,jp),jq.set(0,0,-1).applyQuaternion(jo),b.positionX){let a=this.context.currentTime+this.timeDelta;b.positionX.linearRampToValueAtTime(jn.x,a),b.positionY.linearRampToValueAtTime(jn.y,a),b.positionZ.linearRampToValueAtTime(jn.z,a),b.forwardX.linearRampToValueAtTime(jq.x,a),b.forwardY.linearRampToValueAtTime(jq.y,a),b.forwardZ.linearRampToValueAtTime(jq.z,a),b.upX.linearRampToValueAtTime(c.x,a),b.upY.linearRampToValueAtTime(c.y,a),b.upZ.linearRampToValueAtTime(c.z,a)}else b.setPosition(jn.x,jn.y,jn.z),b.setOrientation(jq.x,jq.y,jq.z,c.x,c.y,c.z)}}class js extends ea{constructor(a){super(),this.type="Audio",this.listener=a,this.context=a.context,this.gain=this.context.createGain(),this.gain.connect(a.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this}setMediaElementSource(a){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(a),this.connect(),this}setMediaStreamSource(a){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(a),this.connect(),this}setBuffer(a){return this.buffer=a,this.sourceType="buffer",this.autoplay&&this.play(),this}play(a=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+a;let b=this.context.createBufferSource();return b.buffer=this.buffer,b.loop=this.loop,b.loopStart=this.loopStart,b.loopEnd=this.loopEnd,b.onended=this.onEnded.bind(this),b.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=b,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this)}stop(a=0){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+a),this.source.onended=null),this.isPlaying=!1,this)}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(a){return a||(a=[]),!0===this._connected?(this.disconnect(),this.filters=a.slice(),this.connect()):this.filters=a.slice(),this}setDetune(a){return this.detune=a,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(a){return this.setFilters(a?[a]:[])}setPlaybackRate(a){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this)}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(a){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this)}setLoopStart(a){return this.loopStart=a,this}setLoopEnd(a){return this.loopEnd=a,this}getVolume(){return this.gain.gain.value}setVolume(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this}copy(a,b){return(super.copy(a,b),"buffer"!==a.sourceType)?console.warn("THREE.Audio: Audio source type cannot be copied."):(this.autoplay=a.autoplay,this.buffer=a.buffer,this.detune=a.detune,this.loop=a.loop,this.loopStart=a.loopStart,this.loopEnd=a.loopEnd,this.offset=a.offset,this.duration=a.duration,this.playbackRate=a.playbackRate,this.hasPlaybackControl=a.hasPlaybackControl,this.sourceType=a.sourceType,this.filters=a.filters.slice()),this}clone(a){return new this.constructor(this.listener).copy(this,a)}}let jt=new dg,ju=new df,jv=new dg,jw=new dg;class jx extends js{constructor(a){super(a),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(a){return this.panner.refDistance=a,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(a){return this.panner.rolloffFactor=a,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(a){return this.panner.distanceModel=a,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(a){return this.panner.maxDistance=a,this}setDirectionalCone(a,b,c){return this.panner.coneInnerAngle=a,this.panner.coneOuterAngle=b,this.panner.coneOuterGain=c,this}updateMatrixWorld(a){if(super.updateMatrixWorld(a),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(jt,ju,jv),jw.set(0,0,1).applyQuaternion(ju);let b=this.panner;if(b.positionX){let a=this.context.currentTime+this.listener.timeDelta;b.positionX.linearRampToValueAtTime(jt.x,a),b.positionY.linearRampToValueAtTime(jt.y,a),b.positionZ.linearRampToValueAtTime(jt.z,a),b.orientationX.linearRampToValueAtTime(jw.x,a),b.orientationY.linearRampToValueAtTime(jw.y,a),b.orientationZ.linearRampToValueAtTime(jw.z,a)}else b.setPosition(jt.x,jt.y,jt.z),b.setOrientation(jw.x,jw.y,jw.z)}}class jy{constructor(a,b=2048){this.analyser=a.context.createAnalyser(),this.analyser.fftSize=b,this.data=new Uint8Array(this.analyser.frequencyBinCount),a.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let a=0,b=this.getFrequencyData();for(let c=0;c<b.length;c++)a+=b[c];return a/b.length}}class jz{constructor(a,b,c){let d,e,f;switch(this.binding=a,this.valueSize=c,b){case"quaternion":d=this._slerp,e=this._slerpAdditive,f=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*c),this._workIndex=5;break;case"string":case"bool":d=this._select,e=this._select,f=this._setAdditiveIdentityOther,this.buffer=Array(5*c);break;default:d=this._lerp,e=this._lerpAdditive,f=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*c)}this._mixBufferRegion=d,this._mixBufferRegionAdditive=e,this._setIdentity=f,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(a,b){let c=this.buffer,d=this.valueSize,e=a*d+d,f=this.cumulativeWeight;if(0===f){for(let a=0;a!==d;++a)c[e+a]=c[a];f=b}else{f+=b;let a=b/f;this._mixBufferRegion(c,e,0,a,d)}this.cumulativeWeight=f}accumulateAdditive(a){let b=this.buffer,c=this.valueSize,d=c*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(b,d,0,a,c),this.cumulativeWeightAdditive+=a}apply(a){let b=this.valueSize,c=this.buffer,d=a*b+b,e=this.cumulativeWeight,f=this.cumulativeWeightAdditive,g=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,e<1){let a=b*this._origIndex;this._mixBufferRegion(c,d,a,1-e,b)}f>0&&this._mixBufferRegionAdditive(c,d,this._addIndex*b,1,b);for(let a=b,e=b+b;a!==e;++a)if(c[a]!==c[a+b]){g.setValue(c,d);break}}saveOriginalState(){let a=this.binding,b=this.buffer,c=this.valueSize,d=c*this._origIndex;a.getValue(b,d);for(let a=c;a!==d;++a)b[a]=b[d+a%c];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let a=3*this.valueSize;this.binding.setValue(this.buffer,a)}_setAdditiveIdentityNumeric(){let a=this._addIndex*this.valueSize,b=a+this.valueSize;for(let c=a;c<b;c++)this.buffer[c]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let a=this._origIndex*this.valueSize,b=this._addIndex*this.valueSize;for(let c=0;c<this.valueSize;c++)this.buffer[b+c]=this.buffer[a+c]}_select(a,b,c,d,e){if(d>=.5)for(let d=0;d!==e;++d)a[b+d]=a[c+d]}_slerp(a,b,c,d){df.slerpFlat(a,b,a,b,a,c,d)}_slerpAdditive(a,b,c,d,e){let f=this._workIndex*e;df.multiplyQuaternionsFlat(a,f,a,b,a,c),df.slerpFlat(a,b,a,b,a,f,d)}_lerp(a,b,c,d,e){let f=1-d;for(let g=0;g!==e;++g){let e=b+g;a[e]=a[e]*f+a[c+g]*d}}_lerpAdditive(a,b,c,d,e){for(let f=0;f!==e;++f){let e=b+f;a[e]=a[e]+a[c+f]*d}}}let jA="\\[\\]\\.:\\/",jB=RegExp("["+jA+"]","g"),jC="[^"+jA+"]",jD="[^"+jA.replace("\\.","")+"]",jE=/((?:WC+[\/:])*)/.source.replace("WC",jC),jF=/(WCOD+)?/.source.replace("WCOD",jD),jG=RegExp("^"+jE+jF+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",jC)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",jC)+"$"),jH=["material","materials","bones","map"];class jI{constructor(a,b,c){let d=c||jJ.parseTrackName(b);this._targetGroup=a,this._bindings=a.subscribe_(b,d)}getValue(a,b){this.bind();let c=this._targetGroup.nCachedObjects_,d=this._bindings[c];void 0!==d&&d.getValue(a,b)}setValue(a,b){let c=this._bindings;for(let d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)}bind(){let a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()}unbind(){let a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}}class jJ{constructor(a,b,c){this.path=b,this.parsedPath=c||jJ.parseTrackName(b),this.node=jJ.findNode(a,this.parsedPath.nodeName),this.rootNode=a,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(a,b,c){return a&&a.isAnimationObjectGroup?new jJ.Composite(a,b,c):new jJ(a,b,c)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(jB,"")}static parseTrackName(a){let b=jG.exec(a);if(null===b)throw Error("PropertyBinding: Cannot parse trackName: "+a);let c={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]},d=c.nodeName&&c.nodeName.lastIndexOf(".");if(void 0!==d&&-1!==d){let a=c.nodeName.substring(d+1);-1!==jH.indexOf(a)&&(c.nodeName=c.nodeName.substring(0,d),c.objectName=a)}if(null===c.propertyName||0===c.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return c}static findNode(a,b){if(void 0===b||""===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){let c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){let c=function(a){for(let d=0;d<a.length;d++){let e=a[d];if(e.name===b||e.uuid===b)return e;let f=c(e.children);if(f)return f}return null},d=c(a.children);if(d)return d}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,b){a[b]=this.targetObject[this.propertyName]}_getValue_array(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)a[b++]=c[d]}_getValue_arrayElement(a,b){a[b]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,b){this.resolvedProperty.toArray(a,b)}_setValue_direct(a,b){this.targetObject[this.propertyName]=a[b]}_setValue_direct_setNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++]}_setValue_array_setNeedsUpdate(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,b){this.resolvedProperty[this.propertyIndex]=a[b]}_setValue_arrayElement_setNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(a,b){this.resolvedProperty.fromArray(a,b)}_setValue_fromArray_setNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,b){this.bind(),this.getValue(a,b)}_setValue_unbound(a,b){this.bind(),this.setValue(a,b)}bind(){let a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;if(a||(a=jJ.findNode(this.rootNode,b.nodeName),this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!a)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(c){let d=b.objectIndex;switch(c){case"materials":if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);a=a.material.materials;break;case"bones":if(!a.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);a=a.skeleton.bones;for(let b=0;b<a.length;b++)if(a[b].name===d){d=b;break}break;case"map":if("map"in a){a=a.map;break}if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);a=a.material.map;break;default:if(void 0===a[c])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);a=a[c]}if(void 0!==d){if(void 0===a[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);a=a[d]}}let f=a[d];if(void 0===f)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a);let g=this.Versioning.None;this.targetObject=a,!0===a.isMaterial?g=this.Versioning.NeedsUpdate:!0===a.isObject3D&&(g=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!a.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==a.morphTargetDictionary[e]&&(e=a.morphTargetDictionary[e])}h=this.BindingType.ArrayElement,this.resolvedProperty=f,this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(h=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][g]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}jJ.Composite=jI,jJ.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},jJ.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},jJ.prototype.GetterByBindingType=[jJ.prototype._getValue_direct,jJ.prototype._getValue_array,jJ.prototype._getValue_arrayElement,jJ.prototype._getValue_toArray],jJ.prototype.SetterByBindingTypeAndVersioning=[[jJ.prototype._setValue_direct,jJ.prototype._setValue_direct_setNeedsUpdate,jJ.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[jJ.prototype._setValue_array,jJ.prototype._setValue_array_setNeedsUpdate,jJ.prototype._setValue_array_setMatrixWorldNeedsUpdate],[jJ.prototype._setValue_arrayElement,jJ.prototype._setValue_arrayElement_setNeedsUpdate,jJ.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[jJ.prototype._setValue_fromArray,jJ.prototype._setValue_fromArray_setNeedsUpdate,jJ.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class jK{constructor(){this.isAnimationObjectGroup=!0,this.uuid=cF(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let a={};this._indicesByUUID=a;for(let b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=b;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let b=this;this.stats={objects:{get total(){return b._objects.length},get inUse(){return this.total-b.nCachedObjects_}},get bindingsPerObject(){return b._bindings.length}}}add(){let a=this._objects,b=this._indicesByUUID,c=this._paths,d=this._parsedPaths,e=this._bindings,f=e.length,g,h=a.length,i=this.nCachedObjects_;for(let j=0,k=arguments.length;j!==k;++j){let k=arguments[j],l=k.uuid,m=b[l];if(void 0===m){m=h++,b[l]=m,a.push(k);for(let a=0;a!==f;++a)e[a].push(new jJ(k,c[a],d[a]))}else if(m<i){g=a[m];let h=--i,j=a[h];b[j.uuid]=m,a[m]=j,b[l]=h,a[h]=k;for(let a=0;a!==f;++a){let b=e[a],f=b[h],g=b[m];b[m]=f,void 0===g&&(g=new jJ(k,c[a],d[a])),b[h]=g}}else a[m]!==g&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i}remove(){let a=this._objects,b=this._indicesByUUID,c=this._bindings,d=c.length,e=this.nCachedObjects_;for(let f=0,g=arguments.length;f!==g;++f){let g=arguments[f],h=g.uuid,i=b[h];if(void 0!==i&&i>=e){let f=e++,j=a[f];b[j.uuid]=i,a[i]=j,b[h]=f,a[f]=g;for(let a=0;a!==d;++a){let b=c[a],d=b[f],e=b[i];b[i]=d,b[f]=e}}}this.nCachedObjects_=e}uncache(){let a=this._objects,b=this._indicesByUUID,c=this._bindings,d=c.length,e=this.nCachedObjects_,f=a.length;for(let g=0,h=arguments.length;g!==h;++g){let h=arguments[g],i=h.uuid,j=b[i];if(void 0!==j)if(delete b[i],j<e){let g=--e,h=a[g],i=--f,k=a[i];b[h.uuid]=j,a[j]=h,b[k.uuid]=g,a[g]=k,a.pop();for(let a=0;a!==d;++a){let b=c[a],d=b[g],e=b[i];b[j]=d,b[g]=e,b.pop()}}else{let e=--f,g=a[e];e>0&&(b[g.uuid]=j),a[j]=g,a.pop();for(let a=0;a!==d;++a){let b=c[a];b[j]=b[e],b.pop()}}}this.nCachedObjects_=e}subscribe_(a,b){let c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];let f=this._paths,g=this._parsedPaths,h=this._objects,i=h.length,j=this.nCachedObjects_,k=Array(i);d=e.length,c[a]=d,f.push(a),g.push(b),e.push(k);for(let c=j,d=h.length;c!==d;++c){let d=h[c];k[c]=new jJ(d,a,b)}return k}unsubscribe_(a){let b=this._bindingsIndicesByPath,c=b[a];if(void 0!==c){let d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];b[a[g]]=c,f[c]=h,f.pop(),e[c]=e[g],e.pop(),d[c]=d[g],d.pop()}}}class jL{constructor(a,b,c=null,d=b.blendMode){this._mixer=a,this._clip=b,this._localRoot=c,this.blendMode=d;let e=b.tracks,f=e.length,g=Array(f),h={endingStart:bH,endingEnd:bH};for(let a=0;a!==f;++a){let b=e[a].createInterpolant(null);g[a]=b,b.settings=h}this._interpolantSettings=h,this._interpolants=g,this._propertyBindings=Array(f),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=bC,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(a){return this._startTime=a,this}setLoop(a,b){return this.loop=a,this.repetitions=b,this}setEffectiveWeight(a){return this.weight=a,this._effectiveWeight=this.enabled?a:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(a){return this._scheduleFading(a,0,1)}fadeOut(a){return this._scheduleFading(a,1,0)}crossFadeFrom(a,b,c){if(a.fadeOut(b),this.fadeIn(b),c){let c=this._clip.duration,d=a._clip.duration;a.warp(1,d/c,b),this.warp(c/d,1,b)}return this}crossFadeTo(a,b,c){return a.crossFadeFrom(this,b,c)}stopFading(){let a=this._weightInterpolant;return null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this}setEffectiveTimeScale(a){return this.timeScale=a,this._effectiveTimeScale=this.paused?0:a,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(a){return this.timeScale=this._clip.duration/a,this.stopWarping()}syncWith(a){return this.time=a.time,this.timeScale=a.timeScale,this.stopWarping()}halt(a){return this.warp(this._effectiveTimeScale,0,a)}warp(a,b,c){let d=this._mixer,e=d.time,f=this.timeScale,g=this._timeScaleInterpolant;null===g&&(g=d._lendControlInterpolant(),this._timeScaleInterpolant=g);let h=g.parameterPositions,i=g.sampleValues;return h[0]=e,h[1]=e+c,i[0]=a/f,i[1]=b/f,this}stopWarping(){let a=this._timeScaleInterpolant;return null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(a,b,c,d){if(!this.enabled)return void this._updateWeight(a);let e=this._startTime;if(null!==e){let d=(a-e)*c;d<0||0===c?b=0:(this._startTime=null,b=c*d)}b*=this._updateTimeScale(a);let f=this._updateTime(b),g=this._updateWeight(a);if(g>0){let a=this._interpolants,b=this._propertyBindings;if(this.blendMode===bL)for(let c=0,d=a.length;c!==d;++c)a[c].evaluate(f),b[c].accumulateAdditive(g);else for(let c=0,e=a.length;c!==e;++c)a[c].evaluate(f),b[c].accumulate(d,g)}}_updateWeight(a){let b=0;if(this.enabled){b=this.weight;let c=this._weightInterpolant;if(null!==c){let d=c.evaluate(a)[0];b*=d,a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b,b}_updateTimeScale(a){let b=0;if(!this.paused){b=this.timeScale;let c=this._timeScaleInterpolant;null!==c&&(b*=c.evaluate(a)[0],a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b))}return this._effectiveTimeScale=b,b}_updateTime(a){let b=this._clip.duration,c=this.loop,d=this.time+a,e=this._loopCount,f=c===bD;if(0===a)return -1===e?d:f&&(1&e)==1?b-d:d;if(c===bB){-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(d>=b)d=b;else if(d<0)d=0;else{this.time=d;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=d,this._mixer.dispatchEvent({type:"finished",action:this,direction:a<0?-1:1})}}else{if(-1===e&&(a>=0?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f)),d>=b||d<0){let c=Math.floor(d/b);d-=b*c,e+=Math.abs(c);let g=this.repetitions-e;if(g<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,d=a>0?b:0,this.time=d,this._mixer.dispatchEvent({type:"finished",action:this,direction:a>0?1:-1});else{if(1===g){let b=a<0;this._setEndings(b,!b,f)}else this._setEndings(!1,!1,f);this._loopCount=e,this.time=d,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=d;if(f&&(1&e)==1)return b-d}return d}_setEndings(a,b,c){let d=this._interpolantSettings;c?(d.endingStart=bI,d.endingEnd=bI):(a?d.endingStart=this.zeroSlopeAtStart?bI:bH:d.endingStart=bJ,b?d.endingEnd=this.zeroSlopeAtEnd?bI:bH:d.endingEnd=bJ)}_scheduleFading(a,b,c){let d=this._mixer,e=d.time,f=this._weightInterpolant;null===f&&(f=d._lendControlInterpolant(),this._weightInterpolant=f);let g=f.parameterPositions,h=f.sampleValues;return g[0]=e,h[0]=b,g[1]=e+a,h[1]=c,this}}let jM=new Float32Array(1);class jN extends cA{constructor(a){super(),this._root=a,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(a,b){let c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings,g=a._interpolants,h=c.uuid,i=this._bindingsByRootAndName,j=i[h];void 0===j&&(j={},i[h]=j);for(let a=0;a!==e;++a){let e=d[a],i=e.name,k=j[i];if(void 0!==k)++k.referenceCount,f[a]=k;else{if(void 0!==(k=f[a])){null===k._cacheIndex&&(++k.referenceCount,this._addInactiveBinding(k,h,i));continue}let d=b&&b._propertyBindings[a].binding.parsedPath;k=new jz(jJ.create(c,i,d),e.ValueTypeName,e.getValueSize()),++k.referenceCount,this._addInactiveBinding(k,h,i),f[a]=k}g[a].resultBuffer=k.buffer}}_activateAction(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){let b=(a._localRoot||this._root).uuid,c=a._clip.uuid,d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]),this._addInactiveAction(a,c,b)}let b=a._propertyBindings;for(let a=0,c=b.length;a!==c;++a){let c=b[a];0==c.useCount++&&(this._lendBinding(c),c.saveOriginalState())}this._lendAction(a)}}_deactivateAction(a){if(this._isActiveAction(a)){let b=a._propertyBindings;for(let a=0,c=b.length;a!==c;++a){let c=b[a];0==--c.useCount&&(c.restoreOriginalState(),this._takeBackBinding(c))}this._takeBackAction(a)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}}_isActiveAction(a){let b=a._cacheIndex;return null!==b&&b<this._nActiveActions}_addInactiveAction(a,b,c){let d=this._actions,e=this._actionsByClip,f=e[b];if(void 0===f)f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f;else{let b=f.knownActions;a._byClipCacheIndex=b.length,b.push(a)}a._cacheIndex=d.length,d.push(a),f.actionByRoot[c]=a}_removeInactiveAction(a){let b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d,b[d]=c,b.pop(),a._cacheIndex=null;let e=a._clip.uuid,f=this._actionsByClip,g=f[e],h=g.knownActions,i=h[h.length-1],j=a._byClipCacheIndex;i._byClipCacheIndex=j,h[j]=i,h.pop(),a._byClipCacheIndex=null;let k=g.actionByRoot,l=(a._localRoot||this._root).uuid;delete k[l],0===h.length&&delete f[e],this._removeInactiveBindingsForAction(a)}_removeInactiveBindingsForAction(a){let b=a._propertyBindings;for(let a=0,c=b.length;a!==c;++a){let c=b[a];0==--c.referenceCount&&this._removeInactiveBinding(c)}}_lendAction(a){let b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e}_takeBackAction(a){let b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e}_addInactiveBinding(a,b,c){let d=this._bindingsByRootAndName,e=this._bindings,f=d[b];void 0===f&&(f={},d[b]=f),f[c]=a,a._cacheIndex=e.length,e.push(a)}_removeInactiveBinding(a){let b=this._bindings,c=a.binding,d=c.rootNode.uuid,e=c.path,f=this._bindingsByRootAndName,g=f[d],h=b[b.length-1],i=a._cacheIndex;h._cacheIndex=i,b[i]=h,b.pop(),delete g[e],0===Object.keys(g).length&&delete f[d]}_lendBinding(a){let b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e}_takeBackBinding(a){let b=this._bindings,c=a._cacheIndex,d=--this._nActiveBindings,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e}_lendControlInterpolant(){let a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];return void 0===c&&((c=new ip(new Float32Array(2),new Float32Array(2),1,jM)).__cacheIndex=b,a[b]=c),c}_takeBackControlInterpolant(a){let b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d,b[d]=a,e.__cacheIndex=c,b[c]=e}clipAction(a,b,c){let d=b||this._root,e=d.uuid,f="string"==typeof a?iz.findByName(d,a):a,g=null!==f?f.uuid:a,h=this._actionsByClip[g],i=null;if(void 0===c&&(c=null!==f?f.blendMode:bK),void 0!==h){let a=h.actionByRoot[e];if(void 0!==a&&a.blendMode===c)return a;i=h.knownActions[0],null===f&&(f=i._clip)}if(null===f)return null;let j=new jL(this,f,b,c);return this._bindAction(j,i),this._addInactiveAction(j,g,e),j}existingAction(a,b){let c=b||this._root,d=c.uuid,e="string"==typeof a?iz.findByName(c,a):a,f=e?e.uuid:a,g=this._actionsByClip[f];return void 0!==g&&g.actionByRoot[d]||null}stopAllAction(){let a=this._actions,b=this._nActiveActions;for(let c=b-1;c>=0;--c)a[c].stop();return this}update(a){a*=this.timeScale;let b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1;for(let g=0;g!==c;++g)b[g]._update(d,a,e,f);let g=this._bindings,h=this._nActiveBindings;for(let a=0;a!==h;++a)g[a].apply(f);return this}setTime(a){this.time=0;for(let a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(a)}getRoot(){return this._root}uncacheClip(a){let b=this._actions,c=a.uuid,d=this._actionsByClip,e=d[c];if(void 0!==e){let a=e.knownActions;for(let c=0,d=a.length;c!==d;++c){let d=a[c];this._deactivateAction(d);let e=d._cacheIndex,f=b[b.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,f._cacheIndex=e,b[e]=f,b.pop(),this._removeInactiveBindingsForAction(d)}delete d[c]}}uncacheRoot(a){let b=a.uuid,c=this._actionsByClip;for(let a in c){let d=c[a].actionByRoot[b];void 0!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}let d=this._bindingsByRootAndName[b];if(void 0!==d)for(let a in d){let b=d[a];b.restoreOriginalState(),this._removeInactiveBinding(b)}}uncacheAction(a,b){let c=this.existingAction(a,b);null!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}}class jO extends c9{constructor(a=1,b=1,c=1,d={}){super(a,b,d),this.isRenderTarget3D=!0,this.depth=c,this.texture=new dd(null,a,b,c),this.texture.isRenderTargetTexture=!0}}class jP extends c9{constructor(a=1,b=1,c=1,d={}){super(a,b,d),this.isRenderTargetArray=!0,this.depth=c,this.texture=new db(null,a,b,c),this.texture.isRenderTargetTexture=!0}}class jQ{constructor(a){this.value=a}clone(){return new jQ(void 0===this.value.clone?this.value:this.value.clone())}}let jR=0;class jS extends cA{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:jR++}),this.name="",this.usage=cm,this.uniforms=[]}add(a){return this.uniforms.push(a),this}remove(a){let b=this.uniforms.indexOf(a);return -1!==b&&this.uniforms.splice(b,1),this}setName(a){return this.name=a,this}setUsage(a){return this.usage=a,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(a){this.name=a.name,this.usage=a.usage;let b=a.uniforms;this.uniforms.length=0;for(let a=0,c=b.length;a<c;a++){let c=Array.isArray(b[a])?b[a]:[b[a]];for(let a=0;a<c.length;a++)this.uniforms.push(c[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class jT extends fs{constructor(a,b,c=1){super(a,b),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=c}copy(a){return super.copy(a),this.meshPerAttribute=a.meshPerAttribute,this}clone(a){let b=super.clone(a);return b.meshPerAttribute=this.meshPerAttribute,b}toJSON(a){let b=super.toJSON(a);return b.isInstancedInterleavedBuffer=!0,b.meshPerAttribute=this.meshPerAttribute,b}}class jU{constructor(a,b,c,d,e){this.isGLBufferAttribute=!0,this.name="",this.buffer=a,this.type=b,this.itemSize=c,this.elementSize=d,this.count=e,this.version=0}set needsUpdate(a){!0===a&&this.version++}setBuffer(a){return this.buffer=a,this}setType(a,b){return this.type=a,this.elementSize=b,this}setItemSize(a){return this.itemSize=a,this}setCount(a){return this.count=a,this}}let jV=new dL;class jW{constructor(a,b,c=0,d=1/0){this.ray=new dK(a,b),this.near=c,this.far=d,this.camera=null,this.layers=new dW,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(a,b){this.ray.set(a,b)}setFromCamera(a,b){b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize(),this.camera=b):b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld),this.camera=b):console.error("THREE.Raycaster: Unsupported camera type: "+b.type)}setFromXRController(a){return jV.identity().extractRotation(a.matrixWorld),this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(jV),this}intersectObject(a,b=!0,c=[]){return jY(a,this,c,b),c.sort(jX),c}intersectObjects(a,b=!0,c=[]){for(let d=0,e=a.length;d<e;d++)jY(a[d],this,c,b);return c.sort(jX),c}}function jX(a,b){return a.distance-b.distance}function jY(a,b,c,d){let e=!0;if(a.layers.test(b.layers)&&!1===a.raycast(b,c)&&(e=!1),!0===e&&!0===d){let d=a.children;for(let a=0,e=d.length;a<e;a++)jY(d[a],b,c,!0)}}class jZ{constructor(a=1,b=0,c=0){return this.radius=a,this.phi=b,this.theta=c,this}set(a,b,c){return this.radius=a,this.phi=b,this.theta=c,this}copy(a){return this.radius=a.radius,this.phi=a.phi,this.theta=a.theta,this}makeSafe(){return this.phi=cG(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,b,c){return this.radius=Math.sqrt(a*a+b*b+c*c),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(a,c),this.phi=Math.acos(cG(b/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class j${constructor(a=1,b=0,c=0){return this.radius=a,this.theta=b,this.y=c,this}set(a,b,c){return this.radius=a,this.theta=b,this.y=c,this}copy(a){return this.radius=a.radius,this.theta=a.theta,this.y=a.y,this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,b,c){return this.radius=Math.sqrt(a*a+c*c),this.theta=Math.atan2(a,c),this.y=b,this}clone(){return new this.constructor().copy(this)}}class j_{constructor(a,b,c,d){j_.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==a&&this.set(a,b,c,d)}identity(){return this.set(1,0,0,1),this}fromArray(a,b=0){for(let c=0;c<4;c++)this.elements[c]=a[c+b];return this}set(a,b,c,d){let e=this.elements;return e[0]=a,e[2]=b,e[1]=c,e[3]=d,this}}let j0=new cM;class j1{constructor(a=new cM(Infinity,Infinity),b=new cM(-1/0,-1/0)){this.isBox2=!0,this.min=a,this.max=b}set(a,b){return this.min.copy(a),this.max.copy(b),this}setFromPoints(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){let c=j0.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(c),this.max.copy(a).add(c),this}clone(){return new this.constructor().copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&a.max.y>=this.min.y&&a.min.y<=this.max.y}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,j0).distanceTo(a)}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}let j2=new dg,j3=new dg;class j4{constructor(a=new dg,b=new dg){this.start=a,this.end=b}set(a,b){return this.start.copy(a),this.end.copy(b),this}copy(a){return this.start.copy(a.start),this.end.copy(a.end),this}getCenter(a){return a.addVectors(this.start,this.end).multiplyScalar(.5)}delta(a){return a.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(a,b){return this.delta(b).multiplyScalar(a).add(this.start)}closestPointToPointParameter(a,b){j2.subVectors(a,this.start),j3.subVectors(this.end,this.start);let c=j3.dot(j3),d=j3.dot(j2)/c;return b&&(d=cG(d,0,1)),d}closestPointToPoint(a,b,c){let d=this.closestPointToPointParameter(a,b);return this.delta(c).multiplyScalar(d).add(this.start)}applyMatrix4(a){return this.start.applyMatrix4(a),this.end.applyMatrix4(a),this}equals(a){return a.start.equals(this.start)&&a.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}let j5=new dg;class j6 extends ea{constructor(a,b){super(),this.light=a,this.matrixAutoUpdate=!1,this.color=b,this.type="SpotLightHelper";let c=new eW,d=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,b=1;a<32;a++,b++){let c=a/32*Math.PI*2,e=b/32*Math.PI*2;d.push(Math.cos(c),Math.sin(c),1,Math.cos(e),Math.sin(e),1)}c.setAttribute("position",new eO(d,3));let e=new gx({fog:!1,toneMapped:!1});this.cone=new gJ(c,e),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);let a=this.light.distance?this.light.distance:1e3,b=a*Math.tan(this.light.angle);this.cone.scale.set(b,b,a),j5.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(j5),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}let j7=new dg,j8=new dL,j9=new dL;class ka extends gJ{constructor(a){let b=function a(b){let c=[];!0===b.isBone&&c.push(b);for(let d=0;d<b.children.length;d++)c.push.apply(c,a(b.children[d]));return c}(a),c=new eW,d=[],e=[],f=new et(0,0,1),g=new et(0,1,0);for(let a=0;a<b.length;a++){let c=b[a];c.parent&&c.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(f.r,f.g,f.b),e.push(g.r,g.g,g.b))}c.setAttribute("position",new eO(d,3)),c.setAttribute("color",new eO(e,3)),super(c,new gx({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=a,this.bones=b,this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(a){let b=this.bones,c=this.geometry,d=c.getAttribute("position");j9.copy(this.root.matrixWorld).invert();for(let a=0,c=0;a<b.length;a++){let e=b[a];e.parent&&e.parent.isBone&&(j8.multiplyMatrices(j9,e.matrixWorld),j7.setFromMatrixPosition(j8),d.setXYZ(c,j7.x,j7.y,j7.z),j8.multiplyMatrices(j9,e.parent.matrixWorld),j7.setFromMatrixPosition(j8),d.setXYZ(c+1,j7.x,j7.y,j7.z),c+=2)}c.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(a)}dispose(){this.geometry.dispose(),this.material.dispose()}}class kb extends e6{constructor(a,b,c){super(new hX(b,4,2),new ex({wireframe:!0,fog:!1,toneMapped:!1})),this.light=a,this.color=c,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}let kc=new dg,kd=new et,ke=new et;class kf extends ea{constructor(a,b,c){super(),this.light=a,this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.color=c,this.type="HemisphereLightHelper";let d=new hT(b);d.rotateY(.5*Math.PI),this.material=new ex({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);let e=new Float32Array(3*d.getAttribute("position").count);d.setAttribute("color",new eF(e,3)),this.add(new e6(d,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let a=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{let b=a.geometry.getAttribute("color");kd.copy(this.light.color),ke.copy(this.light.groundColor);for(let a=0,c=b.count;a<c;a++){let d=a<c/2?kd:ke;b.setXYZ(a,d.r,d.g,d.b)}b.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),a.lookAt(kc.setFromMatrixPosition(this.light.matrixWorld).negate())}}class kg extends gJ{constructor(a=10,b=10,c=4473924,d=8947848){c=new et(c),d=new et(d);let e=b/2,f=a/b,g=a/2,h=[],i=[];for(let a=0,j=0,k=-g;a<=b;a++,k+=f){h.push(-g,0,k,g,0,k),h.push(k,0,-g,k,0,g);let b=a===e?c:d;b.toArray(i,j),j+=3,b.toArray(i,j),j+=3,b.toArray(i,j),j+=3,b.toArray(i,j),j+=3}let j=new eW;j.setAttribute("position",new eO(h,3)),j.setAttribute("color",new eO(i,3)),super(j,new gx({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class kh extends gJ{constructor(a=10,b=16,c=8,d=64,e=4473924,f=8947848){e=new et(e),f=new et(f);let g=[],h=[];if(b>1)for(let c=0;c<b;c++){let d=c/b*(2*Math.PI),i=Math.sin(d)*a,j=Math.cos(d)*a;g.push(0,0,0),g.push(i,0,j);let k=1&c?e:f;h.push(k.r,k.g,k.b),h.push(k.r,k.g,k.b)}for(let b=0;b<c;b++){let i=1&b?e:f,j=a-a/c*b;for(let a=0;a<d;a++){let b=a/d*(2*Math.PI),c=Math.sin(b)*j,e=Math.cos(b)*j;g.push(c,0,e),h.push(i.r,i.g,i.b),c=Math.sin(b=(a+1)/d*(2*Math.PI))*j,e=Math.cos(b)*j,g.push(c,0,e),h.push(i.r,i.g,i.b)}}let i=new eW;i.setAttribute("position",new eO(g,3)),i.setAttribute("color",new eO(h,3)),super(i,new gx({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}let ki=new dg,kj=new dg,kk=new dg;class kl extends ea{constructor(a,b,c){super(),this.light=a,this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.color=c,this.type="DirectionalLightHelper",void 0===b&&(b=1);let d=new eW;d.setAttribute("position",new eO([-b,b,0,b,b,0,b,-b,0,-b,-b,0,-b,b,0],3));let e=new gx({fog:!1,toneMapped:!1});this.lightPlane=new gF(d,e),this.add(this.lightPlane),(d=new eW).setAttribute("position",new eO([0,0,0,0,0,1],3)),this.targetLine=new gF(d,e),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),ki.setFromMatrixPosition(this.light.matrixWorld),kj.setFromMatrixPosition(this.light.target.matrixWorld),kk.subVectors(kj,ki),this.lightPlane.lookAt(kj),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(kj),this.targetLine.scale.z=kk.length()}}let km=new dg,kn=new fe;class ko extends gJ{constructor(a){let b=new eW,c=new gx({color:0xffffff,vertexColors:!0,toneMapped:!1}),d=[],e=[],f={};function g(a,b){h(a),h(b)}function h(a){d.push(0,0,0),e.push(0,0,0),void 0===f[a]&&(f[a]=[]),f[a].push(d.length/3-1)}g("n1","n2"),g("n2","n4"),g("n4","n3"),g("n3","n1"),g("f1","f2"),g("f2","f4"),g("f4","f3"),g("f3","f1"),g("n1","f1"),g("n2","f2"),g("n3","f3"),g("n4","f4"),g("p","n1"),g("p","n2"),g("p","n3"),g("p","n4"),g("u1","u2"),g("u2","u3"),g("u3","u1"),g("c","t"),g("p","c"),g("cn1","cn2"),g("cn3","cn4"),g("cf1","cf2"),g("cf3","cf4"),b.setAttribute("position",new eO(d,3)),b.setAttribute("color",new eO(e,3)),super(b,c),this.type="CameraHelper",this.camera=a,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=f,this.update();let i=new et(0xffaa00),j=new et(0xff0000),k=new et(43775),l=new et(0xffffff),m=new et(3355443);this.setColors(i,j,k,l,m)}setColors(a,b,c,d,e){let f=this.geometry.getAttribute("color");f.setXYZ(0,a.r,a.g,a.b),f.setXYZ(1,a.r,a.g,a.b),f.setXYZ(2,a.r,a.g,a.b),f.setXYZ(3,a.r,a.g,a.b),f.setXYZ(4,a.r,a.g,a.b),f.setXYZ(5,a.r,a.g,a.b),f.setXYZ(6,a.r,a.g,a.b),f.setXYZ(7,a.r,a.g,a.b),f.setXYZ(8,a.r,a.g,a.b),f.setXYZ(9,a.r,a.g,a.b),f.setXYZ(10,a.r,a.g,a.b),f.setXYZ(11,a.r,a.g,a.b),f.setXYZ(12,a.r,a.g,a.b),f.setXYZ(13,a.r,a.g,a.b),f.setXYZ(14,a.r,a.g,a.b),f.setXYZ(15,a.r,a.g,a.b),f.setXYZ(16,a.r,a.g,a.b),f.setXYZ(17,a.r,a.g,a.b),f.setXYZ(18,a.r,a.g,a.b),f.setXYZ(19,a.r,a.g,a.b),f.setXYZ(20,a.r,a.g,a.b),f.setXYZ(21,a.r,a.g,a.b),f.setXYZ(22,a.r,a.g,a.b),f.setXYZ(23,a.r,a.g,a.b),f.setXYZ(24,b.r,b.g,b.b),f.setXYZ(25,b.r,b.g,b.b),f.setXYZ(26,b.r,b.g,b.b),f.setXYZ(27,b.r,b.g,b.b),f.setXYZ(28,b.r,b.g,b.b),f.setXYZ(29,b.r,b.g,b.b),f.setXYZ(30,b.r,b.g,b.b),f.setXYZ(31,b.r,b.g,b.b),f.setXYZ(32,c.r,c.g,c.b),f.setXYZ(33,c.r,c.g,c.b),f.setXYZ(34,c.r,c.g,c.b),f.setXYZ(35,c.r,c.g,c.b),f.setXYZ(36,c.r,c.g,c.b),f.setXYZ(37,c.r,c.g,c.b),f.setXYZ(38,d.r,d.g,d.b),f.setXYZ(39,d.r,d.g,d.b),f.setXYZ(40,e.r,e.g,e.b),f.setXYZ(41,e.r,e.g,e.b),f.setXYZ(42,e.r,e.g,e.b),f.setXYZ(43,e.r,e.g,e.b),f.setXYZ(44,e.r,e.g,e.b),f.setXYZ(45,e.r,e.g,e.b),f.setXYZ(46,e.r,e.g,e.b),f.setXYZ(47,e.r,e.g,e.b),f.setXYZ(48,e.r,e.g,e.b),f.setXYZ(49,e.r,e.g,e.b),f.needsUpdate=!0}update(){let a=this.geometry,b=this.pointMap;kn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);let c=this.camera.coordinateSystem===cx?-1:0;kp("c",b,a,kn,0,0,c),kp("t",b,a,kn,0,0,1),kp("n1",b,a,kn,-1,-1,c),kp("n2",b,a,kn,1,-1,c),kp("n3",b,a,kn,-1,1,c),kp("n4",b,a,kn,1,1,c),kp("f1",b,a,kn,-1,-1,1),kp("f2",b,a,kn,1,-1,1),kp("f3",b,a,kn,-1,1,1),kp("f4",b,a,kn,1,1,1),kp("u1",b,a,kn,.7,1.1,c),kp("u2",b,a,kn,-.7,1.1,c),kp("u3",b,a,kn,0,2,c),kp("cf1",b,a,kn,-1,0,1),kp("cf2",b,a,kn,1,0,1),kp("cf3",b,a,kn,0,-1,1),kp("cf4",b,a,kn,0,1,1),kp("cn1",b,a,kn,-1,0,c),kp("cn2",b,a,kn,1,0,c),kp("cn3",b,a,kn,0,-1,c),kp("cn4",b,a,kn,0,1,c),a.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function kp(a,b,c,d,e,f,g){km.set(e,f,g).unproject(d);let h=b[a];if(void 0!==h){let a=c.getAttribute("position");for(let b=0,c=h.length;b<c;b++)a.setXYZ(h[b],km.x,km.y,km.z)}}let kq=new dj;class kr extends gJ{constructor(a,b=0xffff00){let c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Float32Array(24),e=new eW;e.setIndex(new eF(c,1)),e.setAttribute("position",new eF(d,3)),super(e,new gx({color:b,toneMapped:!1})),this.object=a,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(a){if(void 0!==a&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&kq.setFromObject(this.object),kq.isEmpty())return;let b=kq.min,c=kq.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x,e[1]=c.y,e[2]=c.z,e[3]=b.x,e[4]=c.y,e[5]=c.z,e[6]=b.x,e[7]=b.y,e[8]=c.z,e[9]=c.x,e[10]=b.y,e[11]=c.z,e[12]=c.x,e[13]=c.y,e[14]=b.z,e[15]=b.x,e[16]=c.y,e[17]=b.z,e[18]=b.x,e[19]=b.y,e[20]=b.z,e[21]=c.x,e[22]=b.y,e[23]=b.z,d.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(a){return this.object=a,this.update(),this}copy(a,b){return super.copy(a,b),this.object=a.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ks extends gJ{constructor(a,b=0xffff00){let c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new eW;d.setIndex(new eF(c,1)),d.setAttribute("position",new eO([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(d,new gx({color:b,toneMapped:!1})),this.box=a,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(a){let b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(a))}dispose(){this.geometry.dispose(),this.material.dispose()}}class kt extends gF{constructor(a,b=1,c=0xffff00){let d=new eW;d.setAttribute("position",new eO([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),d.computeBoundingSphere(),super(d,new gx({color:c,toneMapped:!1})),this.type="PlaneHelper",this.plane=a,this.size=b;let e=new eW;e.setAttribute("position",new eO([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),e.computeBoundingSphere(),this.add(new e6(e,new ex({color:c,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(a){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(a)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}let ku=new dg;class kv extends ea{constructor(a=new dg(0,0,1),b=new dg(0,0,0),c=1,d=0xffff00,e=.2*c,f=.2*e){super(),this.type="ArrowHelper",void 0===g&&((g=new eW).setAttribute("position",new eO([0,0,0,0,1,0],3)),(h=new hn(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(b),this.line=new gF(g,new gx({color:d,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new e6(h,new ex({color:d,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(a),this.setLength(c,e,f)}setDirection(a){if(a.y>.99999)this.quaternion.set(0,0,0,1);else if(a.y<-.99999)this.quaternion.set(1,0,0,0);else{ku.set(a.z,0,-a.x).normalize();let b=Math.acos(a.y);this.quaternion.setFromAxisAngle(ku,b)}}setLength(a,b=.2*a,c=.2*b){this.line.scale.set(1,Math.max(1e-4,a-b),1),this.line.updateMatrix(),this.cone.scale.set(c,b,c),this.cone.position.y=a,this.cone.updateMatrix()}setColor(a){this.line.material.color.set(a),this.cone.material.color.set(a)}copy(a){return super.copy(a,!1),this.line.copy(a.line),this.cone.copy(a.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class kw extends gJ{constructor(a=1){let b=new eW;b.setAttribute("position",new eO([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a],3)),b.setAttribute("color",new eO([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(b,new gx({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(a,b,c){let d=new et,e=this.geometry.attributes.color.array;return d.set(a),d.toArray(e,0),d.toArray(e,3),d.set(b),d.toArray(e,6),d.toArray(e,9),d.set(c),d.toArray(e,12),d.toArray(e,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class kx{constructor(){this.type="ShapePath",this.color=new et,this.subPaths=[],this.currentPath=null}moveTo(a,b){return this.currentPath=new hj,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,b),this}lineTo(a,b){return this.currentPath.lineTo(a,b),this}quadraticCurveTo(a,b,c,d){return this.currentPath.quadraticCurveTo(a,b,c,d),this}bezierCurveTo(a,b,c,d,e,f){return this.currentPath.bezierCurveTo(a,b,c,d,e,f),this}splineThru(a){return this.currentPath.splineThru(a),this}toShapes(a){let b,c,d,e,f,g=hN.isClockWise,h=this.subPaths;if(0===h.length)return[];let i=[];if(1===h.length)return c=h[0],(d=new hw).curves=c.curves,i.push(d),i;let j=!g(h[0].getPoints());j=a?!j:j;let k=[],l=[],m=[],n=0;l[0]=void 0,m[n]=[];for(let d=0,f=h.length;d<f;d++)b=g(e=(c=h[d]).getPoints()),(b=a?!b:b)?(!j&&l[n]&&n++,l[n]={s:new hw,p:e},l[n].s.curves=c.curves,j&&n++,m[n]=[]):m[n].push({h:c,p:e[0]});if(!l[0])return function(a){let b=[];for(let c=0,d=a.length;c<d;c++){let d=a[c],e=new hw;e.curves=d.curves,b.push(e)}return b}(h);if(l.length>1){let a=!1,b=0;for(let a=0,b=l.length;a<b;a++)k[a]=[];for(let c=0,d=l.length;c<d;c++){let d=m[c];for(let e=0;e<d.length;e++){let f=d[e],g=!0;for(let d=0;d<l.length;d++)(function(a,b){let c=b.length,d=!1;for(let e=c-1,f=0;f<c;e=f++){let c=b[e],g=b[f],h=g.x-c.x,i=g.y-c.y;if(Math.abs(i)>Number.EPSILON){if(i<0&&(c=b[f],h=-h,g=b[e],i=-i),a.y<c.y||a.y>g.y)continue;if(a.y===c.y){if(a.x===c.x)return!0}else{let b=i*(a.x-c.x)-h*(a.y-c.y);if(0===b)return!0;if(b<0)continue;d=!d}}else{if(a.y!==c.y)continue;if(g.x<=a.x&&a.x<=c.x||c.x<=a.x&&a.x<=g.x)return!0}}return d})(f.p,l[d].p)&&(c!==d&&b++,g?(g=!1,k[d].push(f)):a=!0);g&&k[c].push(f)}}b>0&&!1===a&&(m=k)}for(let a=0,b=l.length;a<b;a++){d=l[a].s,i.push(d),f=m[a];for(let a=0,b=f.length;a<b;a++)d.holes.push(f[a].h)}return i}}class ky extends cA{constructor(a,b=null){super(),this.object=a,this.domElement=b,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function kz(a,b,c,d){let e=function(a){switch(a){case aI:case aJ:return{byteLength:1,components:1};case aL:case aK:case aP:return{byteLength:2,components:1};case aQ:case aR:return{byteLength:2,components:4};case aN:case aM:case aO:return{byteLength:4,components:1};case aT:return{byteLength:4,components:3}}throw Error(`Unknown texture type ${a}.`)}(d);switch(c){case aU:case aX:return a*b;case aY:return a*b*2;case a_:case a0:return a*b/e.components*e.byteLength;case a1:case a2:return a*b*2/e.components*e.byteLength;case aV:return a*b*3/e.components*e.byteLength;case aW:case a4:return a*b*4/e.components*e.byteLength;case a5:case a6:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*8;case a7:case a8:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*16;case ba:case bc:return Math.max(a,16)*Math.max(b,8)/4;case a9:case bb:return Math.max(a,8)*Math.max(b,8)/2;case bd:case be:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*8;case bf:case bg:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*16;case bh:return Math.floor((a+4)/5)*Math.floor((b+3)/4)*16;case bi:return Math.floor((a+4)/5)*Math.floor((b+4)/5)*16;case bj:return Math.floor((a+5)/6)*Math.floor((b+4)/5)*16;case bk:return Math.floor((a+5)/6)*Math.floor((b+5)/6)*16;case bl:return Math.floor((a+7)/8)*Math.floor((b+4)/5)*16;case bm:return Math.floor((a+7)/8)*Math.floor((b+5)/6)*16;case bn:return Math.floor((a+7)/8)*Math.floor((b+7)/8)*16;case bo:return Math.floor((a+9)/10)*Math.floor((b+4)/5)*16;case bp:return Math.floor((a+9)/10)*Math.floor((b+5)/6)*16;case bq:return Math.floor((a+9)/10)*Math.floor((b+7)/8)*16;case br:return Math.floor((a+9)/10)*Math.floor((b+9)/10)*16;case bs:return Math.floor((a+11)/12)*Math.floor((b+9)/10)*16;case bt:return Math.floor((a+11)/12)*Math.floor((b+11)/12)*16;case bu:case bv:case bw:return Math.ceil(a/4)*Math.ceil(b/4)*16;case bx:case by:return Math.ceil(a/4)*Math.ceil(b/4)*8;case bz:case bA:return Math.ceil(a/4)*Math.ceil(b/4)*16}throw Error(`Unable to determine texture byte length for ${c} format.`)}let kA={contain:function(a,b){let c=a.image&&a.image.width?a.image.width/a.image.height:1;return c>b?(a.repeat.x=1,a.repeat.y=c/b,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2):(a.repeat.x=b/c,a.repeat.y=1,a.offset.x=(1-a.repeat.x)/2,a.offset.y=0),a},cover:function(a,b){let c=a.image&&a.image.width?a.image.width/a.image.height:1;return c>b?(a.repeat.x=b/c,a.repeat.y=1,a.offset.x=(1-a.repeat.x)/2,a.offset.y=0):(a.repeat.x=1,a.repeat.y=c/b,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2),a},fill:function(a){return a.repeat.x=1,a.repeat.y=1,a.offset.x=0,a.offset.y=0,a},getByteLength:kz};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}}))}};